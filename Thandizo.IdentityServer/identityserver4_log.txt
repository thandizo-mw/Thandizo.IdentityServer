2020-04-06 11:24:14.490 +02:00 [INF] Starting host...
2020-04-06 11:24:25.582 +02:00 [FTL] Application startup exception
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
2020-04-06 11:24:26.246 +02:00 [FTL] Host terminated unexpectedly.
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-06 11:25:23.540 +02:00 [INF] Starting host...
2020-04-06 11:25:24.131 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-06 11:25:24.865 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-06 11:25:24.866 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-06 11:25:24.866 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-06 11:25:24.866 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-06 11:25:24.866 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-06 11:25:24.866 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-06 11:26:02.129 +02:00 [DBG] Login Url: /Account/Login
2020-04-06 11:26:02.130 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-06 11:26:02.130 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-06 11:26:02.130 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-06 11:26:02.130 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-06 11:26:02.130 +02:00 [DBG] Error Url: /home/error
2020-04-06 11:26:02.130 +02:00 [DBG] Error Id Parameter: errorId
2020-04-06 11:31:31.310 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-06 11:31:31.315 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-06 11:31:31.315 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-06 11:31:31.420 +02:00 [DBG] Start discovery request
2020-04-06 11:31:34.438 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-06 12:25:24.337 +02:00 [INF] Removing 0 grants
2020-04-06 12:25:24.367 +02:00 [INF] Removing 0 device flow codes
2020-04-06 13:46:54.893 +02:00 [ERR] An error occurred using the connection to database 'thandizo_identity' on server 'tcp://localhost:5432'.
2020-04-06 13:46:54.945 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while connecting
 ---> System.Net.Internals.SocketExceptionFactory+ExtendedSocketException (10061): No connection could be made because the target machine actively refused it. 127.0.0.1:5432
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw(Exception source)
   at System.Net.Sockets.Socket.EndConnect(IAsyncResult asyncResult)
   at System.Net.Sockets.Socket.<>c.<ConnectAsync>b__274_0(IAsyncResult iar)
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.TaskExtensions.WithCancellation(Task task, CancellationToken cancellationToken)
   at Npgsql.TaskExtensions.WithTimeout(Task task, NpgsqlTimeout timeout)
   at Npgsql.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.RawOpen(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while connecting
 ---> System.Net.Internals.SocketExceptionFactory+ExtendedSocketException (10061): No connection could be made because the target machine actively refused it. 127.0.0.1:5432
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw(Exception source)
   at System.Net.Sockets.Socket.EndConnect(IAsyncResult asyncResult)
   at System.Net.Sockets.Socket.<>c.<ConnectAsync>b__274_0(IAsyncResult iar)
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.TaskExtensions.WithCancellation(Task task, CancellationToken cancellationToken)
   at Npgsql.TaskExtensions.WithTimeout(Task task, NpgsqlTimeout timeout)
   at Npgsql.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.RawOpen(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2020-04-06 13:46:54.953 +02:00 [ERR] Exception removing expired grants: An exception has been raised that is likely due to a transient failure.
2020-04-06 14:46:55.424 +02:00 [INF] Removing 0 grants
2020-04-06 14:46:55.431 +02:00 [INF] Removing 0 device flow codes
2020-04-06 15:46:59.658 +02:00 [INF] Removing 0 grants
2020-04-06 15:46:59.822 +02:00 [INF] Removing 0 device flow codes
2020-04-06 19:38:16.458 +02:00 [INF] Removing 0 grants
2020-04-06 19:38:16.465 +02:00 [INF] Removing 0 device flow codes
2020-04-06 20:38:16.785 +02:00 [INF] Removing 0 grants
2020-04-06 20:38:16.793 +02:00 [INF] Removing 0 device flow codes
2020-04-06 21:38:17.008 +02:00 [INF] Removing 0 grants
2020-04-06 21:38:17.016 +02:00 [INF] Removing 0 device flow codes
2020-04-06 22:38:17.156 +02:00 [INF] Removing 0 grants
2020-04-06 22:38:17.167 +02:00 [INF] Removing 0 device flow codes
2020-04-06 23:38:17.387 +02:00 [INF] Removing 0 grants
2020-04-06 23:38:17.394 +02:00 [INF] Removing 0 device flow codes
2020-04-07 00:38:17.483 +02:00 [INF] Removing 0 grants
2020-04-07 00:38:17.488 +02:00 [INF] Removing 0 device flow codes
2020-04-07 06:54:27.897 +02:00 [INF] Removing 0 grants
2020-04-07 06:54:27.901 +02:00 [INF] Removing 0 device flow codes
2020-04-07 07:54:27.972 +02:00 [INF] Removing 0 grants
2020-04-07 07:54:27.976 +02:00 [INF] Removing 0 device flow codes
2020-04-07 09:28:23.681 +02:00 [INF] Removing 0 grants
2020-04-07 09:28:23.685 +02:00 [INF] Removing 0 device flow codes
2020-04-07 10:28:23.840 +02:00 [INF] Removing 0 grants
2020-04-07 10:28:23.850 +02:00 [INF] Removing 0 device flow codes
2020-04-07 13:48:45.539 +02:00 [INF] Removing 0 grants
2020-04-07 13:48:45.543 +02:00 [INF] Removing 0 device flow codes
2020-04-07 17:24:58.175 +02:00 [ERR] An error occurred using the connection to database 'thandizo_identity' on server 'tcp://localhost:5432'.
2020-04-07 17:25:08.741 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> System.TimeoutException: The operation has timed out.
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> System.TimeoutException: The operation has timed out.
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2020-04-07 17:25:09.458 +02:00 [ERR] Exception removing expired grants: An exception has been raised that is likely due to a transient failure.
2020-04-07 18:25:10.171 +02:00 [INF] Removing 0 grants
2020-04-07 18:25:10.208 +02:00 [INF] Removing 0 device flow codes
2020-04-07 19:25:10.498 +02:00 [INF] Removing 0 grants
2020-04-07 19:25:10.509 +02:00 [INF] Removing 0 device flow codes
2020-04-07 20:25:10.634 +02:00 [INF] Removing 0 grants
2020-04-07 20:25:10.638 +02:00 [INF] Removing 0 device flow codes
2020-04-07 21:25:10.746 +02:00 [INF] Removing 0 grants
2020-04-07 21:25:10.775 +02:00 [INF] Removing 0 device flow codes
2020-04-08 05:34:51.136 +02:00 [INF] Removing 0 grants
2020-04-08 05:34:51.139 +02:00 [INF] Removing 0 device flow codes
2020-04-08 06:34:51.501 +02:00 [INF] Removing 0 grants
2020-04-08 06:34:51.504 +02:00 [INF] Removing 0 device flow codes
2020-04-08 07:34:51.705 +02:00 [INF] Removing 0 grants
2020-04-08 07:34:51.715 +02:00 [INF] Removing 0 device flow codes
2020-04-08 08:34:51.812 +02:00 [INF] Removing 0 grants
2020-04-08 08:34:51.816 +02:00 [INF] Removing 0 device flow codes
2020-04-08 17:32:19.029 +02:00 [INF] Removing 0 grants
2020-04-08 17:32:19.067 +02:00 [INF] Removing 0 device flow codes
2020-04-08 18:32:19.254 +02:00 [INF] Removing 0 grants
2020-04-08 18:32:19.259 +02:00 [INF] Removing 0 device flow codes
2020-04-08 20:21:23.483 +02:00 [INF] Removing 0 grants
2020-04-08 20:21:23.619 +02:00 [INF] Removing 0 device flow codes
2020-04-08 21:21:23.913 +02:00 [INF] Removing 0 grants
2020-04-08 21:21:23.916 +02:00 [INF] Removing 0 device flow codes
2020-04-08 22:21:24.188 +02:00 [INF] Removing 0 grants
2020-04-08 22:21:24.232 +02:00 [INF] Removing 0 device flow codes
2020-04-09 04:42:11.800 +02:00 [INF] Removing 0 grants
2020-04-09 04:42:11.806 +02:00 [INF] Removing 0 device flow codes
2020-04-09 05:42:11.950 +02:00 [INF] Removing 0 grants
2020-04-09 05:42:11.956 +02:00 [INF] Removing 0 device flow codes
2020-04-09 06:42:12.029 +02:00 [INF] Removing 0 grants
2020-04-09 06:42:12.035 +02:00 [INF] Removing 0 device flow codes
2020-04-09 07:42:12.312 +02:00 [INF] Removing 0 grants
2020-04-09 07:42:12.315 +02:00 [INF] Removing 0 device flow codes
2020-04-09 08:42:12.413 +02:00 [INF] Removing 0 grants
2020-04-09 08:42:12.419 +02:00 [INF] Removing 0 device flow codes
2020-04-09 10:49:32.181 +02:00 [INF] Removing 0 grants
2020-04-09 10:49:32.184 +02:00 [INF] Removing 0 device flow codes
2020-04-09 11:49:32.247 +02:00 [INF] Removing 0 grants
2020-04-09 11:49:32.250 +02:00 [INF] Removing 0 device flow codes
2020-04-09 12:49:32.375 +02:00 [INF] Removing 0 grants
2020-04-09 12:49:32.379 +02:00 [INF] Removing 0 device flow codes
2020-04-15 16:48:31.463 +02:00 [INF] Starting host...
2020-04-15 16:48:34.417 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-15 16:48:35.088 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-15 16:48:35.088 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-15 16:48:35.088 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-15 16:48:35.088 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-15 16:48:35.088 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-15 16:48:35.088 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-15 18:34:07.925 +02:00 [INF] Removing 0 grants
2020-04-15 18:34:08.038 +02:00 [INF] Removing 0 device flow codes
2020-04-15 19:34:08.271 +02:00 [INF] Removing 0 grants
2020-04-15 19:34:08.276 +02:00 [INF] Removing 0 device flow codes
2020-04-15 20:34:08.374 +02:00 [INF] Removing 0 grants
2020-04-15 20:34:08.378 +02:00 [INF] Removing 0 device flow codes
2020-04-15 21:34:17.214 +02:00 [INF] Removing 0 grants
2020-04-15 21:34:17.615 +02:00 [INF] Removing 0 device flow codes
2020-04-15 22:34:17.781 +02:00 [INF] Removing 0 grants
2020-04-15 22:34:17.786 +02:00 [INF] Removing 0 device flow codes
2020-04-16 02:25:20.477 +02:00 [INF] Removing 0 grants
2020-04-16 02:25:20.511 +02:00 [INF] Removing 0 device flow codes
2020-04-16 03:25:23.814 +02:00 [INF] Removing 0 grants
2020-04-16 03:25:23.820 +02:00 [INF] Removing 0 device flow codes
2020-04-16 06:27:39.802 +02:00 [INF] Removing 0 grants
2020-04-16 06:27:39.807 +02:00 [INF] Removing 0 device flow codes
2020-04-16 07:49:16.133 +02:00 [INF] Removing 0 grants
2020-04-16 07:49:16.138 +02:00 [INF] Removing 0 device flow codes
2020-04-16 09:05:57.942 +02:00 [INF] Removing 0 grants
2020-04-16 09:05:58.051 +02:00 [INF] Removing 0 device flow codes
2020-04-16 10:05:58.258 +02:00 [INF] Removing 0 grants
2020-04-16 10:05:58.262 +02:00 [INF] Removing 0 device flow codes
2020-04-16 11:05:58.396 +02:00 [INF] Removing 0 grants
2020-04-16 11:05:58.401 +02:00 [INF] Removing 0 device flow codes
2020-04-16 12:05:58.516 +02:00 [INF] Removing 0 grants
2020-04-16 12:05:58.522 +02:00 [INF] Removing 0 device flow codes
2020-04-16 12:41:50.185 +02:00 [DBG] Login Url: /Account/Login
2020-04-16 12:41:50.190 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-16 12:41:50.190 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-16 12:41:50.190 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-16 12:41:50.190 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-16 12:41:50.190 +02:00 [DBG] Error Url: /home/error
2020-04-16 12:41:50.190 +02:00 [DBG] Error Id Parameter: errorId
2020-04-16 12:41:50.316 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 12:41:50.342 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 12:41:50.342 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 12:41:50.355 +02:00 [DBG] Start discovery request
2020-04-16 12:41:55.095 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 12:41:56.523 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-16 12:41:56.525 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-16 12:41:56.525 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-16 12:41:56.528 +02:00 [DBG] Start key discovery request
2020-04-16 12:41:59.324 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-16 12:41:59.361 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-16 12:41:59.361 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-16 12:41:59.369 +02:00 [DBG] Start token request.
2020-04-16 12:41:59.397 +02:00 [DBG] Start client validation
2020-04-16 12:41:59.405 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-16 12:41:59.407 +02:00 [DBG] Start parsing for secret in post body
2020-04-16 12:41:59.459 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-16 12:41:59.459 +02:00 [DBG] Secret id found: client
2020-04-16 12:41:59.746 +02:00 [INF] {"ClientId":"client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Unknown client","ActivityId":"0HLV1UB1U2EKE:00000003","TimeStamp":"2020-04-16T10:41:59.0000000Z","ProcessId":24416,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2020-04-16 12:41:59.751 +02:00 [ERR] No client with id 'client' found. aborting
2020-04-16 13:05:58.602 +02:00 [INF] Removing 0 grants
2020-04-16 13:05:58.611 +02:00 [INF] Removing 0 device flow codes
2020-04-16 14:27:01.023 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 14:27:01.025 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 14:27:01.026 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 14:27:01.026 +02:00 [DBG] Start discovery request
2020-04-16 14:27:01.297 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 14:27:02.187 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-16 14:27:02.188 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-16 14:27:02.188 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-16 14:27:02.188 +02:00 [DBG] Start key discovery request
2020-04-16 14:27:02.949 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-16 14:27:02.950 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-16 14:27:02.950 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-16 14:27:02.951 +02:00 [DBG] Start token request.
2020-04-16 14:27:02.951 +02:00 [DBG] Start client validation
2020-04-16 14:27:02.951 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-16 14:27:02.952 +02:00 [DBG] Start parsing for secret in post body
2020-04-16 14:27:02.953 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-16 14:27:02.954 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-16 14:27:04.051 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-16 14:27:04.057 +02:00 [ERR] Invalid client configuration for client thandizo_whatsapp_client: no allowed grant type specified
2020-04-16 14:27:04.062 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"no allowed grant type specified","ActivityId":"0HLV1UB1U2EKF:00000003","TimeStamp":"2020-04-16T12:27:04.0000000Z","ProcessId":24416,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-16 14:27:04.062 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Unknown client","ActivityId":"0HLV1UB1U2EKF:00000003","TimeStamp":"2020-04-16T12:27:04.0000000Z","ProcessId":24416,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2020-04-16 14:27:04.062 +02:00 [ERR] No client with id 'thandizo_whatsapp_client' found. aborting
2020-04-16 16:10:48.358 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 16:10:48.392 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 16:10:48.392 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 16:10:48.392 +02:00 [DBG] Start discovery request
2020-04-16 16:10:48.821 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 16:10:49.283 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-16 16:10:49.284 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-16 16:10:49.284 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-16 16:10:49.285 +02:00 [DBG] Start key discovery request
2020-04-16 16:10:49.974 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-16 16:10:50.054 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-16 16:10:50.054 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-16 16:10:50.054 +02:00 [DBG] Start token request.
2020-04-16 16:10:50.054 +02:00 [DBG] Start client validation
2020-04-16 16:10:50.055 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-16 16:10:50.055 +02:00 [DBG] Start parsing for secret in post body
2020-04-16 16:10:50.087 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-16 16:10:50.087 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-16 16:10:50.158 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-16 16:10:50.159 +02:00 [ERR] Invalid client configuration for client thandizo_whatsapp_client: no allowed grant type specified
2020-04-16 16:10:50.159 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"no allowed grant type specified","ActivityId":"0HLV1UB1U2EKG:00000003","TimeStamp":"2020-04-16T14:10:50.0000000Z","ProcessId":24416,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-16 16:10:50.160 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Unknown client","ActivityId":"0HLV1UB1U2EKG:00000003","TimeStamp":"2020-04-16T14:10:50.0000000Z","ProcessId":24416,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2020-04-16 16:10:50.160 +02:00 [ERR] No client with id 'thandizo_whatsapp_client' found. aborting
2020-04-16 16:12:05.385 +02:00 [INF] Starting host...
2020-04-16 16:12:16.845 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-16 16:12:17.747 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-16 16:12:17.749 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-16 16:12:17.749 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-16 16:12:17.749 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-16 16:12:17.749 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-16 16:12:17.749 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-16 16:13:04.530 +02:00 [DBG] Login Url: /Account/Login
2020-04-16 16:13:04.539 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-16 16:13:04.540 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-16 16:13:04.540 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-16 16:13:04.540 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-16 16:13:04.540 +02:00 [DBG] Error Url: /home/error
2020-04-16 16:13:04.540 +02:00 [DBG] Error Id Parameter: errorId
2020-04-16 16:13:04.627 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 16:13:04.634 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 16:13:04.634 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 16:13:04.636 +02:00 [DBG] Start discovery request
2020-04-16 16:13:12.374 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 16:13:13.888 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-16 16:13:13.890 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-16 16:13:13.890 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-16 16:13:13.892 +02:00 [DBG] Start key discovery request
2020-04-16 16:13:14.702 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-16 16:13:14.712 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-16 16:13:14.712 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-16 16:13:14.720 +02:00 [DBG] Start token request.
2020-04-16 16:13:14.725 +02:00 [DBG] Start client validation
2020-04-16 16:13:14.735 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-16 16:13:14.737 +02:00 [DBG] Start parsing for secret in post body
2020-04-16 16:13:14.752 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-16 16:13:14.752 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-16 16:13:15.486 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-16 16:13:15.496 +02:00 [ERR] Invalid client configuration for client thandizo_whatsapp_client: no allowed grant type specified
2020-04-16 16:13:15.519 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"no allowed grant type specified","ActivityId":"0HLV2213OK712:00000003","TimeStamp":"2020-04-16T14:13:15.0000000Z","ProcessId":12632,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-16 16:13:15.534 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Unknown client","ActivityId":"0HLV2213OK712:00000003","TimeStamp":"2020-04-16T14:13:15.0000000Z","ProcessId":12632,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2020-04-16 16:13:15.535 +02:00 [ERR] No client with id 'thandizo_whatsapp_client' found. aborting
2020-04-16 16:19:57.031 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 16:19:57.034 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 16:19:57.035 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 16:19:57.035 +02:00 [DBG] Start discovery request
2020-04-16 16:19:58.317 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 16:48:44.050 +02:00 [INF] Starting host...
2020-04-16 16:48:49.629 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-16 16:48:51.540 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-16 16:48:51.541 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-16 16:48:51.542 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-16 16:48:51.542 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-16 16:48:51.542 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-16 16:48:51.542 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-16 16:49:46.466 +02:00 [DBG] Login Url: /Account/Login
2020-04-16 16:49:46.469 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-16 16:49:46.469 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-16 16:49:46.469 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-16 16:49:46.469 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-16 16:49:46.469 +02:00 [DBG] Error Url: /home/error
2020-04-16 16:49:46.470 +02:00 [DBG] Error Id Parameter: errorId
2020-04-16 16:49:46.508 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 16:49:46.520 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 16:49:46.520 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 16:49:46.623 +02:00 [DBG] Start discovery request
2020-04-16 16:49:52.285 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-16 16:49:52.899 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-16 16:49:52.900 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-16 16:49:52.900 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-16 16:49:52.901 +02:00 [DBG] Start key discovery request
2020-04-16 16:49:53.778 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-16 16:49:53.786 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-16 16:49:53.787 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-16 16:49:53.792 +02:00 [DBG] Start token request.
2020-04-16 16:49:53.805 +02:00 [DBG] Start client validation
2020-04-16 16:49:53.813 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-16 16:49:53.815 +02:00 [DBG] Start parsing for secret in post body
2020-04-16 16:49:53.864 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-16 16:49:53.864 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-16 16:49:54.728 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-16 16:49:54.734 +02:00 [ERR] Invalid client configuration for client thandizo_whatsapp_client: no allowed grant type specified
2020-04-16 16:49:54.768 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"no allowed grant type specified","ActivityId":"0HLV22LJTUBNP:00000003","TimeStamp":"2020-04-16T14:49:54.0000000Z","ProcessId":7260,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-16 16:49:54.795 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Unknown client","ActivityId":"0HLV22LJTUBNP:00000003","TimeStamp":"2020-04-16T14:49:54.0000000Z","ProcessId":7260,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2020-04-16 16:49:54.796 +02:00 [ERR] No client with id 'thandizo_whatsapp_client' found. aborting
2020-04-16 16:50:38.250 +02:00 [INF] Starting host...
2020-04-16 16:50:39.810 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-16 16:50:40.571 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-16 16:50:40.588 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-16 16:50:40.594 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-16 16:50:40.594 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-16 16:50:40.594 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-16 16:50:40.594 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-16 17:42:20.598 +02:00 [DBG] Login Url: /Account/Login
2020-04-16 17:42:20.602 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-16 17:42:20.602 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-16 17:42:20.605 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-16 17:42:20.606 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-16 17:42:20.607 +02:00 [DBG] Error Url: /home/error
2020-04-16 17:42:20.608 +02:00 [DBG] Error Id Parameter: errorId
2020-04-16 17:42:20.652 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-16 17:42:20.658 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-16 17:42:20.658 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-16 17:42:20.661 +02:00 [DBG] Start discovery request
2020-04-16 17:42:25.821 +02:00 [ERR] An error occurred using the connection to database 'thandizo_identity' on server 'tcp://localhost:5433'.
2020-04-16 17:42:26.265 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2020-04-16 17:42:26.426 +02:00 [INF] {"Details":"System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.\r\n ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream\r\n ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.\r\n   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()\r\n   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)\r\n   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)\r\n   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)\r\n   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)\r\n   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToArrayAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)\r\n   at IdentityServer4.EntityFramework.Stores.ResourceStore.GetAllResourcesAsync()\r\n   at IdentityServer4.Stores.IResourceStoreExtensions.GetAllEnabledResourcesAsync(IResourceStore store)\r\n   at IdentityServer4.ResponseHandling.DiscoveryResponseGenerator.CreateDiscoveryDocumentAsync(String baseUrl, String issuerUri)\r\n   at IdentityServer4.Endpoints.DiscoveryEndpoint.ProcessAsync(HttpContext context)\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)","Category":"Error","Name":"Unhandled Exception","EventType":"Error","Id":3000,"Message":"An exception has been raised that is likely due to a transient failure.","ActivityId":"0HLV23IVSB6AQ:00000001","TimeStamp":"2020-04-16T15:42:26.0000000Z","ProcessId":32536,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UnhandledExceptionEvent"}
2020-04-16 17:42:26.450 +02:00 [FTL] Unhandled exception: An exception has been raised that is likely due to a transient failure.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToArrayAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer4.EntityFramework.Stores.ResourceStore.GetAllResourcesAsync()
   at IdentityServer4.Stores.IResourceStoreExtensions.GetAllEnabledResourcesAsync(IResourceStore store)
   at IdentityServer4.ResponseHandling.DiscoveryResponseGenerator.CreateDiscoveryDocumentAsync(String baseUrl, String issuerUri)
   at IdentityServer4.Endpoints.DiscoveryEndpoint.ProcessAsync(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
2020-04-16 17:42:26.480 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToArrayAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at IdentityServer4.EntityFramework.Stores.ResourceStore.GetAllResourcesAsync()
   at IdentityServer4.Stores.IResourceStoreExtensions.GetAllEnabledResourcesAsync(IResourceStore store)
   at IdentityServer4.ResponseHandling.DiscoveryResponseGenerator.CreateDiscoveryDocumentAsync(String baseUrl, String issuerUri)
   at IdentityServer4.Endpoints.DiscoveryEndpoint.ProcessAsync(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-16 17:50:40.203 +02:00 [ERR] An error occurred using the connection to database 'thandizo_identity' on server 'tcp://localhost:5433'.
2020-04-16 17:50:40.210 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
   at Npgsql.NpgsqlReadBuffer.<>c__DisplayClass34_0.<<Ensure>g__EnsureLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async)
   at Npgsql.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.AllocateLong(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<>c__DisplayClass32_0.<<Open>g__OpenLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(DbContext _, Boolean result, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2020-04-16 17:50:40.228 +02:00 [ERR] Exception removing expired grants: An exception has been raised that is likely due to a transient failure.
2020-04-16 18:18:59.619 +02:00 [INF] Starting host...
2020-04-16 18:19:01.243 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-16 18:19:01.553 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-16 18:19:01.553 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-16 18:19:01.554 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-16 18:19:01.554 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-16 18:19:01.554 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-16 18:19:01.554 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-16 19:19:09.536 +02:00 [INF] Removing 0 grants
2020-04-16 19:19:09.692 +02:00 [INF] Removing 0 device flow codes
2020-04-16 20:44:27.090 +02:00 [INF] Removing 0 grants
2020-04-16 20:44:27.097 +02:00 [INF] Removing 0 device flow codes
2020-04-17 02:25:01.672 +02:00 [INF] Starting host...
2020-04-17 02:25:14.116 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-17 02:25:15.125 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-17 02:25:15.125 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-17 02:25:15.125 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-17 02:25:15.125 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-17 02:25:15.125 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-17 02:25:15.125 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-17 02:33:25.977 +02:00 [DBG] Login Url: /Account/Login
2020-04-17 02:33:25.979 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-17 02:33:25.980 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-17 02:33:25.980 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-17 02:33:25.980 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-17 02:33:25.980 +02:00 [DBG] Error Url: /home/error
2020-04-17 02:33:25.980 +02:00 [DBG] Error Id Parameter: errorId
2020-04-17 02:36:20.245 +02:00 [INF] Starting host...
2020-04-17 02:36:20.920 +02:00 [INF] Starting IdentityServer4 version 3.1.0.0
2020-04-17 02:36:21.050 +02:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2020-04-17 02:36:21.050 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2020-04-17 02:36:21.050 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2020-04-17 02:36:21.050 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2020-04-17 02:36:21.051 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2020-04-17 02:36:21.051 +02:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2020-04-17 02:36:25.346 +02:00 [DBG] Login Url: /Account/Login
2020-04-17 02:36:25.349 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-17 02:36:25.349 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-17 02:36:25.349 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-17 02:36:25.349 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-17 02:36:25.349 +02:00 [DBG] Error Url: /home/error
2020-04-17 02:36:25.349 +02:00 [DBG] Error Id Parameter: errorId
2020-04-17 02:41:48.166 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 02:41:48.192 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 02:41:48.192 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 02:41:48.198 +02:00 [DBG] Start discovery request
2020-04-17 02:41:49.609 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-17 02:45:15.209 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 02:45:15.212 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 02:45:15.216 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 02:45:15.217 +02:00 [DBG] Start discovery request
2020-04-17 02:45:15.334 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-17 02:45:15.981 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 02:45:15.982 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 02:45:15.983 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 02:45:15.984 +02:00 [DBG] Start key discovery request
2020-04-17 02:45:16.972 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 02:45:16.980 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 02:45:16.980 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 02:45:16.984 +02:00 [DBG] Start token request.
2020-04-17 02:45:17.010 +02:00 [DBG] Start client validation
2020-04-17 02:45:17.016 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 02:45:17.017 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 02:45:17.071 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 02:45:17.071 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 02:45:17.883 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 02:45:17.899 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 02:45:17.934 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 02:45:17.934 +02:00 [DBG] Client validation success
2020-04-17 02:45:17.981 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480D:00000003","TimeStamp":"2020-04-17T00:45:17.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 02:45:17.990 +02:00 [DBG] Start token request validation
2020-04-17 02:45:17.997 +02:00 [DBG] Start client credentials token request validation
2020-04-17 02:45:18.101 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 02:45:18.173 +02:00 [DBG] Found [] API scopes in database
2020-04-17 02:45:18.176 +02:00 [ERR] Requested scope not allowed: api_gateway
2020-04-17 02:45:18.183 +02:00 [ERR] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api_gateway","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 02:45:18.194 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV2CTE2480D:00000003","TimeStamp":"2020-04-17T00:45:18.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-17 02:46:32.133 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 02:46:32.139 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 02:46:32.139 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 02:46:32.139 +02:00 [DBG] Start discovery request
2020-04-17 02:46:32.294 +02:00 [DBG] Found ["full_access"] as all scopes in database
2020-04-17 02:46:32.925 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 02:46:32.926 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 02:46:32.926 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 02:46:32.926 +02:00 [DBG] Start key discovery request
2020-04-17 02:46:33.528 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 02:46:33.530 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 02:46:33.530 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 02:46:33.531 +02:00 [DBG] Start token request.
2020-04-17 02:46:33.531 +02:00 [DBG] Start client validation
2020-04-17 02:46:33.531 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 02:46:33.531 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 02:46:33.532 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 02:46:33.532 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 02:46:33.591 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 02:46:33.591 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 02:46:33.591 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 02:46:33.592 +02:00 [DBG] Client validation success
2020-04-17 02:46:33.592 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480E:00000003","TimeStamp":"2020-04-17T00:46:33.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 02:46:33.593 +02:00 [DBG] Start token request validation
2020-04-17 02:46:33.593 +02:00 [DBG] Start client credentials token request validation
2020-04-17 02:46:33.596 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 02:46:33.601 +02:00 [DBG] Found [] API scopes in database
2020-04-17 02:46:33.602 +02:00 [ERR] Requested scope not allowed: api_gateway
2020-04-17 02:46:33.602 +02:00 [ERR] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api_gateway","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 02:46:33.603 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV2CTE2480E:00000003","TimeStamp":"2020-04-17T00:46:33.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-17 02:48:35.070 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 02:48:35.071 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 02:48:35.072 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 02:48:35.072 +02:00 [DBG] Start discovery request
2020-04-17 02:48:35.212 +02:00 [DBG] Found ["api_gateway"] as all scopes in database
2020-04-17 02:48:35.771 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 02:48:35.774 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 02:48:35.774 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 02:48:35.775 +02:00 [DBG] Start key discovery request
2020-04-17 02:48:36.936 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 02:48:36.947 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 02:48:36.947 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 02:48:36.947 +02:00 [DBG] Start token request.
2020-04-17 02:48:36.947 +02:00 [DBG] Start client validation
2020-04-17 02:48:36.947 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 02:48:36.947 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 02:48:36.948 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 02:48:36.948 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 02:48:36.986 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 02:48:36.986 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 02:48:36.986 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 02:48:36.987 +02:00 [DBG] Client validation success
2020-04-17 02:48:36.987 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480F:00000003","TimeStamp":"2020-04-17T00:48:36.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 02:48:36.987 +02:00 [DBG] Start token request validation
2020-04-17 02:48:36.987 +02:00 [DBG] Start client credentials token request validation
2020-04-17 02:48:36.990 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 02:48:36.995 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 02:48:37.003 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 02:48:37.009 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 02:48:37.012 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 02:48:37.013 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"api_gateway","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api_gateway","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 02:48:37.046 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 02:48:37.518 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api_gateway","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****6bRg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480F:00000003","TimeStamp":"2020-04-17T00:48:37.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 02:48:37.518 +02:00 [DBG] Token request success.
2020-04-17 03:36:21.198 +02:00 [INF] Removing 0 grants
2020-04-17 03:36:21.222 +02:00 [INF] Removing 0 device flow codes
2020-04-17 04:25:55.415 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:25:55.419 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:25:55.419 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:25:55.419 +02:00 [DBG] Start discovery request
2020-04-17 04:25:55.538 +02:00 [DBG] Found ["api_gateway"] as all scopes in database
2020-04-17 04:25:56.270 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:25:56.272 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:25:56.273 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:25:56.273 +02:00 [DBG] Start key discovery request
2020-04-17 04:26:38.202 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:26:38.203 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:26:38.203 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:26:38.203 +02:00 [DBG] Start discovery request
2020-04-17 04:26:38.470 +02:00 [DBG] Found ["api_gateway"] as all scopes in database
2020-04-17 04:26:38.820 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:26:38.821 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:26:38.821 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:26:38.821 +02:00 [DBG] Start key discovery request
2020-04-17 04:26:39.923 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 04:26:39.924 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 04:26:39.924 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 04:26:39.924 +02:00 [DBG] Start token request.
2020-04-17 04:26:39.924 +02:00 [DBG] Start client validation
2020-04-17 04:26:39.924 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 04:26:39.924 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 04:26:39.925 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 04:26:39.925 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 04:26:39.994 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 04:26:39.994 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 04:26:39.994 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 04:26:39.995 +02:00 [DBG] Client validation success
2020-04-17 04:26:39.995 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480H:00000003","TimeStamp":"2020-04-17T02:26:39.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 04:26:39.996 +02:00 [DBG] Start token request validation
2020-04-17 04:26:39.996 +02:00 [DBG] Start client credentials token request validation
2020-04-17 04:26:39.999 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:26:40.005 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 04:26:40.007 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:26:40.010 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 04:26:40.011 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 04:26:40.011 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"api_gateway","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api_gateway","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 04:26:40.011 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 04:26:40.015 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api_gateway","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****Ic8w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480H:00000003","TimeStamp":"2020-04-17T02:26:40.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 04:26:40.015 +02:00 [DBG] Token request success.
2020-04-17 04:27:21.457 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:27:21.460 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:27:21.460 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:27:21.461 +02:00 [DBG] Start discovery request
2020-04-17 04:27:21.593 +02:00 [DBG] Found ["api_gateway"] as all scopes in database
2020-04-17 04:27:21.880 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:27:21.881 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:27:21.882 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:27:21.882 +02:00 [DBG] Start key discovery request
2020-04-17 04:27:22.640 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 04:27:22.641 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 04:27:22.641 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 04:27:22.641 +02:00 [DBG] Start token request.
2020-04-17 04:27:22.641 +02:00 [DBG] Start client validation
2020-04-17 04:27:22.641 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 04:27:22.641 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 04:27:22.642 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 04:27:22.642 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 04:27:22.730 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 04:27:22.731 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 04:27:22.731 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 04:27:22.731 +02:00 [DBG] Client validation success
2020-04-17 04:27:22.732 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480I:00000003","TimeStamp":"2020-04-17T02:27:22.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 04:27:22.732 +02:00 [DBG] Start token request validation
2020-04-17 04:27:22.732 +02:00 [DBG] Start client credentials token request validation
2020-04-17 04:27:22.737 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:27:22.743 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 04:27:22.746 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:27:22.753 +02:00 [DBG] Found ["api_gateway"] API scopes in database
2020-04-17 04:27:22.753 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 04:27:22.754 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"api_gateway","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 04:27:22.754 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 04:27:22.757 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api_gateway","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****n0Gw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480I:00000003","TimeStamp":"2020-04-17T02:27:22.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 04:27:22.758 +02:00 [DBG] Token request success.
2020-04-17 04:28:24.489 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:28:24.491 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:28:24.491 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:28:24.491 +02:00 [DBG] Start discovery request
2020-04-17 04:28:25.021 +02:00 [DBG] Found [] as all scopes in database
2020-04-17 04:28:25.631 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:28:25.631 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:28:25.631 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:28:25.631 +02:00 [DBG] Start key discovery request
2020-04-17 04:28:26.558 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 04:28:26.559 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 04:28:26.559 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 04:28:26.560 +02:00 [DBG] Start token request.
2020-04-17 04:28:26.560 +02:00 [DBG] Start client validation
2020-04-17 04:28:26.560 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 04:28:26.560 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 04:28:26.561 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 04:28:26.561 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 04:28:26.607 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 04:28:26.608 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 04:28:26.608 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 04:28:26.608 +02:00 [DBG] Client validation success
2020-04-17 04:28:26.608 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480J:00000003","TimeStamp":"2020-04-17T02:28:26.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 04:28:26.609 +02:00 [DBG] Start token request validation
2020-04-17 04:28:26.609 +02:00 [DBG] Start client credentials token request validation
2020-04-17 04:28:26.611 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:28:26.616 +02:00 [DBG] Found [] API scopes in database
2020-04-17 04:28:26.617 +02:00 [ERR] Requested scope not allowed: api_gateway
2020-04-17 04:28:26.617 +02:00 [ERR] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 04:28:26.617 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV2CTE2480J:00000003","TimeStamp":"2020-04-17T02:28:26.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-17 04:29:48.255 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:29:48.255 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:29:48.255 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:29:48.255 +02:00 [DBG] Start discovery request
2020-04-17 04:29:48.446 +02:00 [DBG] Found [] as all scopes in database
2020-04-17 04:29:48.995 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:29:48.995 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:29:48.995 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:29:48.995 +02:00 [DBG] Start key discovery request
2020-04-17 04:29:50.063 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 04:29:50.063 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 04:29:50.063 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 04:29:50.063 +02:00 [DBG] Start token request.
2020-04-17 04:29:50.063 +02:00 [DBG] Start client validation
2020-04-17 04:29:50.063 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 04:29:50.064 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 04:29:50.064 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 04:29:50.064 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 04:29:50.113 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 04:29:50.113 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 04:29:50.114 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 04:29:50.114 +02:00 [DBG] Client validation success
2020-04-17 04:29:50.114 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480K:00000003","TimeStamp":"2020-04-17T02:29:50.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 04:29:50.115 +02:00 [DBG] Start token request validation
2020-04-17 04:29:50.115 +02:00 [DBG] Start client credentials token request validation
2020-04-17 04:29:50.116 +02:00 [ERR] No allowed scopes configured for client{"clientId":"thandizo_whatsapp_client"}, details: {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":null,"AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 04:29:50.117 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":null,"GrantType":"client_credentials","Error":"invalid_scope","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV2CTE2480K:00000003","TimeStamp":"2020-04-17T02:29:50.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-17 04:32:19.206 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 04:32:19.206 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 04:32:19.206 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 04:32:19.206 +02:00 [DBG] Start discovery request
2020-04-17 04:32:19.417 +02:00 [DBG] Found ["coreapi_read"] as all scopes in database
2020-04-17 04:32:19.996 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 04:32:19.996 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 04:32:19.997 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 04:32:19.997 +02:00 [DBG] Start key discovery request
2020-04-17 04:32:20.596 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 04:32:20.597 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 04:32:20.597 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 04:32:20.597 +02:00 [DBG] Start token request.
2020-04-17 04:32:20.597 +02:00 [DBG] Start client validation
2020-04-17 04:32:20.598 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 04:32:20.598 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 04:32:20.598 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 04:32:20.598 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 04:32:20.640 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 04:32:20.640 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 04:32:20.640 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 04:32:20.640 +02:00 [DBG] Client validation success
2020-04-17 04:32:20.641 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480L:00000003","TimeStamp":"2020-04-17T02:32:20.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 04:32:20.641 +02:00 [DBG] Start token request validation
2020-04-17 04:32:20.641 +02:00 [DBG] Start client credentials token request validation
2020-04-17 04:32:20.643 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:32:20.647 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 04:32:20.649 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 04:32:20.653 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 04:32:20.654 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 04:32:20.654 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"coreapi_read","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 04:32:20.654 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 04:32:20.656 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"coreapi_read","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****F0mQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480L:00000003","TimeStamp":"2020-04-17T02:32:20.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 04:32:20.657 +02:00 [DBG] Token request success.
2020-04-17 04:36:21.343 +02:00 [INF] Removing 0 grants
2020-04-17 04:36:21.349 +02:00 [INF] Removing 0 device flow codes
2020-04-17 05:03:57.140 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 05:03:57.140 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 05:03:57.141 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 05:03:57.141 +02:00 [DBG] Start discovery request
2020-04-17 05:03:57.398 +02:00 [DBG] Found ["coreapi_read"] as all scopes in database
2020-04-17 05:03:57.947 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 05:03:57.947 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 05:03:57.947 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 05:03:57.948 +02:00 [DBG] Start key discovery request
2020-04-17 05:03:58.535 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 05:03:58.536 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 05:03:58.536 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 05:03:58.536 +02:00 [DBG] Start token request.
2020-04-17 05:03:58.537 +02:00 [DBG] Start client validation
2020-04-17 05:03:58.538 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 05:03:58.538 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 05:03:58.539 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 05:03:58.539 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 05:03:58.590 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 05:03:58.591 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 05:03:58.591 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 05:03:58.591 +02:00 [DBG] Client validation success
2020-04-17 05:03:58.592 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480M:00000003","TimeStamp":"2020-04-17T03:03:58.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 05:03:58.592 +02:00 [DBG] Start token request validation
2020-04-17 05:03:58.592 +02:00 [DBG] Start client credentials token request validation
2020-04-17 05:03:58.595 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 05:03:58.601 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 05:03:58.603 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 05:03:58.606 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 05:03:58.607 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 05:03:58.607 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"coreapi_read","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 05:03:58.607 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 05:03:58.610 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"coreapi_read","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****51PA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480M:00000003","TimeStamp":"2020-04-17T03:03:58.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 05:03:58.610 +02:00 [DBG] Token request success.
2020-04-17 05:36:21.420 +02:00 [INF] Removing 0 grants
2020-04-17 05:36:21.424 +02:00 [INF] Removing 0 device flow codes
2020-04-17 06:06:23.065 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 06:06:23.066 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 06:06:23.066 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 06:06:23.066 +02:00 [DBG] Start discovery request
2020-04-17 06:06:23.175 +02:00 [DBG] Found ["coreapi_read"] as all scopes in database
2020-04-17 06:06:23.617 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 06:06:23.617 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 06:06:23.617 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 06:06:23.617 +02:00 [DBG] Start key discovery request
2020-04-17 06:07:22.897 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 06:07:22.897 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 06:07:22.897 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 06:07:22.898 +02:00 [DBG] Start discovery request
2020-04-17 06:07:23.156 +02:00 [DBG] Found ["coreapi_read"] as all scopes in database
2020-04-17 06:07:23.527 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 06:07:23.528 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 06:07:23.528 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 06:07:23.528 +02:00 [DBG] Start key discovery request
2020-04-17 06:07:24.335 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-17 06:07:24.335 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-17 06:07:24.335 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-17 06:07:24.336 +02:00 [DBG] Start token request.
2020-04-17 06:07:24.336 +02:00 [DBG] Start client validation
2020-04-17 06:07:24.336 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-17 06:07:24.336 +02:00 [DBG] Start parsing for secret in post body
2020-04-17 06:07:24.337 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-17 06:07:24.337 +02:00 [DBG] Secret id found: thandizo_whatsapp_client
2020-04-17 06:07:24.404 +02:00 [DBG] thandizo_whatsapp_client found in database: true
2020-04-17 06:07:24.404 +02:00 [DBG] client configuration validation for client thandizo_whatsapp_client succeeded.
2020-04-17 06:07:24.404 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-17 06:07:24.405 +02:00 [DBG] Client validation success
2020-04-17 06:07:24.405 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV2CTE2480O:00000003","TimeStamp":"2020-04-17T04:07:24.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-17 06:07:24.406 +02:00 [DBG] Start token request validation
2020-04-17 06:07:24.406 +02:00 [DBG] Start client credentials token request validation
2020-04-17 06:07:24.408 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 06:07:24.414 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 06:07:24.417 +02:00 [DBG] Found [] identity scopes in database
2020-04-17 06:07:24.422 +02:00 [DBG] Found ["coreapi_read"] API scopes in database
2020-04-17 06:07:24.422 +02:00 [DBG] thandizo_whatsapp_client credentials token request validation success
2020-04-17 06:07:24.423 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","GrantType":"client_credentials","Scopes":"coreapi_read","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_id":"thandizo_whatsapp_client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2020-04-17 06:07:24.423 +02:00 [DBG] Getting claims for access token for client: thandizo_whatsapp_client
2020-04-17 06:07:24.426 +02:00 [INF] {"ClientId":"thandizo_whatsapp_client","ClientName":"Thandizo WhatsApp Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"coreapi_read","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****eC3g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV2CTE2480O:00000003","TimeStamp":"2020-04-17T04:07:24.0000000Z","ProcessId":16844,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-17 06:07:24.426 +02:00 [DBG] Token request success.
2020-04-17 06:07:30.038 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-17 06:07:30.038 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-17 06:07:30.039 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-17 06:07:30.039 +02:00 [DBG] Start discovery request
2020-04-17 06:07:30.045 +02:00 [DBG] Found ["coreapi_read"] as all scopes in database
2020-04-17 06:07:30.491 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-17 06:07:30.491 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-17 06:07:30.491 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-17 06:07:30.492 +02:00 [DBG] Start key discovery request
2020-04-17 06:36:21.498 +02:00 [INF] Removing 0 grants
2020-04-17 06:36:21.502 +02:00 [INF] Removing 0 device flow codes
2020-04-17 07:36:21.580 +02:00 [INF] Removing 0 grants
2020-04-17 07:36:21.587 +02:00 [INF] Removing 0 device flow codes
2020-04-17 09:08:41.972 +02:00 [INF] Removing 0 grants
2020-04-17 09:08:41.980 +02:00 [INF] Removing 0 device flow codes
2020-04-17 18:39:11.296 +02:00 [INF] Starting host...
2020-04-17 18:39:32.219 +02:00 [FTL] Application startup exception
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
2020-04-17 18:39:33.332 +02:00 [FTL] Host terminated unexpectedly.
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-17 19:17:24.449 +02:00 [INF] Starting host...
2020-04-17 19:17:27.239 +02:00 [FTL] Application startup exception
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
2020-04-17 19:17:27.420 +02:00 [FTL] Host terminated unexpectedly.
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-18 09:05:34.174 +02:00 [INF] Starting host...
2020-04-18 09:05:44.235 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 09:05:45.133 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 09:05:45.133 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 09:05:45.133 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 09:05:45.133 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 09:05:45.133 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 09:05:45.134 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 09:06:28.089 +02:00 [DBG] Login Url: /Account/Login
2020-04-18 09:06:28.091 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-18 09:06:28.091 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-18 09:06:28.091 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-18 09:06:28.091 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-18 09:06:28.091 +02:00 [DBG] Error Url: /home/error
2020-04-18 09:06:28.091 +02:00 [DBG] Error Id Parameter: errorId
2020-04-18 09:07:04.245 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_ValidationSummary' was not found. The following locations were searched:
/Views/Account/_ValidationSummary.cshtml
/Views/Shared/_ValidationSummary.cshtml
/Pages/Shared/_ValidationSummary.cshtml
   at Microsoft.AspNetCore.Mvc.TagHelpers.PartialTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.<RunAsync>g__Awaited|0_0(Task task, TagHelperExecutionContext executionContext, Int32 i, Int32 count)
   at AspNetCore.Views_Account_Login.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:09:39.054 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_ValidationSummary' was not found. The following locations were searched:
/Views/Account/_ValidationSummary.cshtml
/Views/Shared/_ValidationSummary.cshtml
/Pages/Shared/_ValidationSummary.cshtml
   at Microsoft.AspNetCore.Mvc.TagHelpers.PartialTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.<RunAsync>g__Awaited|0_0(Task task, TagHelperExecutionContext executionContext, Int32 i, Int32 count)
   at AspNetCore.Views_Account_Login.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:09:40.652 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_ValidationSummary' was not found. The following locations were searched:
/Views/Account/_ValidationSummary.cshtml
/Views/Shared/_ValidationSummary.cshtml
/Pages/Shared/_ValidationSummary.cshtml
   at Microsoft.AspNetCore.Mvc.TagHelpers.PartialTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.<RunAsync>g__Awaited|0_0(Task task, TagHelperExecutionContext executionContext, Int32 i, Int32 count)
   at AspNetCore.Views_Account_Login.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:09:42.215 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_ValidationSummary' was not found. The following locations were searched:
/Views/Account/_ValidationSummary.cshtml
/Views/Shared/_ValidationSummary.cshtml
/Pages/Shared/_ValidationSummary.cshtml
   at Microsoft.AspNetCore.Mvc.TagHelpers.PartialTagHelper.ProcessAsync(TagHelperContext context, TagHelperOutput output)
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner.<RunAsync>g__Awaited|0_0(Task task, TagHelperExecutionContext executionContext, Int32 i, Int32 count)
   at AspNetCore.Views_Account_Login.ExecuteAsync()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:10:00.133 +02:00 [INF] Starting host...
2020-04-18 09:10:00.963 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 09:10:01.106 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 09:10:01.106 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 09:10:01.106 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 09:10:01.106 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 09:10:01.106 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 09:10:01.107 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 09:10:09.083 +02:00 [DBG] Login Url: /Account/Login
2020-04-18 09:10:09.085 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-18 09:10:09.086 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-18 09:10:09.086 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-18 09:10:09.086 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-18 09:10:09.086 +02:00 [DBG] Error Url: /home/error
2020-04-18 09:10:09.086 +02:00 [DBG] Error Id Parameter: errorId
2020-04-18 09:10:09.472 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: RenderBody has not been called for the page at '/Views/Shared/_Layout.cshtml'. To ignore call IgnoreBody().
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.EnsureRenderedBodyOrSections()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:12:06.108 +02:00 [INF] Starting host...
2020-04-18 09:12:07.066 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 09:12:07.245 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 09:12:07.246 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 09:12:07.246 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 09:12:07.246 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 09:12:07.246 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 09:12:07.246 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 09:13:34.732 +02:00 [DBG] Login Url: /Account/Login
2020-04-18 09:13:34.736 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-18 09:13:34.736 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-18 09:13:34.736 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-18 09:13:34.736 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-18 09:13:34.736 +02:00 [DBG] Error Url: /home/error
2020-04-18 09:13:34.736 +02:00 [DBG] Error Id Parameter: errorId
2020-04-18 09:13:35.071 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: RenderBody has not been called for the page at '/Views/Shared/_Layout.cshtml'. To ignore call IgnoreBody().
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.EnsureRenderedBodyOrSections()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:13:40.489 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: RenderBody has not been called for the page at '/Views/Shared/_Layout.cshtml'. To ignore call IgnoreBody().
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.EnsureRenderedBodyOrSections()
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|29_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-18 09:40:12.229 +02:00 [INF] Starting host...
2020-04-18 09:40:22.071 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 09:40:22.707 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 09:40:22.708 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 09:40:22.708 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 09:40:22.708 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 09:40:22.708 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 09:40:22.708 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 09:40:30.699 +02:00 [DBG] Login Url: /Account/Login
2020-04-18 09:40:30.702 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-18 09:40:30.702 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-18 09:40:30.702 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-18 09:40:30.702 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-18 09:40:30.703 +02:00 [DBG] Error Url: /home/error
2020-04-18 09:40:30.703 +02:00 [DBG] Error Id Parameter: errorId
2020-04-18 09:40:43.528 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-18 09:40:48.031 +02:00 [INF] {"Username":"hhhhh","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLV3DF2GO76T:00000002","TimeStamp":"2020-04-18T07:40:48.0000000Z","ProcessId":23968,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2020-04-18 10:40:22.686 +02:00 [INF] Removing 0 grants
2020-04-18 10:40:22.767 +02:00 [INF] Removing 0 device flow codes
2020-04-18 11:43:35.170 +02:00 [INF] Removing 0 grants
2020-04-18 11:43:35.176 +02:00 [INF] Removing 0 device flow codes
2020-04-18 12:43:35.344 +02:00 [INF] Removing 0 grants
2020-04-18 12:43:35.350 +02:00 [INF] Removing 0 device flow codes
2020-04-18 13:43:35.609 +02:00 [INF] Removing 0 grants
2020-04-18 13:43:35.614 +02:00 [INF] Removing 0 device flow codes
2020-04-18 14:59:35.161 +02:00 [INF] Starting host...
2020-04-18 14:59:35.983 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 14:59:36.122 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 14:59:36.122 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 14:59:36.122 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 14:59:36.122 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 14:59:36.122 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 14:59:36.122 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 15:00:54.954 +02:00 [DBG] Login Url: /Account/Login
2020-04-18 15:00:54.955 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-18 15:00:54.955 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-18 15:00:54.956 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-18 15:00:54.956 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-18 15:00:54.956 +02:00 [DBG] Error Url: /home/error
2020-04-18 15:00:54.956 +02:00 [DBG] Error Id Parameter: errorId
2020-04-18 15:02:21.514 +02:00 [INF] Starting host...
2020-04-18 15:02:22.164 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-18 15:02:22.291 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-18 15:02:22.291 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-18 15:02:22.291 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-18 15:02:22.291 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-18 15:02:22.291 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-18 15:02:22.291 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-18 16:02:25.692 +02:00 [INF] Removing 0 grants
2020-04-18 16:02:25.726 +02:00 [INF] Removing 0 device flow codes
2020-04-18 17:02:26.127 +02:00 [INF] Removing 0 grants
2020-04-18 17:02:26.160 +02:00 [INF] Removing 0 device flow codes
2020-04-18 18:02:37.364 +02:00 [INF] Removing 0 grants
2020-04-18 18:02:38.285 +02:00 [INF] Removing 0 device flow codes
2020-04-20 07:26:04.843 +02:00 [INF] Starting host...
2020-04-20 07:26:14.235 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 07:26:15.018 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 07:26:15.018 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 07:26:15.018 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 07:26:15.018 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 07:26:15.018 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 07:26:15.018 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 07:27:11.476 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 07:27:11.478 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 07:27:11.478 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 07:27:11.479 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 07:27:11.479 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 07:27:11.479 +02:00 [DBG] Error Url: /home/error
2020-04-20 07:27:11.479 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 07:27:39.750 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The instance of entity type 'ApplicationUser' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Add[TEntity](TEntity entity)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.CreateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Thandizo.IdentityServer.Data.DataSeeder.UsersSeed(UserManager`1 userManager) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Data\DataSeeder.cs:line 33
   at Thandizo.IdentityServer.Controllers.HomeController.SeedUsers() in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Controllers\HomeController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-20 08:03:50.666 +02:00 [INF] Starting host...
2020-04-20 08:03:51.280 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 08:03:51.411 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 08:03:51.411 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 08:03:51.411 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 08:03:51.411 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 08:03:51.411 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 08:03:51.411 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 08:52:41.594 +02:00 [INF] Starting host...
2020-04-20 08:52:49.182 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 08:52:49.803 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 08:52:49.804 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 08:52:49.804 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 08:52:49.804 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 08:52:49.804 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 08:52:49.804 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 08:53:00.743 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 08:53:00.747 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 08:53:00.747 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 08:53:00.747 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 08:53:00.747 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 08:53:00.747 +02:00 [DBG] Error Url: /home/error
2020-04-20 08:53:00.747 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 09:39:08.682 +02:00 [INF] Starting host...
2020-04-20 09:39:09.323 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 09:39:09.472 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 09:39:09.472 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 09:39:09.472 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 09:39:09.472 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 09:39:09.472 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 09:39:09.472 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 09:44:51.580 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 09:44:51.583 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 09:44:51.583 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 09:44:51.583 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 09:44:51.583 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 09:44:51.583 +02:00 [DBG] Error Url: /home/error
2020-04-20 09:44:51.584 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 09:52:51.777 +02:00 [INF] Starting host...
2020-04-20 09:52:52.868 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 09:52:53.096 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 09:52:53.096 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 09:52:53.096 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 09:52:53.096 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 09:52:53.097 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 09:52:53.097 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 09:53:25.654 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 09:53:25.673 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 09:53:25.673 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 09:53:25.673 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 09:53:25.673 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 09:53:25.673 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 09:53:25.673 +02:00 [DBG] Error Url: /home/error
2020-04-20 09:53:25.673 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 13:03:10.239 +02:00 [INF] Removing 0 grants
2020-04-20 13:03:10.320 +02:00 [INF] Removing 0 device flow codes
2020-04-20 14:03:10.552 +02:00 [INF] Removing 0 grants
2020-04-20 14:03:10.581 +02:00 [INF] Removing 0 device flow codes
2020-04-20 15:03:10.759 +02:00 [INF] Removing 0 grants
2020-04-20 15:03:10.765 +02:00 [INF] Removing 0 device flow codes
2020-04-20 16:03:10.957 +02:00 [INF] Removing 0 grants
2020-04-20 16:03:10.968 +02:00 [INF] Removing 0 device flow codes
2020-04-20 17:03:11.091 +02:00 [INF] Removing 0 grants
2020-04-20 17:03:11.179 +02:00 [INF] Removing 0 device flow codes
2020-04-20 17:31:43.467 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 17:31:43.634 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 17:31:43.635 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 17:31:43.657 +02:00 [DBG] Start discovery request
2020-04-20 17:31:46.191 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 17:31:47.778 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 17:31:47.862 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 17:31:47.862 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 17:31:47.864 +02:00 [DBG] Start key discovery request
2020-04-20 17:31:48.416 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 17:31:48.464 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 17:31:48.464 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 17:31:48.466 +02:00 [DBG] Start authorize request
2020-04-20 17:31:48.518 +02:00 [DBG] No user present in authorize request
2020-04-20 17:31:48.534 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 17:31:49.344 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 17:31:49.349 +02:00 [ERR] Invalid client configuration for client thandizo_web_client: no allowed grant type specified
2020-04-20 17:31:49.576 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"no allowed grant type specified","ActivityId":"0HLV4VVJKE1LH:00000001","TimeStamp":"2020-04-20T15:31:49.0000000Z","ProcessId":11936,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-20 17:31:49.592 +02:00 [ERR] Unknown client or not enabled: thandizo_web_client
{"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229935083296707.MWU4MDlmNzUtZTQxYy00MGJhLTg4ODgtNzZmZGNkNTFiOTYwY2YwMTVmNzgtM2RkMy00OGQ5LTg4NzAtODQ2YzVjNzljMjdm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJZOSqTy8h-vUguFGvOfchqfPrUJT9b9Ng1b4mQ-0vI1KQIrAznYQ_ZvIB_jHinObK-tHB5hqyGDGnX8_-wK94OV3m0mmC5wGAHdByFwvEPVJJn-ICNoRkIuCVwwGGlkSzhGSoqblwVwEdCXh54dkEidVu71UP05Uuls5EvYbZwuzPcfW5W4uynPrwVnLF8L3pqAOEczKVXjQiJsutWJcHavGhQBBvG9IXvZGmdoA6zIxdiB8bU-pB6qmYtpZ4anH30qlitnZpIiICKSakYzVWC","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:31:49.597 +02:00 [ERR] Request validation failed
2020-04-20 17:31:49.597 +02:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229935083296707.MWU4MDlmNzUtZTQxYy00MGJhLTg4ODgtNzZmZGNkNTFiOTYwY2YwMTVmNzgtM2RkMy00OGQ5LTg4NzAtODQ2YzVjNzljMjdm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJZOSqTy8h-vUguFGvOfchqfPrUJT9b9Ng1b4mQ-0vI1KQIrAznYQ_ZvIB_jHinObK-tHB5hqyGDGnX8_-wK94OV3m0mmC5wGAHdByFwvEPVJJn-ICNoRkIuCVwwGGlkSzhGSoqblwVwEdCXh54dkEidVu71UP05Uuls5EvYbZwuzPcfW5W4uynPrwVnLF8L3pqAOEczKVXjQiJsutWJcHavGhQBBvG9IXvZGmdoA6zIxdiB8bU-pB6qmYtpZ4anH30qlitnZpIiICKSakYzVWC","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:31:49.600 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":null,"RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Unknown client or client not enabled","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV4VVJKE1LH:00000001","TimeStamp":"2020-04-20T15:31:49.0000000Z","ProcessId":11936,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-20 17:34:18.349 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 17:34:18.354 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 17:34:18.355 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 17:34:18.356 +02:00 [DBG] Start discovery request
2020-04-20 17:34:18.373 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 17:34:18.965 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 17:34:18.966 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 17:34:18.966 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 17:34:18.966 +02:00 [DBG] Start key discovery request
2020-04-20 17:34:19.108 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 17:34:19.133 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 17:34:19.133 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 17:34:19.133 +02:00 [DBG] Start authorize request
2020-04-20 17:34:19.136 +02:00 [DBG] No user present in authorize request
2020-04-20 17:34:19.136 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 17:34:19.177 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 17:34:19.210 +02:00 [ERR] Invalid client configuration for client thandizo_web_client: Client secret is required for hybrid, but no client secret is configured.
2020-04-20 17:34:19.211 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","Category":"Error","Name":"Invalid Client Configuration","EventType":"Error","Id":3001,"Message":"Client secret is required for hybrid, but no client secret is configured.","ActivityId":"0HLV4VVJKE1LJ:00000001","TimeStamp":"2020-04-20T15:34:19.0000000Z","ProcessId":11936,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"InvalidClientConfigurationEvent"}
2020-04-20 17:34:19.211 +02:00 [ERR] Unknown client or not enabled: thandizo_web_client
{"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229936590502659.MjkwMWIxMWEtNTUxNi00M2QwLTgzZDYtNjM5MTY1N2NlOTQwYmQ5MDE0NGUtMWJlNy00YjkwLTkxNWYtOWU4N2NmODM2NmVk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL0F5Rrx8e-iSR0hXH0QxqES_sdsgX3blXcldziSjPxrwP5jfUUC00LCXnwFp3veUJBUBKl0IW2VnFPs_0COqBLqKzJ5dl63FM6_rdwSOky9yWIvQPBiV5uy9wWxS-LfK7hqzzckht7sASXwgGWQJae7tr6T2m_RmvpnsLTlAS8pq6Y-gD8RIjL7nGBOEBJVY6RbdIiZVULCgDmEP5UpXBpeM193OHjdm4KkxIgZSIiEeqyiQqXWvjEsnXqaRaRM_2U7JF8TDnfNYIpk4LyMjYl","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:34:19.211 +02:00 [ERR] Request validation failed
2020-04-20 17:34:19.212 +02:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229936590502659.MjkwMWIxMWEtNTUxNi00M2QwLTgzZDYtNjM5MTY1N2NlOTQwYmQ5MDE0NGUtMWJlNy00YjkwLTkxNWYtOWU4N2NmODM2NmVk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL0F5Rrx8e-iSR0hXH0QxqES_sdsgX3blXcldziSjPxrwP5jfUUC00LCXnwFp3veUJBUBKl0IW2VnFPs_0COqBLqKzJ5dl63FM6_rdwSOky9yWIvQPBiV5uy9wWxS-LfK7hqzzckht7sASXwgGWQJae7tr6T2m_RmvpnsLTlAS8pq6Y-gD8RIjL7nGBOEBJVY6RbdIiZVULCgDmEP5UpXBpeM193OHjdm4KkxIgZSIiEeqyiQqXWvjEsnXqaRaRM_2U7JF8TDnfNYIpk4LyMjYl","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:34:19.212 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":null,"RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Unknown client or client not enabled","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV4VVJKE1LJ:00000001","TimeStamp":"2020-04-20T15:34:19.0000000Z","ProcessId":11936,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-20 17:36:12.312 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 17:36:12.448 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 17:36:12.448 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 17:36:12.449 +02:00 [DBG] Start authorize request
2020-04-20 17:36:12.449 +02:00 [DBG] No user present in authorize request
2020-04-20 17:36:12.450 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 17:36:12.498 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 17:36:12.499 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 17:36:12.537 +02:00 [ERR] Invalid redirect_uri: https://localhost:44348/signin-oidc
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5009/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229937722666250.YjlkZDc3NjgtZjZiYy00ZDQzLWEzZGItMGI5N2FhYWJlZTJhNmI3YTBhNmItNWUzZi00ZTQwLTkzMzAtZDg0MTE1OThlODU5","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLGGPEl0NA4NJ2HXtBehCW15d0r0-8JNHwVDZ9Ev5pknsCT2uFMjsS59fZv2n29YGVAXPvf9UuTESQ6-QBT98_aL8z664D-zYkFvHM5B5xyZ43b5DsrrQRlMwDVFjsgxvDulgOfwnn2fkejvyud6W0GKaoxWDmIQgFdrXH00vZK_rtsFKcEez1KjluhbSxiPpULMFSpnuZLfL74QfU1AkISGhsgEHzkPcIuCHEr81etLn7P0nH9PTMXxOnVYcgThpT21GFXIvc1oEQWdB8zi0St","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:36:12.537 +02:00 [ERR] Request validation failed
2020-04-20 17:36:12.537 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5009/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229937722666250.YjlkZDc3NjgtZjZiYy00ZDQzLWEzZGItMGI5N2FhYWJlZTJhNmI3YTBhNmItNWUzZi00ZTQwLTkzMzAtZDg0MTE1OThlODU5","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLGGPEl0NA4NJ2HXtBehCW15d0r0-8JNHwVDZ9Ev5pknsCT2uFMjsS59fZv2n29YGVAXPvf9UuTESQ6-QBT98_aL8z664D-zYkFvHM5B5xyZ43b5DsrrQRlMwDVFjsgxvDulgOfwnn2fkejvyud6W0GKaoxWDmIQgFdrXH00vZK_rtsFKcEez1KjluhbSxiPpULMFSpnuZLfL74QfU1AkISGhsgEHzkPcIuCHEr81etLn7P0nH9PTMXxOnVYcgThpT21GFXIvc1oEQWdB8zi0St","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:36:12.538 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV4VVJKE1LK:00000001","TimeStamp":"2020-04-20T15:36:12.0000000Z","ProcessId":11936,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-20 17:38:09.134 +02:00 [INF] Starting host...
2020-04-20 17:38:16.067 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 17:38:18.363 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 17:38:18.364 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 17:38:18.364 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 17:38:18.364 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 17:38:18.364 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 17:38:18.364 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 17:55:04.194 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 17:55:04.200 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 17:55:04.200 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 17:55:04.200 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 17:55:04.201 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 17:55:04.201 +02:00 [DBG] Error Url: /home/error
2020-04-20 17:55:04.201 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 17:55:04.224 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 17:55:04.287 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 17:55:04.288 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 17:55:04.289 +02:00 [DBG] Start authorize request
2020-04-20 17:55:04.304 +02:00 [DBG] No user present in authorize request
2020-04-20 17:55:04.308 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 17:55:09.000 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 17:55:09.012 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 17:55:09.059 +02:00 [ERR] Invalid redirect_uri: https://localhost:44348/signin-oidc
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:44348/signin-oidc\n","https://localhost:44348/signin-oidc\n"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229949039913441.NWZmY2UyY2UtMGFkNC00YzgwLWFjNDUtYTNhZDllNzRiZDk4NmIzMmFmZTYtNDNjMC00ZDg0LWE1MDMtMjFhZDY2NjU5M2Nm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKilKgcr3VNtoMS_buKMmF-o1TL00s4uo1TgwakzqElTCa_dMcCGJ9th81d2PXCz4jA2d4ZxZ9_obQLzh9fmzsEO2hViGRPQpvLEAe3rplJctTebaC8-EnnJmFl8z3imB5RVqagsn8nvRfhf3VHwbV2k1Qdk8DUP2x6gkvH3sPO7bgl1NX9TdkLhXHtprdGccSU3k0Xqx3ijJ3mBcB3ZGelYeq7fT9vHdG-m2jMDf7ttl3ssOICFQaxr5BF7XfAGzGVUcK-ZGuysYZhmMBNfNZ8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:55:09.078 +02:00 [ERR] Request validation failed
2020-04-20 17:55:09.080 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:44348/signin-oidc\n","https://localhost:44348/signin-oidc\n"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229949039913441.NWZmY2UyY2UtMGFkNC00YzgwLWFjNDUtYTNhZDllNzRiZDk4NmIzMmFmZTYtNDNjMC00ZDg0LWE1MDMtMjFhZDY2NjU5M2Nm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKilKgcr3VNtoMS_buKMmF-o1TL00s4uo1TgwakzqElTCa_dMcCGJ9th81d2PXCz4jA2d4ZxZ9_obQLzh9fmzsEO2hViGRPQpvLEAe3rplJctTebaC8-EnnJmFl8z3imB5RVqagsn8nvRfhf3VHwbV2k1Qdk8DUP2x6gkvH3sPO7bgl1NX9TdkLhXHtprdGccSU3k0Xqx3ijJ3mBcB3ZGelYeq7fT9vHdG-m2jMDf7ttl3ssOICFQaxr5BF7XfAGzGVUcK-ZGuysYZhmMBNfNZ8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:55:09.145 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58COCKR8H:00000001","TimeStamp":"2020-04-20T15:55:09.0000000Z","ProcessId":4572,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 17:55:51.373 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 17:55:51.378 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 17:55:51.378 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 17:55:51.378 +02:00 [DBG] Start authorize request
2020-04-20 17:55:51.379 +02:00 [DBG] No user present in authorize request
2020-04-20 17:55:51.379 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 17:55:51.494 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 17:55:51.494 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 17:55:51.498 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 17:55:51.499 +02:00 [DBG] No PKCE used.
2020-04-20 17:55:51.910 +02:00 [DBG] Found [] identity scopes in database
2020-04-20 17:55:52.044 +02:00 [DBG] Found [] API scopes in database
2020-04-20 17:55:52.051 +02:00 [ERR] Invalid scope: openid
2020-04-20 17:55:52.052 +02:00 [ERR] Request validation failed
2020-04-20 17:55:52.053 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIMQoTQdPck65FnIyP-mJcOge7u8vRG-1QcGxi3BAqpFgxR8DTjeLq-N4ezu_uMNZQ-uUJGRltd_W_rcJMtRBUrEqdWTL3AmsKm4tGw838KQNAoRgf1T51zrlYDgkFNs1olnTNESbl_qE8JBC5Vu2Z9yuZxvZBTETFjnuAn7FCsh4E29QdHQ2sez1gaBJSI4m1YoGyOJh4oKXV3TrvHLJOhAvikos4q38Idgocja2QH5NqjsmPokytxJ-ZdZkNqzBxSTnKiipADiv130lefF_KV","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229949513276506.YWYyZTRlZjYtMjMzYy00Y2VmLTkzNjktZWI4ZjQwNDNmYzViM2U0NzQ3ZGQtYWY5ZC00MTNlLWIyOWItM2UyMmIzODVlNzJj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIMQoTQdPck65FnIyP-mJcOge7u8vRG-1QcGxi3BAqpFgxR8DTjeLq-N4ezu_uMNZQ-uUJGRltd_W_rcJMtRBUrEqdWTL3AmsKm4tGw838KQNAoRgf1T51zrlYDgkFNs1olnTNESbl_qE8JBC5Vu2Z9yuZxvZBTETFjnuAn7FCsh4E29QdHQ2sez1gaBJSI4m1YoGyOJh4oKXV3TrvHLJOhAvikos4q38Idgocja2QH5NqjsmPokytxJ-ZdZkNqzBxSTnKiipADiv130lefF_KV","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 17:55:52.053 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58COCKR8I:00000001","TimeStamp":"2020-04-20T15:55:52.0000000Z","ProcessId":4572,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:04:57.646 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 18:04:57.656 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 18:04:57.656 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 18:04:57.658 +02:00 [DBG] Start discovery request
2020-04-20 18:04:57.995 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 18:04:58.630 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 18:04:58.637 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 18:04:58.638 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 18:04:58.640 +02:00 [DBG] Start key discovery request
2020-04-20 18:04:58.834 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:04:58.859 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:04:58.859 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:04:58.860 +02:00 [DBG] Start authorize request
2020-04-20 18:04:58.860 +02:00 [DBG] No user present in authorize request
2020-04-20 18:04:58.860 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:04:58.920 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:04:58.920 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:04:58.920 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:04:58.920 +02:00 [DBG] No PKCE used.
2020-04-20 18:04:58.921 +02:00 [ERR] scopes too long.
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJmKBZBKcHSh244-lAKSiUab5tDr6em27XGTSqdSjrqn55qEXKTaZc3AKJeLJLI6M0nMe_nIFGjNBpfu15hh9rqTWW9YiuFO1Z9qNGcFT9V9W8dBArD3JzwjLsdrXKx10ziTM3BcS5XvZtLK55GQ3VlxWnhBEwL3JeSXU1i8OEDcN90a3ke0DO461Yoe9LlBm5TLF8IS-w55EkoqxsXejWImLjQq_tRiaLY-YwXLjauxzM3K5ZKW6XexQ1QhpmlNzI54HLECJmtQm1ncgNFa2uF","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637229954987471398.MzllYWViOTctNGI0NS00N2RmLTgxMjUtYjUwNThkNjRiZjMwYzZlZGQ0MGQtMTA1OC00NTVkLWExYzYtNTM3MzY0ZWE0MDQ1","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJmKBZBKcHSh244-lAKSiUab5tDr6em27XGTSqdSjrqn55qEXKTaZc3AKJeLJLI6M0nMe_nIFGjNBpfu15hh9rqTWW9YiuFO1Z9qNGcFT9V9W8dBArD3JzwjLsdrXKx10ziTM3BcS5XvZtLK55GQ3VlxWnhBEwL3JeSXU1i8OEDcN90a3ke0DO461Yoe9LlBm5TLF8IS-w55EkoqxsXejWImLjQq_tRiaLY-YwXLjauxzM3K5ZKW6XexQ1QhpmlNzI54HLECJmtQm1ncgNFa2uF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:04:58.921 +02:00 [ERR] Request validation failed
2020-04-20 18:04:58.922 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJmKBZBKcHSh244-lAKSiUab5tDr6em27XGTSqdSjrqn55qEXKTaZc3AKJeLJLI6M0nMe_nIFGjNBpfu15hh9rqTWW9YiuFO1Z9qNGcFT9V9W8dBArD3JzwjLsdrXKx10ziTM3BcS5XvZtLK55GQ3VlxWnhBEwL3JeSXU1i8OEDcN90a3ke0DO461Yoe9LlBm5TLF8IS-w55EkoqxsXejWImLjQq_tRiaLY-YwXLjauxzM3K5ZKW6XexQ1QhpmlNzI54HLECJmtQm1ncgNFa2uF","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637229954987471398.MzllYWViOTctNGI0NS00N2RmLTgxMjUtYjUwNThkNjRiZjMwYzZlZGQ0MGQtMTA1OC00NTVkLWExYzYtNTM3MzY0ZWE0MDQ1","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJmKBZBKcHSh244-lAKSiUab5tDr6em27XGTSqdSjrqn55qEXKTaZc3AKJeLJLI6M0nMe_nIFGjNBpfu15hh9rqTWW9YiuFO1Z9qNGcFT9V9W8dBArD3JzwjLsdrXKx10ziTM3BcS5XvZtLK55GQ3VlxWnhBEwL3JeSXU1i8OEDcN90a3ke0DO461Yoe9LlBm5TLF8IS-w55EkoqxsXejWImLjQq_tRiaLY-YwXLjauxzM3K5ZKW6XexQ1QhpmlNzI54HLECJmtQm1ncgNFa2uF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:04:58.922 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":"hybrid","Error":"invalid_request","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58COCKR8K:00000001","TimeStamp":"2020-04-20T16:04:58.0000000Z","ProcessId":4572,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:06:26.228 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 18:06:26.232 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 18:06:26.233 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 18:06:26.236 +02:00 [DBG] Start discovery request
2020-04-20 18:06:26.262 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 18:06:26.750 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 18:06:26.754 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 18:06:26.755 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 18:06:26.755 +02:00 [DBG] Start key discovery request
2020-04-20 18:06:26.942 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:06:26.943 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:06:26.943 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:06:26.943 +02:00 [DBG] Start authorize request
2020-04-20 18:06:26.943 +02:00 [DBG] No user present in authorize request
2020-04-20 18:06:26.943 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:06:26.967 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:06:26.968 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:06:26.968 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:06:26.968 +02:00 [DBG] No PKCE used.
2020-04-20 18:06:26.971 +02:00 [DBG] Found [] identity scopes in database
2020-04-20 18:06:26.975 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:06:26.976 +02:00 [ERR] Invalid scope: openid
2020-04-20 18:06:26.976 +02:00 [ERR] Request validation failed
2020-04-20 18:06:26.976 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLJgBQwcgTyGOwHiyllb0rd7g2uM8wu_G_6YiyYqcrmuc34Il_7_vSHgkwf_AVSUmpotPYhSDEovhya7zNMuF7tOjroplXkvKOcPg89iD_te5zOOyCjRJrVz8HPJ2zDZbhEbuc_MxD_Y-q0jZoSJ9hZ6zkIQKYKrI9pMhvbNqde5lrLZvtt5Y_WQG-WMymBEasO7pG462Fv63-JTF-LnAim197COHDyVLJexYDXYuih4DPb9Kr3weQ1s9-TNPFv2FK1FNjCHPy3itEBYd6B-jC1","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229955868576296.Njc2YzhhOTctYzU4OC00MjEzLTkzYzUtMzYzNTFjNDczMTBjM2M0YWQ2OWQtMWJkNC00MjRjLWJkZTYtNWU1NDI1ZDM1MTk5","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLJgBQwcgTyGOwHiyllb0rd7g2uM8wu_G_6YiyYqcrmuc34Il_7_vSHgkwf_AVSUmpotPYhSDEovhya7zNMuF7tOjroplXkvKOcPg89iD_te5zOOyCjRJrVz8HPJ2zDZbhEbuc_MxD_Y-q0jZoSJ9hZ6zkIQKYKrI9pMhvbNqde5lrLZvtt5Y_WQG-WMymBEasO7pG462Fv63-JTF-LnAim197COHDyVLJexYDXYuih4DPb9Kr3weQ1s9-TNPFv2FK1FNjCHPy3itEBYd6B-jC1","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:06:26.977 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58COCKR8K:00000003","TimeStamp":"2020-04-20T16:06:26.0000000Z","ProcessId":4572,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:09:22.015 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:09:22.017 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:09:22.017 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:09:22.017 +02:00 [DBG] Start authorize request
2020-04-20 18:09:22.018 +02:00 [DBG] No user present in authorize request
2020-04-20 18:09:22.018 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:09:22.056 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:09:22.056 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:09:22.057 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:09:22.057 +02:00 [DBG] No PKCE used.
2020-04-20 18:09:22.062 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:09:22.112 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:09:22.124 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:09:22.130 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:09:22.168 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:09:22.169 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","UiLocales":null,"Nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:09:22.187 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:09:22.406 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:09:22.430 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:09:22.430 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:09:22.431 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:09:22.431 +02:00 [DBG] No PKCE used.
2020-04-20 18:09:22.433 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:09:22.439 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:09:22.442 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:09:22.448 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:09:22.448 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:09:22.477 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:09:22.477 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:10:48.519 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:10:48.634 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:10:48.840 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:10:48.840 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:10:48.840 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:10:48.840 +02:00 [DBG] No PKCE used.
2020-04-20 18:10:48.863 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:10:49.066 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:10:49.069 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:10:49.074 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:10:49.075 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:10:49.151 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:10:49.151 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:10:49.184 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:10:49.185 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:10:49.185 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:10:49.190 +02:00 [DBG] Start authorize callback request
2020-04-20 18:10:49.237 +02:00 [DBG] No user present in authorize request
2020-04-20 18:10:49.237 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:10:49.263 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:10:49.263 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:10:49.263 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:10:49.264 +02:00 [DBG] No PKCE used.
2020-04-20 18:10:49.266 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:10:49.273 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:10:49.275 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:10:49.281 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:10:49.281 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:10:49.282 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","UiLocales":null,"Nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:10:49.282 +02:00 [INF] Error: User denied consent
2020-04-20 18:10:49.283 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","UiLocales":null,"Nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229957619801011.Y2IwNWU3NDMtODkzNy00NWFlLWI5NzAtY2M2ZTU0Y2ZiY2IwZDI4OWVlNDYtNGE5Zi00YjI2LWI0MzctNjEwZDI5NWRiOGMz","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLSAiwNMCs7KRA3sFgQ8KQ_r_KCflhsRahjpUQJ_-lpgpSEwJGudVqkylVanqpAtBcy8slu8mI19nPo3jhNbVfy-szku2HZ4qwsURgAAj7wDDRjlZByNFufUjZZOuFDUWTNqk71Vat1sSNF-Z_X4c8LAaHvthQpKkl0MyOgttjAEK5FnPPkJU0kAaBeGATkzqOvq4666hfzX-SRh1AbpyIlW25mxz7JLyWURdKZG1QNmvFsCYre9Ebo97m9Qw3uHfDWuGg-yPQ8yDZHTvvxCkgt","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:10:49.283 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58COCKR8R:00000008","TimeStamp":"2020-04-20T16:10:49.0000000Z","ProcessId":4572,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:14:57.347 +02:00 [INF] Starting host...
2020-04-20 18:14:58.419 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:14:58.837 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:14:58.837 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:14:58.837 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:14:58.837 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:14:58.837 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:14:58.838 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:21:24.112 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:21:24.114 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:21:24.115 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:21:24.115 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:21:24.115 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:21:24.115 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:21:24.116 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:21:24.134 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:21:24.171 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:21:24.171 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:21:24.173 +02:00 [DBG] Start authorize request
2020-04-20 18:21:24.194 +02:00 [DBG] No user present in authorize request
2020-04-20 18:21:24.204 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:21:28.889 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:28.902 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:28.927 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:21:28.930 +02:00 [DBG] No PKCE used.
2020-04-20 18:21:29.093 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:29.238 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:29.254 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:29.259 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:29.267 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:21:29.287 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","UiLocales":null,"Nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:21:29.300 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:21:29.465 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:21:29.552 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:29.552 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:29.553 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:21:29.553 +02:00 [DBG] No PKCE used.
2020-04-20 18:21:29.555 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:29.560 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:29.563 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:29.568 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:29.569 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:21:29.600 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:29.600 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:44.184 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:21:44.320 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:21:44.359 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:44.359 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:44.360 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:21:44.360 +02:00 [DBG] No PKCE used.
2020-04-20 18:21:44.363 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:44.368 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:44.371 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:44.379 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:44.380 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:21:44.544 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:44.544 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:44.568 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:21:44.569 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:21:44.570 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:21:44.574 +02:00 [DBG] Start authorize callback request
2020-04-20 18:21:44.622 +02:00 [DBG] No user present in authorize request
2020-04-20 18:21:44.622 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:21:44.647 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:21:44.648 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:21:44.648 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:21:44.648 +02:00 [DBG] No PKCE used.
2020-04-20 18:21:44.650 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:44.677 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:44.680 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:21:44.685 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:21:44.685 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:21:44.686 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","UiLocales":null,"Nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:21:44.686 +02:00 [INF] Error: User denied consent
2020-04-20 18:21:44.688 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","UiLocales":null,"Nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229964839524521.NDM0ZDYzOWMtMjRmNy00NzI3LWEyYWQtOWRjYTI2NzM3NGZiMTYyY2U1NjgtMWVjOC00ZTUyLTg2MzEtMGU2MDdjMGYyNzM4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIIBizf_BFB0IzePheyIgZ0wsFJe2VtXcrnt2gw8IyIDVVlzIbrK14McG9cpBl04U6sLb5UkrhUNbtX8EKMZNaS4NtBHiqly9psckEnsrwXUr5RUBA9DLNko7SDDGYsnUSu6Ay-jJrGVTn0TQn3TiGvj_Qfw0s6lwDEZIbx9p9cQRYZeFiU0jyLp_fyO5KZ3UGecsyw2hYIAbfTLuVEu9RUyo17pjjYEQAEgltp6UZbp3cU4F52HzbuoFbTuJd5NiPRv3E-E0MaBz2A-i7k8MVO","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:21:44.704 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV58RF8F817:00000002","TimeStamp":"2020-04-20T16:21:44.0000000Z","ProcessId":34252,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:30:12.064 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 18:30:12.068 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 18:30:12.069 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 18:30:12.072 +02:00 [DBG] Start discovery request
2020-04-20 18:30:12.801 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 18:30:13.510 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 18:30:13.514 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 18:30:13.514 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 18:30:13.516 +02:00 [DBG] Start key discovery request
2020-04-20 18:30:13.814 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:30:13.818 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:30:13.818 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:30:13.819 +02:00 [DBG] Start authorize request
2020-04-20 18:30:13.821 +02:00 [DBG] No user present in authorize request
2020-04-20 18:30:13.821 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:30:13.910 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:30:13.911 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:30:13.911 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:30:13.911 +02:00 [DBG] No PKCE used.
2020-04-20 18:30:13.914 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:30:13.918 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:30:13.921 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:30:13.925 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:30:13.925 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:30:13.925 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","UiLocales":null,"Nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:30:13.925 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:30:13.958 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:30:13.976 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:30:13.976 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:30:13.976 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:30:13.976 +02:00 [DBG] No PKCE used.
2020-04-20 18:30:13.978 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:30:13.982 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:30:13.983 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:30:13.987 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:30:13.988 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:30:14.004 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:30:14.004 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:31:35.096 +02:00 [INF] Starting host...
2020-04-20 18:31:36.558 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:31:37.000 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:31:37.000 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:31:37.000 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:31:37.000 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:31:37.000 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:31:37.000 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:31:50.333 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:31:50.368 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:31:50.368 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:31:50.368 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:31:50.368 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:31:50.368 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:31:50.368 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:31:50.368 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:31:50.605 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:31:55.152 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:31:55.172 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:31:55.197 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:31:55.199 +02:00 [DBG] No PKCE used.
2020-04-20 18:31:55.363 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:31:55.552 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:31:55.574 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:31:55.579 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:31:55.587 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:31:55.748 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:31:55.749 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:31:55.798 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:31:55.806 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:31:55.807 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:31:55.809 +02:00 [DBG] Start authorize callback request
2020-04-20 18:31:55.841 +02:00 [DBG] No user present in authorize request
2020-04-20 18:31:55.841 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:31:55.925 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:31:55.925 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:31:55.925 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:31:55.925 +02:00 [DBG] No PKCE used.
2020-04-20 18:31:55.927 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:31:55.932 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:31:55.949 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:31:55.955 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:31:55.955 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:31:55.974 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","UiLocales":null,"Nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:31:55.984 +02:00 [INF] Error: User denied consent
2020-04-20 18:31:55.988 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","UiLocales":null,"Nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229970137318045.N2QzMjFlNTQtNGYxNy00NGUyLTgxYzktODZiY2MxNzI2NTc1MWJhMWY3ZGQtMDFmMS00NWEwLTlkNjktN2RmNGViMmUzM2Zh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKhoSoWwUcABGA6h_sQ8Hbj7XylN5q8tR0rAPjNLDUNqk1mPd97Xc1lGQ15I-a6I5ETQgFNShHTSoizzyLYbeACVFreZGtlcA8kBdH4IJaeV-mpmMWutbG6FKWI5D6muyRk9XUF7EJm2bpFvElXEZujKb4afpfX6Poxuchw_jMEzhpKitj7POjrHdxGQl4zpjBxCT9d4nVxUrSy6kvp5h3dZBrcq7MVFfR_Mdde0mjnWd0jOy4riked5enwvFvnuXdbZwnxHF8k2vVBSWCFMwAK","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:31:56.007 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV5918VPB1A:00000002","TimeStamp":"2020-04-20T16:31:55.0000000Z","ProcessId":33544,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:33:01.394 +02:00 [INF] Starting host...
2020-04-20 18:33:02.281 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:33:02.509 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:33:02.510 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:33:02.510 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:33:02.510 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:33:02.510 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:33:02.510 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:33:21.936 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:33:21.938 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:33:21.938 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:33:21.938 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:33:21.938 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:33:21.938 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:33:21.938 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:33:21.959 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:33:21.988 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:33:21.988 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:33:21.991 +02:00 [DBG] Start authorize request
2020-04-20 18:33:22.011 +02:00 [DBG] No user present in authorize request
2020-04-20 18:33:22.013 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:33:25.912 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:25.930 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:25.961 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:33:25.962 +02:00 [DBG] No PKCE used.
2020-04-20 18:33:26.096 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:26.229 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:26.246 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:26.250 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:26.257 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:33:26.273 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","UiLocales":null,"Nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:33:26.282 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:33:26.460 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:33:26.553 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:26.553 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:26.554 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:33:26.554 +02:00 [DBG] No PKCE used.
2020-04-20 18:33:26.556 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:26.562 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:26.565 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:26.570 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:26.570 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:33:26.600 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:26.600 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:44.513 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:33:44.607 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:33:44.797 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:44.798 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:44.798 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:33:44.798 +02:00 [DBG] No PKCE used.
2020-04-20 18:33:44.802 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:44.809 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:44.812 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:44.818 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:44.819 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:33:44.977 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:44.977 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:45.040 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:33:45.041 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:33:45.041 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:33:45.044 +02:00 [DBG] Start authorize callback request
2020-04-20 18:33:45.072 +02:00 [DBG] No user present in authorize request
2020-04-20 18:33:45.072 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:33:45.096 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:33:45.096 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:33:45.096 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:33:45.096 +02:00 [DBG] No PKCE used.
2020-04-20 18:33:45.100 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:45.107 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:45.109 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:33:45.127 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:33:45.128 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:33:45.128 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","UiLocales":null,"Nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:33:45.129 +02:00 [INF] Error: User denied consent
2020-04-20 18:33:45.132 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","UiLocales":null,"Nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229972017409321.MjZiZGI4ZmEtMWNiMS00MDI1LTkzMzQtOWVjMmVlZDA5NTVlOTczYmNmZGMtYWE1Ny00ZGVlLWFiMDgtNmFlN2RkMmI4N2Yw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIL8hG9mP4bB6SM3MUH_prpyNKJAFRRTlwKaVtpTXYzrZsCRgFn-itoftRYpRaj2pIq94zVRwbzKzrVp2DC0rAmuts1kxFNnPUJfPf_7aRjnEkxJuVlOOrLjd3xhBJkW1eDja1hy4eMyK3t0Z5nWNyb0AmBKNJF2d1ufXOGclYkl9JJCvvF3d3ht6hDvt-fQmdpVYngU0tSgMQjQ_jPGjqv4iCviLiRAyIqVt87rUoRUIfGSJwfS9sRV7bDWlPI3b_sKdum9VFUNsCPelNfSE7K","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:33:45.145 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV592566D4R:00000002","TimeStamp":"2020-04-20T16:33:45.0000000Z","ProcessId":8916,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:36:33.594 +02:00 [INF] Starting host...
2020-04-20 18:36:34.599 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:36:34.800 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:36:34.800 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:36:34.800 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:36:34.801 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:36:34.801 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:36:34.801 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:36:37.296 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:36:37.299 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:36:37.299 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:36:37.299 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:36:37.299 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:36:37.299 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:36:37.299 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:36:37.320 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:36:37.381 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:36:37.381 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:36:37.384 +02:00 [DBG] Start authorize request
2020-04-20 18:36:37.402 +02:00 [DBG] No user present in authorize request
2020-04-20 18:36:37.407 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:36:41.261 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:41.286 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:41.342 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:36:41.343 +02:00 [DBG] No PKCE used.
2020-04-20 18:36:41.591 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:41.787 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:41.818 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:41.825 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:41.834 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:36:41.855 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","UiLocales":null,"Nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:36:41.869 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:36:42.141 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:36:42.247 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:42.247 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:42.247 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:36:42.247 +02:00 [DBG] No PKCE used.
2020-04-20 18:36:42.250 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:42.255 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:42.257 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:42.262 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:42.262 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:36:42.288 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:42.288 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:52.213 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:36:52.329 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:36:52.389 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:52.389 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:52.389 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:36:52.389 +02:00 [DBG] No PKCE used.
2020-04-20 18:36:52.392 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:52.397 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:52.400 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:52.406 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:52.407 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:36:52.593 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:52.594 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:52.629 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:36:52.630 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:36:52.631 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:36:52.639 +02:00 [DBG] Start authorize callback request
2020-04-20 18:36:52.723 +02:00 [DBG] No user present in authorize request
2020-04-20 18:36:52.724 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:36:52.749 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:36:52.750 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:36:52.750 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:36:52.750 +02:00 [DBG] No PKCE used.
2020-04-20 18:36:52.753 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:52.760 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:52.763 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:36:52.770 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:36:52.770 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:36:52.771 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","UiLocales":null,"Nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:36:52.771 +02:00 [INF] Error: User denied consent
2020-04-20 18:36:52.774 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","UiLocales":null,"Nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229973970891130.ZDJiYTJlMDYtOWQ0NC00MjFjLTkzMTAtMDIyMWJiOTc0NTI1MmJlNTgzZGQtOGNiYS00YTgyLTlmMGQtMDYwYmE1MTU1MGRm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKWxSNCuYElu6cOMy-lBXQ_OGNaLEt5gGvl8JvK92Ub8K0aedvMY4_2Gm27yNbHjyUxHfm3tGiEmCJQCDnR7YmaxG-uNQL3OAcKB10mDSf9L6_ZAKQBuDhlqNheCKg02qZ-viEZsyoP4WnaILPbcx32VG7RipBZG_NoyZyKBaeLpRGadQTjxkBLtFU_4OeK9YPD5O5s8hcprB_djxF2XwXSflzy-0ilEA1-RFkLQxnphVvV0TqeZEuFE0pIKyjENv7cJ9GZJ2ww_G_IlRbS8CR2","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:36:52.788 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV593VCMM2H:00000003","TimeStamp":"2020-04-20T16:36:52.0000000Z","ProcessId":26472,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:42:00.360 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-20 18:42:00.363 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-20 18:42:00.364 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-20 18:42:00.368 +02:00 [DBG] Start discovery request
2020-04-20 18:42:00.756 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-20 18:42:01.579 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-20 18:42:01.585 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-20 18:42:01.586 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-20 18:42:01.588 +02:00 [DBG] Start key discovery request
2020-04-20 18:42:01.811 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:42:01.817 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:42:01.817 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:42:01.818 +02:00 [DBG] Start authorize request
2020-04-20 18:42:01.819 +02:00 [DBG] No user present in authorize request
2020-04-20 18:42:01.820 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:42:01.909 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:42:01.909 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:42:01.910 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:42:01.910 +02:00 [DBG] No PKCE used.
2020-04-20 18:42:01.913 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:42:01.919 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:42:01.922 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:42:01.928 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:42:01.928 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:42:01.929 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","UiLocales":null,"Nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:42:01.929 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:42:01.975 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:42:02.001 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:42:02.001 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:42:02.001 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:42:02.002 +02:00 [DBG] No PKCE used.
2020-04-20 18:42:02.004 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:42:02.010 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:42:02.013 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:42:02.019 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:42:02.020 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:42:02.042 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:42:02.042 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:43:24.433 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:43:24.442 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:43:24.470 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:43:24.470 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:43:24.471 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:43:24.471 +02:00 [DBG] No PKCE used.
2020-04-20 18:43:24.474 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:43:24.480 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:43:24.482 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:43:24.488 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:43:24.488 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:43:24.510 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:43:24.511 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:43:24.530 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:43:24.531 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:43:24.532 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:43:24.532 +02:00 [DBG] Start authorize callback request
2020-04-20 18:43:24.533 +02:00 [DBG] No user present in authorize request
2020-04-20 18:43:24.533 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:43:24.553 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:43:24.553 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:43:24.553 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:43:24.553 +02:00 [DBG] No PKCE used.
2020-04-20 18:43:24.555 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:43:24.559 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:43:24.561 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:43:24.565 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:43:24.565 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:43:24.565 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","UiLocales":null,"Nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:43:24.565 +02:00 [INF] Error: User denied consent
2020-04-20 18:43:24.566 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","UiLocales":null,"Nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229977217281151.ZTJhMTZhNDktMzQwOS00Y2ZmLWJjZGEtY2FjZDMyZDNjZGZmODM0OTM4YTYtYzRhOC00MjZlLWFjN2QtYmYyMjRmODZlYzcy","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKW93LHrU_9CNrUAA5d4IDa2TMxWgYwi28ikBcQP2_Gxo3TxaktY94xpkZtqGSFFJ7bSwEDE6AnKgekmHvfmOdcsf3sgcUGabpW1pYW-pc4lGAsscvca9PHChOK8GMUEG67bzHGVC4AZITdVXw4NXhSDtn0UYDAnKH0RbHc6OwunTWxegHIcTTQLlxZXG92Ceo-Wpz3PGNK-F0ipHa24_IZt__-AYZI4WAmlmM4_igEKeMKzM0q-BaI0MCPKeCp8D1Jqv2RGlIPjiYdqD8TRUHi","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:43:24.566 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV593VCMM2U:00000002","TimeStamp":"2020-04-20T16:43:24.0000000Z","ProcessId":26472,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:48:57.822 +02:00 [INF] Starting host...
2020-04-20 18:48:58.845 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:48:59.032 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:48:59.032 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:48:59.032 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:48:59.032 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:48:59.032 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:48:59.032 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:49:17.335 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:49:17.338 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:49:17.338 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:49:17.338 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:49:17.338 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:49:17.339 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:49:17.339 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:49:17.374 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:49:17.425 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:49:17.425 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:49:17.428 +02:00 [DBG] Start authorize request
2020-04-20 18:49:17.448 +02:00 [DBG] No user present in authorize request
2020-04-20 18:49:17.454 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:49:21.478 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:21.491 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:21.512 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:49:21.513 +02:00 [DBG] No PKCE used.
2020-04-20 18:49:21.715 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:21.881 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:21.904 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:21.910 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:21.919 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:49:21.939 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","UiLocales":null,"Nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:49:21.956 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:49:22.120 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:49:22.219 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:22.219 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:22.220 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:49:22.220 +02:00 [DBG] No PKCE used.
2020-04-20 18:49:22.223 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:22.229 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:22.232 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:22.238 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:22.238 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:49:22.270 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:22.270 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:27.426 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:49:27.520 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:49:27.561 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:27.561 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:27.561 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:49:27.561 +02:00 [DBG] No PKCE used.
2020-04-20 18:49:27.565 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:27.571 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:27.574 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:27.580 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:27.580 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:49:27.747 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:27.747 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:27.770 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:49:27.771 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:49:27.771 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:49:27.775 +02:00 [DBG] Start authorize callback request
2020-04-20 18:49:27.807 +02:00 [DBG] No user present in authorize request
2020-04-20 18:49:27.807 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:49:27.858 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:49:27.858 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:49:27.858 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:49:27.858 +02:00 [DBG] No PKCE used.
2020-04-20 18:49:27.861 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:27.868 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:27.871 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:49:27.877 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:49:27.877 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:49:27.878 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","UiLocales":null,"Nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:49:27.879 +02:00 [INF] Error: User denied consent
2020-04-20 18:49:27.881 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","UiLocales":null,"Nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229981571273938.ODBkOWYwNDUtYmI0Yi00Y2M5LTlkZWMtYzhhOGViNjVhM2MzMmNiYzUxOTEtMTM2YS00MTIxLWJhY2ItZTlhZWRlOWRhMThj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI_cA2di1L8qT5HpDqOu5HYLPy_K1XTsRjQ5p8e9y80p7xm8r1SdRRAhxJUYZJ-cu6s3nbcIiQjNdGba8fC9BTmuGF2KdfCLGfbMO8w49Qhx6qX3rc5HC2b6TCEj5ibB-iAd92PcMWFJjciroODVGrPzTkc_rv4c3GccWXk0knk_6elTk2VuFFOtjjvZiaEIcb54PexHM7CW_IUCTEfnnBt859ZXKX9kcfYBzmVLCnf3elwKdl1qngfnl6lINCE_-6HOaQoZlF4F9o1aWY4_zGG","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:49:27.896 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV59B1T12FB:00000003","TimeStamp":"2020-04-20T16:49:27.0000000Z","ProcessId":24012,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:51:51.478 +02:00 [INF] Starting host...
2020-04-20 18:52:08.865 +02:00 [FTL] Application startup exception
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
2020-04-20 18:52:10.360 +02:00 [FTL] Host terminated unexpectedly.
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-20 18:54:58.086 +02:00 [INF] Starting host...
2020-04-20 18:54:58.986 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:54:59.180 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:54:59.180 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:54:59.180 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:54:59.180 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:54:59.180 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:54:59.181 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:55:06.249 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:55:06.253 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:55:06.253 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:55:06.253 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:55:06.253 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:55:06.253 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:55:06.253 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:55:06.275 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:55:06.305 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:55:06.306 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:55:06.307 +02:00 [DBG] Start authorize request
2020-04-20 18:55:06.326 +02:00 [DBG] No user present in authorize request
2020-04-20 18:55:06.329 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:55:11.450 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:11.473 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:11.504 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:55:11.505 +02:00 [DBG] No PKCE used.
2020-04-20 18:55:11.758 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:12.190 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:12.215 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:12.221 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:12.229 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:55:12.250 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","UiLocales":null,"Nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:55:12.266 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:55:12.420 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:55:12.495 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:12.496 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:12.496 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:55:12.496 +02:00 [DBG] No PKCE used.
2020-04-20 18:55:12.499 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:12.505 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:12.508 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:12.515 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:12.515 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:55:12.547 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:12.547 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:40.502 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 18:55:40.575 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:55:40.608 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:40.608 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:40.609 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:55:40.609 +02:00 [DBG] No PKCE used.
2020-04-20 18:55:40.611 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:40.617 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:40.620 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:40.626 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:40.626 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:55:40.775 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:40.775 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:40.808 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 18:55:40.810 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 18:55:40.810 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 18:55:40.813 +02:00 [DBG] Start authorize callback request
2020-04-20 18:55:40.852 +02:00 [DBG] No user present in authorize request
2020-04-20 18:55:40.852 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:55:40.879 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:55:40.879 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:55:40.879 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:55:40.879 +02:00 [DBG] No PKCE used.
2020-04-20 18:55:40.881 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:40.888 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:40.890 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:55:40.896 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:55:40.896 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:55:40.897 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","UiLocales":null,"Nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:55:40.898 +02:00 [INF] Error: User denied consent
2020-04-20 18:55:40.900 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","UiLocales":null,"Nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229985060802867.NzYyY2UwZDMtNTIyYi00MjIyLWFmMDYtY2VlZWE2ZTIyYjRmNThjNzNhMGMtMzVjZS00MGMyLThhNWItMjQyNTkxMzgyODE4","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKPvvpUbN_Qz8N9IybcYFlxf7QH_Ns16z_qooR8-A2YGrd-cvlvmPwze-sAbR_eniBDS7vA5zJtNPf1mzfptuyIzAbTeiFpzo7lKzj6iE0EUUNqWA_xDtj52EN_czPgtTvmppNE4fpFd8TDaVutfH1-wxCBBZX2xzgcrTP779MYuv0Qqp9M4u25-ndFvavSAXvgud-KqVZYLxmxR4sGPbsEqdiLiQWOQaE6nuZtKdYNsXlmyhF7r8XCR_2es5GihqsTIOPHCyupXibhRkfaaSlD","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:55:40.913 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":null,"Scopes":"openid profile offline_access","GrantType":"hybrid","Error":"access_denied","ErrorDescription":null,"Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV59E9SSI2S:00000005","TimeStamp":"2020-04-20T16:55:40.0000000Z","ProcessId":33264,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedFailureEvent"}
2020-04-20 18:59:44.939 +02:00 [INF] Starting host...
2020-04-20 18:59:45.996 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-20 18:59:46.229 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-20 18:59:46.229 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-20 18:59:46.229 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-20 18:59:46.229 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-20 18:59:46.229 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-20 18:59:46.230 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-20 18:59:52.393 +02:00 [DBG] Login Url: /Account/Login
2020-04-20 18:59:52.395 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-20 18:59:52.395 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-20 18:59:52.395 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-20 18:59:52.395 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-20 18:59:52.395 +02:00 [DBG] Error Url: /home/error
2020-04-20 18:59:52.395 +02:00 [DBG] Error Id Parameter: errorId
2020-04-20 18:59:52.414 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-20 18:59:52.441 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-20 18:59:52.442 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-20 18:59:52.445 +02:00 [DBG] Start authorize request
2020-04-20 18:59:52.459 +02:00 [DBG] No user present in authorize request
2020-04-20 18:59:52.462 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:59:57.105 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:59:57.120 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:59:57.140 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:59:57.141 +02:00 [DBG] No PKCE used.
2020-04-20 18:59:57.301 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:59:57.443 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:59:57.464 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:59:57.469 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:59:57.477 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:59:57.500 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJdu6XHIeikXlFgDbWIsY9XBmbPll5Nr8rKBwRSRUgsJrOneG7a9wMh2yKZzXp2sodT3P9meW8fKRReQ8vduRAorDszSrtqPhq7Glt5xrCdiyvH8vFgeBGYy5ruYIc8ZVdJZBASScDwwdiCXLKqenfbCPnEyoc1HrQad3hYvUkl0KqS-Z5lolfIn3g3ukxKiLy1y4ju2mpwTfz1HOcPvjINoA2XxnWz8J7G14W8JnJI5x4vtNQ2BUDne3Y_GzhYFPjGOBc_At8e-rITgacLsyC6","UiLocales":null,"Nonce":"637229987921922980.OTFlZGNkODctMTg4My00YmQxLWJhNTctOWMxMzc2ZTc1N2NiMDMwODkyYzctNmE2MC00MTk2LTk0M2ItNjZlZTE5NzU4MGFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229987921922980.OTFlZGNkODctMTg4My00YmQxLWJhNTctOWMxMzc2ZTc1N2NiMDMwODkyYzctNmE2MC00MTk2LTk0M2ItNjZlZTE5NzU4MGFm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJdu6XHIeikXlFgDbWIsY9XBmbPll5Nr8rKBwRSRUgsJrOneG7a9wMh2yKZzXp2sodT3P9meW8fKRReQ8vduRAorDszSrtqPhq7Glt5xrCdiyvH8vFgeBGYy5ruYIc8ZVdJZBASScDwwdiCXLKqenfbCPnEyoc1HrQad3hYvUkl0KqS-Z5lolfIn3g3ukxKiLy1y4ju2mpwTfz1HOcPvjINoA2XxnWz8J7G14W8JnJI5x4vtNQ2BUDne3Y_GzhYFPjGOBc_At8e-rITgacLsyC6","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 18:59:57.513 +02:00 [INF] Showing login: User is not authenticated
2020-04-20 18:59:57.701 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 18:59:57.787 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:59:57.787 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 18:59:57.788 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 18:59:57.788 +02:00 [DBG] No PKCE used.
2020-04-20 18:59:57.790 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:59:57.795 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:59:57.797 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 18:59:57.802 +02:00 [DBG] Found [] API scopes in database
2020-04-20 18:59:57.802 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 18:59:57.827 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 18:59:57.828 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:02.978 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-20 19:00:03.096 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 19:00:03.198 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:03.198 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:03.198 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 19:00:03.198 +02:00 [DBG] No PKCE used.
2020-04-20 19:00:03.202 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:03.207 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:03.210 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:03.217 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:03.217 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 19:00:04.081 +02:00 [DBG] Augmenting SignInContext
2020-04-20 19:00:04.083 +02:00 [DBG] Adding idp claim with value: local
2020-04-20 19:00:04.084 +02:00 [DBG] Adding auth_time claim with value: 1587402004
2020-04-20 19:00:04.152 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-20 19:00:04.165 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV59GV5GKBJ:00000002","TimeStamp":"2020-04-20T17:00:04.0000000Z","ProcessId":3096,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"UserLoginSuccessEvent"}
2020-04-20 19:00:04.230 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:04.230 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:04.261 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-20 19:00:04.264 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-20 19:00:04.264 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-20 19:00:04.273 +02:00 [DBG] Start authorize callback request
2020-04-20 19:00:04.292 +02:00 [DBG] User in authorize request: 1
2020-04-20 19:00:04.292 +02:00 [DBG] Start authorize request protocol validation
2020-04-20 19:00:04.322 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:04.322 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:04.322 +02:00 [DBG] Checking for PKCE parameters
2020-04-20 19:00:04.322 +02:00 [DBG] No PKCE used.
2020-04-20 19:00:04.325 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:04.332 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:04.335 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:04.340 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:04.340 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-20 19:00:04.341 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJdu6XHIeikXlFgDbWIsY9XBmbPll5Nr8rKBwRSRUgsJrOneG7a9wMh2yKZzXp2sodT3P9meW8fKRReQ8vduRAorDszSrtqPhq7Glt5xrCdiyvH8vFgeBGYy5ruYIc8ZVdJZBASScDwwdiCXLKqenfbCPnEyoc1HrQad3hYvUkl0KqS-Z5lolfIn3g3ukxKiLy1y4ju2mpwTfz1HOcPvjINoA2XxnWz8J7G14W8JnJI5x4vtNQ2BUDne3Y_GzhYFPjGOBc_At8e-rITgacLsyC6","UiLocales":null,"Nonce":"637229987921922980.OTFlZGNkODctMTg4My00YmQxLWJhNTctOWMxMzc2ZTc1N2NiMDMwODkyYzctNmE2MC00MTk2LTk0M2ItNjZlZTE5NzU4MGFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"Wfaq4wANZhN3ukG9_g2VaQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile  offline_access","response_mode":"form_post","nonce":"637229987921922980.OTFlZGNkODctMTg4My00YmQxLWJhNTctOWMxMzc2ZTc1N2NiMDMwODkyYzctNmE2MC00MTk2LTk0M2ItNjZlZTE5NzU4MGFm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJdu6XHIeikXlFgDbWIsY9XBmbPll5Nr8rKBwRSRUgsJrOneG7a9wMh2yKZzXp2sodT3P9meW8fKRReQ8vduRAorDszSrtqPhq7Glt5xrCdiyvH8vFgeBGYy5ruYIc8ZVdJZBASScDwwdiCXLKqenfbCPnEyoc1HrQad3hYvUkl0KqS-Z5lolfIn3g3ukxKiLy1y4ju2mpwTfz1HOcPvjINoA2XxnWz8J7G14W8JnJI5x4vtNQ2BUDne3Y_GzhYFPjGOBc_At8e-rITgacLsyC6","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-20 19:00:04.395 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-20 19:00:04.408 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-20 19:00:04.628 +02:00 [DBG] xbjLtclPSAP+j6vFsFvgX6WdL3eoCU3XCex4b62MaM4= not found in database
2020-04-20 19:00:04.943 +02:00 [DBG] Creating Implicit Flow response.
2020-04-20 19:00:04.982 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-20 19:00:05.172 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****3s2g","$type":"Token"},{"TokenType":"code","TokenValue":"****poco","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV59GV5GKBJ:00000003","TimeStamp":"2020-04-20T17:00:05.0000000Z","ProcessId":3096,"LocalIpAddress":"::ffff:127.0.0.1:5004","RemoteIpAddress":"::ffff:127.0.0.1","$type":"TokenIssuedSuccessEvent"}
2020-04-20 19:00:05.174 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJdu6XHIeikXlFgDbWIsY9XBmbPll5Nr8rKBwRSRUgsJrOneG7a9wMh2yKZzXp2sodT3P9meW8fKRReQ8vduRAorDszSrtqPhq7Glt5xrCdiyvH8vFgeBGYy5ruYIc8ZVdJZBASScDwwdiCXLKqenfbCPnEyoc1HrQad3hYvUkl0KqS-Z5lolfIn3g3ukxKiLy1y4ju2mpwTfz1HOcPvjINoA2XxnWz8J7G14W8JnJI5x4vtNQ2BUDne3Y_GzhYFPjGOBc_At8e-rITgacLsyC6","Scope":"openid profile offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-20 19:00:05.193 +02:00 [DBG] Augmenting SignInContext
2020-04-20 19:00:05.194 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-20 19:00:06.059 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-20 19:00:06.070 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-20 19:00:06.070 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-20 19:00:06.094 +02:00 [DBG] Start token request.
2020-04-20 19:00:06.097 +02:00 [DBG] Start client validation
2020-04-20 19:00:06.137 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-20 19:00:06.140 +02:00 [DBG] Start parsing for secret in post body
2020-04-20 19:00:06.141 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-20 19:00:06.141 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-20 19:00:06.172 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:06.172 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:06.186 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-20 19:00:06.186 +02:00 [DBG] Client validation success
2020-04-20 19:00:06.188 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV59GV5GKBL:00000001","TimeStamp":"2020-04-20T17:00:06.0000000Z","ProcessId":3096,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-20 19:00:06.193 +02:00 [DBG] Start token request validation
2020-04-20 19:00:06.200 +02:00 [DBG] Start validation of authorization code token request
2020-04-20 19:00:06.232 +02:00 [DBG] xbjLtclPSAP+j6vFsFvgX6WdL3eoCU3XCex4b62MaM4= found in database: true
2020-04-20 19:00:06.329 +02:00 [DBG] removing xbjLtclPSAP+j6vFsFvgX6WdL3eoCU3XCex4b62MaM4= persisted grant from database
2020-04-20 19:00:06.377 +02:00 [DBG] Validation of authorization code token request success
2020-04-20 19:00:06.383 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"P_kYv4G9kR0RL-fvakpWpq3RichO05Wnjw25pH2poco","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"P_kYv4G9kR0RL-fvakpWpq3RichO05Wnjw25pH2poco","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-20 19:00:06.416 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:06.416 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:06.420 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:06.426 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:06.444 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-20 19:00:06.444 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-20 19:00:06.460 +02:00 [DBG] Creating refresh token
2020-04-20 19:00:06.460 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-20 19:00:06.489 +02:00 [DBG] us1dVYcQaPATSc1pIo0YleFGhkTvwv/9e0aja6nb2DU= not found in database
2020-04-20 19:00:06.519 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:06.519 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:06.521 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:06.527 +02:00 [DBG] Found [] API scopes in database
2020-04-20 19:00:06.527 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-20 19:00:06.536 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****ozYw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****GUhQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Xhaw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV59GV5GKBL:00000001","TimeStamp":"2020-04-20T17:00:06.0000000Z","ProcessId":3096,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-20 19:00:06.539 +02:00 [DBG] Token request success.
2020-04-20 19:00:06.769 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-20 19:00:06.770 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-20 19:00:06.771 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-20 19:00:06.776 +02:00 [DBG] Start userinfo request
2020-04-20 19:00:06.778 +02:00 [DBG] Bearer token found in header
2020-04-20 19:00:06.894 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:06.894 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:06.918 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-20 19:00:06.918 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-20 19:00:06.922 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-20 19:00:06.923 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587402006,"exp":1587488406,"iss":"http://localhost:5004","client_id":"thandizo_web_client","sub":"1","auth_time":1587402004,"idp":"local","scope":["openid","profile","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-20 19:00:06.929 +02:00 [DBG] Creating userinfo response
2020-04-20 19:00:06.934 +02:00 [DBG] Scopes in access token: openid profile offline_access
2020-04-20 19:00:06.936 +02:00 [DBG] Scopes in access token: openid profile offline_access
2020-04-20 19:00:06.940 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:06.945 +02:00 [DBG] Requested claim types: 
2020-04-20 19:00:06.945 +02:00 [DBG] Scopes in access token: openid profile offline_access
2020-04-20 19:00:06.949 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-20 19:00:06.953 +02:00 [INF] Profile service returned the following claim types: 
2020-04-20 19:00:06.953 +02:00 [DBG] End userinfo request
2020-04-20 20:26:00.519 +02:00 [INF] Removing 0 grants
2020-04-20 20:26:00.554 +02:00 [INF] Removing 0 device flow codes
2020-04-20 21:26:00.823 +02:00 [INF] Removing 0 grants
2020-04-20 21:26:00.833 +02:00 [INF] Removing 0 device flow codes
2020-04-20 22:26:01.028 +02:00 [INF] Removing 0 grants
2020-04-20 22:26:01.036 +02:00 [INF] Removing 0 device flow codes
2020-04-20 23:26:01.352 +02:00 [INF] Removing 0 grants
2020-04-20 23:26:01.395 +02:00 [INF] Removing 0 device flow codes
2020-04-21 08:46:16.127 +02:00 [INF] Removing 0 grants
2020-04-21 08:46:16.136 +02:00 [INF] Removing 0 device flow codes
2020-04-21 09:12:55.869 +02:00 [INF] Starting host...
2020-04-21 09:13:12.534 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 09:13:13.666 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 09:13:13.666 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 09:13:13.666 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 09:13:13.666 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 09:13:13.666 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 09:13:13.666 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 10:13:14.721 +02:00 [INF] Removing 0 grants
2020-04-21 10:13:14.739 +02:00 [INF] Removing 0 device flow codes
2020-04-21 10:22:26.024 +02:00 [INF] Starting host...
2020-04-21 10:22:27.763 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 10:22:28.165 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 10:22:28.165 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 10:22:28.166 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 10:22:28.166 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 10:22:28.166 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 10:22:28.166 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 11:22:30.740 +02:00 [INF] Removing 0 grants
2020-04-21 11:22:30.763 +02:00 [INF] Removing 0 device flow codes
2020-04-21 11:29:07.223 +02:00 [DBG] Login Url: /Account/Login
2020-04-21 11:29:07.225 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-21 11:29:07.226 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-21 11:29:07.226 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-21 11:29:07.226 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-21 11:29:07.226 +02:00 [DBG] Error Url: /home/error
2020-04-21 11:29:07.226 +02:00 [DBG] Error Id Parameter: errorId
2020-04-21 11:29:07.246 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-21 11:29:07.307 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-21 11:29:07.307 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-21 11:29:07.310 +02:00 [DBG] Start discovery request
2020-04-21 11:29:09.341 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-21 11:29:11.275 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-21 11:29:11.278 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-21 11:29:11.279 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-21 11:29:11.281 +02:00 [DBG] Start key discovery request
2020-04-21 11:29:12.186 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 11:29:12.189 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 11:29:12.189 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 11:29:12.221 +02:00 [DBG] Processing signout request for 1
2020-04-21 11:29:12.228 +02:00 [DBG] Start end session request validation
2020-04-21 11:29:12.255 +02:00 [DBG] Start identity token validation
2020-04-21 11:29:12.839 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:29:12.855 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:29:12.860 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 11:29:13.050 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:29:13.062 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587402006,"exp":1587488406,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637229987921922980.OTFlZGNkODctMTg4My00YmQxLWJhNTctOWMxMzc2ZTc1N2NiMDMwODkyYzctNmE2MC00MTk2LTk0M2ItNjZlZTE5NzU4MGFm","iat":1587402006,"at_hash":"HUOXpofD4ulyZzpAU8Dl2w","s_hash":"_nb1RPJTWejXLNxRjQSSlA","sid":"Wfaq4wANZhN3ukG9_g2VaQ","sub":"1","auth_time":1587402004,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:29:13.082 +02:00 [WRN] Invalid PostLogoutRedirectUri: https://localhost:44348/signout-callback-oidc
2020-04-21 11:29:13.087 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKx29wlJwh93xrcgGlJElDZAE717jXoXNfN7Ifw3xbep6B4Aw0lNnO_PnYoa70uM9TUx0lzqPxhZpJZEygTuv9IHEQ2131xvNS9KxiEaUAgI3XsLAibkq8IRhYNXGjVnUbHaQDGOzBE_ceSVLQQmM0k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 11:29:13.089 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 11:29:13.374 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 11:29:13.374 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 11:29:13.376 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 11:29:13.564 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5QPO8NV3U:00000002","TimeStamp":"2020-04-21T09:29:13.0000000Z","ProcessId":26424,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 11:29:13.918 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 11:29:13.922 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 11:29:13.923 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 11:29:13.926 +02:00 [DBG] Processing signout callback request
2020-04-21 11:29:13.980 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:29:13.980 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:29:13.982 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 11:29:13.982 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 11:29:13.986 +02:00 [INF] Successful signout callback.
2020-04-21 11:29:13.986 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 11:29:13.986 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 11:29:41.599 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 11:29:42.009 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:29:42.011 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 11:29:42.011 +02:00 [DBG] Adding auth_time claim with value: 1587461382
2020-04-21 11:29:42.020 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:29:42.030 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5QPO8NV3U:00000005","TimeStamp":"2020-04-21T09:29:42.0000000Z","ProcessId":26424,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 11:29:58.811 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 11:29:58.815 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 11:29:58.815 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 11:29:58.818 +02:00 [DBG] Start authorize request
2020-04-21 11:29:58.822 +02:00 [DBG] User in authorize request: 1
2020-04-21 11:29:58.826 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:29:58.855 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:29:58.855 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:29:58.872 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:29:58.873 +02:00 [DBG] No PKCE used.
2020-04-21 11:29:58.885 +02:00 [ERR] scopes too long.
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLPKM9HUgdHjsw_1IpECMp4av4zv7qqukaesvVY0CUG5tw_fx4yyxwdzWCmPCfTJgPlxIUjcO18vT89ooPAcGOMAbWpSlm4FjM_AxZ6sPdfyOp--LbERjP4_AKOJRDuHTqAzrAQCCLUjmihIRZtFluEataBXZOqLiTiFu9ovJME-SE0hYwOqeLYNb297wknGRtGhfCkkyuv5Qs3d688jO5PAO7xntx-C_7fF8xTpDPbJAv2e9OL92t3V4sRFXeMgN8hqAi9RLMYAC040lEgzQi5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230581987778786.MjllZDcwMWYtMjUxZS00NTQ3LWE4ZDYtMWFjM2ViOWEwM2I3ZDViYTQ2N2YtNTlmNy00MzYxLWEzYmItYmQ1ZjMwODNjOWFj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLPKM9HUgdHjsw_1IpECMp4av4zv7qqukaesvVY0CUG5tw_fx4yyxwdzWCmPCfTJgPlxIUjcO18vT89ooPAcGOMAbWpSlm4FjM_AxZ6sPdfyOp--LbERjP4_AKOJRDuHTqAzrAQCCLUjmihIRZtFluEataBXZOqLiTiFu9ovJME-SE0hYwOqeLYNb297wknGRtGhfCkkyuv5Qs3d688jO5PAO7xntx-C_7fF8xTpDPbJAv2e9OL92t3V4sRFXeMgN8hqAi9RLMYAC040lEgzQi5","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:29:58.888 +02:00 [ERR] Request validation failed
2020-04-21 11:29:58.888 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLPKM9HUgdHjsw_1IpECMp4av4zv7qqukaesvVY0CUG5tw_fx4yyxwdzWCmPCfTJgPlxIUjcO18vT89ooPAcGOMAbWpSlm4FjM_AxZ6sPdfyOp--LbERjP4_AKOJRDuHTqAzrAQCCLUjmihIRZtFluEataBXZOqLiTiFu9ovJME-SE0hYwOqeLYNb297wknGRtGhfCkkyuv5Qs3d688jO5PAO7xntx-C_7fF8xTpDPbJAv2e9OL92t3V4sRFXeMgN8hqAi9RLMYAC040lEgzQi5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230581987778786.MjllZDcwMWYtMjUxZS00NTQ3LWE4ZDYtMWFjM2ViOWEwM2I3ZDViYTQ2N2YtNTlmNy00MzYxLWEzYmItYmQ1ZjMwODNjOWFj","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLPKM9HUgdHjsw_1IpECMp4av4zv7qqukaesvVY0CUG5tw_fx4yyxwdzWCmPCfTJgPlxIUjcO18vT89ooPAcGOMAbWpSlm4FjM_AxZ6sPdfyOp--LbERjP4_AKOJRDuHTqAzrAQCCLUjmihIRZtFluEataBXZOqLiTiFu9ovJME-SE0hYwOqeLYNb297wknGRtGhfCkkyuv5Qs3d688jO5PAO7xntx-C_7fF8xTpDPbJAv2e9OL92t3V4sRFXeMgN8hqAi9RLMYAC040lEgzQi5","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:29:58.891 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"","GrantType":"hybrid","Error":"invalid_request","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV5QPO8NV47:00000001","TimeStamp":"2020-04-21T09:29:58.0000000Z","ProcessId":26424,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-21 11:40:16.034 +02:00 [INF] Starting host...
2020-04-21 11:40:18.982 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 11:40:19.788 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 11:40:19.788 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 11:40:19.789 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 11:40:19.789 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 11:40:19.789 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 11:40:19.789 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 11:40:54.787 +02:00 [DBG] Login Url: /Account/Login
2020-04-21 11:40:54.792 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-21 11:40:54.793 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-21 11:40:54.793 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-21 11:40:54.793 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-21 11:40:54.793 +02:00 [DBG] Error Url: /home/error
2020-04-21 11:40:54.793 +02:00 [DBG] Error Id Parameter: errorId
2020-04-21 11:40:54.817 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-21 11:40:54.854 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-21 11:40:54.855 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-21 11:40:54.858 +02:00 [DBG] Start discovery request
2020-04-21 11:40:58.392 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-21 11:40:59.168 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-21 11:40:59.174 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-21 11:40:59.174 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-21 11:40:59.176 +02:00 [DBG] Start key discovery request
2020-04-21 11:40:59.406 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 11:40:59.414 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 11:40:59.414 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 11:40:59.415 +02:00 [DBG] Start authorize request
2020-04-21 11:40:59.433 +02:00 [DBG] User in authorize request: 1
2020-04-21 11:40:59.434 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:41:00.050 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:00.060 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:00.073 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:41:00.074 +02:00 [DBG] No PKCE used.
2020-04-21 11:41:00.174 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:00.245 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:41:00.265 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:00.272 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:41:00.282 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:41:00.300 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIPkYDPY24Ofzx2rMZ6EJ18mCU0SOdOVdEUNa0qvbFz0oGkgv33SPWJrrgAvl57KM2OqWXFbtgpUgbcX9k9IUQ8d3OepyftSL3C7OKqnEoZF5oEH4Ar_Hqp1NNqdTM2zHhxGdmDT4k0nvMLHNcNCk_1Px5JR_GXTAG91UMljImbZsoLTX-hTqd8RSG6dykofd4FNfmrZ64Ol1CZWhIihzuNbV2qOct4-5W5F5kCnNu_kuBYOrVzxwDQ4o1zUqIPqO-zcz5jsl5d79JtvrMddzTh","UiLocales":null,"Nonce":"637230588592973411.Y2ZkZmFmMzEtODQzMy00N2NjLWE0OTgtOTM1MjhlMWFhNzNlNDdhMjU1ZWItOGRiNi00ZDg1LWExYzMtYjY0N2YwOWVmMDgz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"VkLHSHBPLtm8irkfCtRJZg","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230588592973411.Y2ZkZmFmMzEtODQzMy00N2NjLWE0OTgtOTM1MjhlMWFhNzNlNDdhMjU1ZWItOGRiNi00ZDg1LWExYzMtYjY0N2YwOWVmMDgz","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIPkYDPY24Ofzx2rMZ6EJ18mCU0SOdOVdEUNa0qvbFz0oGkgv33SPWJrrgAvl57KM2OqWXFbtgpUgbcX9k9IUQ8d3OepyftSL3C7OKqnEoZF5oEH4Ar_Hqp1NNqdTM2zHhxGdmDT4k0nvMLHNcNCk_1Px5JR_GXTAG91UMljImbZsoLTX-hTqd8RSG6dykofd4FNfmrZ64Ol1CZWhIihzuNbV2qOct4-5W5F5kCnNu_kuBYOrVzxwDQ4o1zUqIPqO-zcz5jsl5d79JtvrMddzTh","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:41:00.552 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 11:41:00.557 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 11:41:00.727 +02:00 [DBG] jEjK2pTsq5EIjhVKoAOS2XdlpsBWYFXM/b6do6QxHQs= not found in database
2020-04-21 11:41:01.027 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 11:41:01.037 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:41:01.267 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****z7ag","$type":"Token"},{"TokenType":"code","TokenValue":"****mXZc","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KACV:00000001","TimeStamp":"2020-04-21T09:41:01.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:41:01.270 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIPkYDPY24Ofzx2rMZ6EJ18mCU0SOdOVdEUNa0qvbFz0oGkgv33SPWJrrgAvl57KM2OqWXFbtgpUgbcX9k9IUQ8d3OepyftSL3C7OKqnEoZF5oEH4Ar_Hqp1NNqdTM2zHhxGdmDT4k0nvMLHNcNCk_1Px5JR_GXTAG91UMljImbZsoLTX-hTqd8RSG6dykofd4FNfmrZ64Ol1CZWhIihzuNbV2qOct4-5W5F5kCnNu_kuBYOrVzxwDQ4o1zUqIPqO-zcz5jsl5d79JtvrMddzTh","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 11:41:01.284 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:41:01.306 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:41:02.129 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 11:41:02.136 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 11:41:02.136 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 11:41:02.140 +02:00 [DBG] Start token request.
2020-04-21 11:41:02.142 +02:00 [DBG] Start client validation
2020-04-21 11:41:02.145 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 11:41:02.147 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 11:41:02.151 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 11:41:02.151 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 11:41:02.182 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:02.182 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:02.194 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 11:41:02.195 +02:00 [DBG] Client validation success
2020-04-21 11:41:02.196 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000003","TimeStamp":"2020-04-21T09:41:02.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 11:41:02.229 +02:00 [DBG] Start token request validation
2020-04-21 11:41:02.237 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 11:41:02.264 +02:00 [DBG] jEjK2pTsq5EIjhVKoAOS2XdlpsBWYFXM/b6do6QxHQs= found in database: true
2020-04-21 11:41:02.374 +02:00 [DBG] removing jEjK2pTsq5EIjhVKoAOS2XdlpsBWYFXM/b6do6QxHQs= persisted grant from database
2020-04-21 11:41:02.430 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 11:41:02.435 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"wbKfETkiXMBQhURwMNUvog9KfmZ8H4UlYISEbqzmXZc","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"wbKfETkiXMBQhURwMNUvog9KfmZ8H4UlYISEbqzmXZc","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 11:41:02.481 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:02.481 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:02.484 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:02.489 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:41:02.504 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 11:41:02.504 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 11:41:02.514 +02:00 [DBG] Creating refresh token
2020-04-21 11:41:02.515 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 11:41:02.536 +02:00 [DBG] 6YzwrsYx/b/3i4PWsyU7Z3gmKB6Hy28uve9K2ANsSbc= not found in database
2020-04-21 11:41:02.560 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:02.560 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:02.563 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:02.569 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:41:02.570 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:41:02.578 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****8Obg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****ocfU","$type":"Token"},{"TokenType":"access_token","TokenValue":"****fjqw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000003","TimeStamp":"2020-04-21T09:41:02.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:41:02.579 +02:00 [DBG] Token request success.
2020-04-21 11:41:02.781 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 11:41:02.785 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 11:41:02.785 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 11:41:02.791 +02:00 [DBG] Start userinfo request
2020-04-21 11:41:02.793 +02:00 [DBG] Bearer token found in header
2020-04-21 11:41:02.882 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:02.883 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:02.909 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:02.909 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:02.914 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:41:02.915 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462062,"exp":1587548462,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587461382,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:41:02.923 +02:00 [DBG] Creating userinfo response
2020-04-21 11:41:02.929 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:41:02.931 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:41:02.935 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:02.956 +02:00 [DBG] Requested claim types: 
2020-04-21 11:41:02.957 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:41:02.959 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:41:02.964 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 11:41:02.964 +02:00 [DBG] End userinfo request
2020-04-21 11:41:38.804 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 11:41:38.810 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 11:41:38.811 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 11:41:38.814 +02:00 [DBG] Processing signout request for 1
2020-04-21 11:41:38.818 +02:00 [DBG] Start end session request validation
2020-04-21 11:41:38.821 +02:00 [DBG] Start identity token validation
2020-04-21 11:41:38.854 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:38.854 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:38.856 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 11:41:38.862 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:41:38.862 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462062,"exp":1587548462,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230588592973411.Y2ZkZmFmMzEtODQzMy00N2NjLWE0OTgtOTM1MjhlMWFhNzNlNDdhMjU1ZWItOGRiNi00ZDg1LWExYzMtYjY0N2YwOWVmMDgz","iat":1587462062,"at_hash":"mn3IgpMUKtJHJ_kWu5x2_Q","s_hash":"vCKonNz7l8swTc8FRdl6bQ","sid":"VkLHSHBPLtm8irkfCtRJZg","sub":"1","auth_time":1587461382,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:41:38.865 +02:00 [WRN] Invalid PostLogoutRedirectUri: https://localhost:44348/signout-callback-oidc
2020-04-21 11:41:38.868 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJGvMhO18z0tDZg9-nsyNLg_3lmZHQJqlflBBd17OjKnc4_ahlaFSx0T1pxXZ49cMAvk4oe2o-qpjyHATIJHT8t_TBTvcKCPvkoMyP0aVmOnM1ax4ZgpqA5TJMBkSF31OzDkK_K16a_VKheq4Tt5P_W","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 11:41:38.869 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 11:41:39.128 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 11:41:39.129 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 11:41:39.130 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 11:41:39.132 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5R0B3KACV:00000003","TimeStamp":"2020-04-21T09:41:39.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 11:41:39.568 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 11:41:39.571 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 11:41:39.572 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 11:41:39.578 +02:00 [DBG] Processing signout callback request
2020-04-21 11:41:39.654 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:41:39.654 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:41:39.655 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 11:41:39.655 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 11:41:39.658 +02:00 [INF] Successful signout callback.
2020-04-21 11:41:39.658 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 11:41:39.659 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 11:41:50.884 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 11:41:51.045 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:41:51.045 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 11:41:51.045 +02:00 [DBG] Adding auth_time claim with value: 1587462111
2020-04-21 11:41:51.047 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:41:51.058 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5R0B3KACV:00000007","TimeStamp":"2020-04-21T09:41:51.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 11:42:10.763 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 11:42:10.766 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 11:42:10.766 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 11:42:10.767 +02:00 [DBG] Start authorize request
2020-04-21 11:42:10.768 +02:00 [DBG] User in authorize request: 1
2020-04-21 11:42:10.769 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:42:10.796 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:10.797 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:10.798 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:42:10.798 +02:00 [DBG] No PKCE used.
2020-04-21 11:42:10.801 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:10.806 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:10.809 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:10.815 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:10.816 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:42:10.817 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJz0hGjeiC0_k8Evi6bGqRlTF60aeyMwMa6YzgE7f4n1ZO55Cw12dux85dq6C9km8XReea2HLf3Z5SwtveRvFHD9zqGMmx8Ux6AoFMf3txwX606Hy-5O_xuPHHhegkqL0qKlfuTooWT_dth3jgIKX6-GfQ4DB7wWvkkvjcQUWQytuYLrgNYs3E-STn8F-E9d87pS5FdjdwMzxeO2MJzd2cc_26Ag_qmoaxAbc9_X7fyNtIuTE91D8yDewhMWT5jjoOkyMCpZ69vVYGCbjzZyNXr","UiLocales":null,"Nonce":"637230589306747646.OGUzYzk3YjYtNDJkOC00OTQ3LTlkNmEtMzgwMzEwMmMxMjhkODZlYWMzMzAtZDdmYS00NjYxLThkYWItNjg0NGYyODcxNzI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"_lVM_hr0DxLSyzan0Tx9cg","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230589306747646.OGUzYzk3YjYtNDJkOC00OTQ3LTlkNmEtMzgwMzEwMmMxMjhkODZlYWMzMzAtZDdmYS00NjYxLThkYWItNjg0NGYyODcxNzI2","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJz0hGjeiC0_k8Evi6bGqRlTF60aeyMwMa6YzgE7f4n1ZO55Cw12dux85dq6C9km8XReea2HLf3Z5SwtveRvFHD9zqGMmx8Ux6AoFMf3txwX606Hy-5O_xuPHHhegkqL0qKlfuTooWT_dth3jgIKX6-GfQ4DB7wWvkkvjcQUWQytuYLrgNYs3E-STn8F-E9d87pS5FdjdwMzxeO2MJzd2cc_26Ag_qmoaxAbc9_X7fyNtIuTE91D8yDewhMWT5jjoOkyMCpZ69vVYGCbjzZyNXr","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:42:10.820 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 11:42:10.821 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 11:42:10.823 +02:00 [DBG] r1yaTXiTOYXeRIuy0uj9dzzSqeCu/zHri0qwXMjnbhs= not found in database
2020-04-21 11:42:10.827 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 11:42:10.827 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:42:10.834 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****amSw","$type":"Token"},{"TokenType":"code","TokenValue":"****KfqI","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KACV:0000000A","TimeStamp":"2020-04-21T09:42:10.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:42:10.834 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJz0hGjeiC0_k8Evi6bGqRlTF60aeyMwMa6YzgE7f4n1ZO55Cw12dux85dq6C9km8XReea2HLf3Z5SwtveRvFHD9zqGMmx8Ux6AoFMf3txwX606Hy-5O_xuPHHhegkqL0qKlfuTooWT_dth3jgIKX6-GfQ4DB7wWvkkvjcQUWQytuYLrgNYs3E-STn8F-E9d87pS5FdjdwMzxeO2MJzd2cc_26Ag_qmoaxAbc9_X7fyNtIuTE91D8yDewhMWT5jjoOkyMCpZ69vVYGCbjzZyNXr","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 11:42:10.834 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:42:10.835 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:42:10.992 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 11:42:10.995 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 11:42:10.995 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 11:42:10.996 +02:00 [DBG] Start token request.
2020-04-21 11:42:10.996 +02:00 [DBG] Start client validation
2020-04-21 11:42:10.999 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 11:42:10.999 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 11:42:11.000 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 11:42:11.000 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 11:42:11.040 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:11.040 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:11.041 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 11:42:11.041 +02:00 [DBG] Client validation success
2020-04-21 11:42:11.042 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000005","TimeStamp":"2020-04-21T09:42:11.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 11:42:11.042 +02:00 [DBG] Start token request validation
2020-04-21 11:42:11.042 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 11:42:11.047 +02:00 [DBG] r1yaTXiTOYXeRIuy0uj9dzzSqeCu/zHri0qwXMjnbhs= found in database: true
2020-04-21 11:42:11.050 +02:00 [DBG] removing r1yaTXiTOYXeRIuy0uj9dzzSqeCu/zHri0qwXMjnbhs= persisted grant from database
2020-04-21 11:42:11.055 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 11:42:11.056 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"YmcCk5IGecuG_vxRdJbN4J5yP6PFJLGloq2BRgVKfqI","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"YmcCk5IGecuG_vxRdJbN4J5yP6PFJLGloq2BRgVKfqI","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 11:42:11.072 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:11.072 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:11.074 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:11.078 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:11.078 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 11:42:11.078 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 11:42:11.083 +02:00 [DBG] Creating refresh token
2020-04-21 11:42:11.083 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 11:42:11.085 +02:00 [DBG] HoOJwUOCxZ6Eo8epmxGZHBDTgWBqP/bzHkRIYgWd1AI= not found in database
2020-04-21 11:42:11.103 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:11.104 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:11.105 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:11.109 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:11.109 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:42:11.114 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****lfnQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****Wrqg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****dXTA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000005","TimeStamp":"2020-04-21T09:42:11.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:42:11.114 +02:00 [DBG] Token request success.
2020-04-21 11:42:11.212 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 11:42:11.214 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 11:42:11.214 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 11:42:11.214 +02:00 [DBG] Start userinfo request
2020-04-21 11:42:11.214 +02:00 [DBG] Bearer token found in header
2020-04-21 11:42:11.234 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:11.234 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:11.252 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:11.252 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:11.254 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:42:11.255 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462131,"exp":1587548531,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587462111,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:42:11.255 +02:00 [DBG] Creating userinfo response
2020-04-21 11:42:11.255 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:11.255 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:11.257 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:11.258 +02:00 [DBG] Requested claim types: 
2020-04-21 11:42:11.258 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:11.260 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:11.264 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 11:42:11.264 +02:00 [DBG] End userinfo request
2020-04-21 11:42:16.938 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 11:42:16.938 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 11:42:16.938 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 11:42:16.939 +02:00 [DBG] Processing signout request for 1
2020-04-21 11:42:16.939 +02:00 [DBG] Start end session request validation
2020-04-21 11:42:16.939 +02:00 [DBG] Start identity token validation
2020-04-21 11:42:16.971 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:16.971 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:16.971 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 11:42:16.975 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:42:16.976 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462131,"exp":1587548531,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230589306747646.OGUzYzk3YjYtNDJkOC00OTQ3LTlkNmEtMzgwMzEwMmMxMjhkODZlYWMzMzAtZDdmYS00NjYxLThkYWItNjg0NGYyODcxNzI2","iat":1587462131,"at_hash":"Wv_P8IrIFwGu9SPz2cQpxA","s_hash":"enyzT_PGfmHTvLs5VSv3jQ","sid":"_lVM_hr0DxLSyzan0Tx9cg","sub":"1","auth_time":1587462111,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:42:16.976 +02:00 [WRN] Invalid PostLogoutRedirectUri: https://localhost:44348/signout-callback-oidc
2020-04-21 11:42:16.976 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":null,"State":null,"Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJGH-H18FdqUk6gAmx5qPNIVBaqo-URACq9zmi6c2Pan7G0xtFLSwXdoCjb1HF9BLYlzvfVhmsNSuOAY4vX3p5u8bC2_InjM6YsS5kUcQqcge93LCWODKnnVzjMAj_EGpu5CjF473W3ozvsKq2LmBul","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 11:42:16.976 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 11:42:17.017 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 11:42:17.017 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 11:42:17.018 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 11:42:17.018 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5R0B3KACV:0000000C","TimeStamp":"2020-04-21T09:42:17.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 11:42:17.399 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 11:42:17.401 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 11:42:17.401 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 11:42:17.401 +02:00 [DBG] Processing signout callback request
2020-04-21 11:42:17.429 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:17.429 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:17.429 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 11:42:17.429 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 11:42:17.429 +02:00 [INF] Successful signout callback.
2020-04-21 11:42:17.429 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 11:42:17.429 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 11:42:28.626 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 11:42:28.634 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 11:42:28.635 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 11:42:28.635 +02:00 [DBG] Start authorize request
2020-04-21 11:42:28.635 +02:00 [DBG] No user present in authorize request
2020-04-21 11:42:28.635 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:42:28.654 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:28.654 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:28.654 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:42:28.654 +02:00 [DBG] No PKCE used.
2020-04-21 11:42:28.657 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:28.662 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:28.665 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:28.670 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:28.671 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:42:28.671 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJBXys0mbskxOnSxSJdKchyN3AQfleQkSHfUr2eGIwe7o95F14I0qz-0_tgpo_wled3phZPuhYF8TwQrk_gPzXTJhBJBF8OO_qzmaBzS5ChRM7oKG7AEtydJYAssy6k-oOQMLZW4rLfQJwje9qp1RwMgJY01yfrOCqFhvLFmN7CwK3SI6IWJIsWEyg-BayJJ4TQZk05mQWOc_xusWDI-kDybhX1lwnR9ya7usicBDhczN6S9lNfX6giQDctuBSD1vReleXCtKM10fNg1xDIh46C","UiLocales":null,"Nonce":"637230589486058091.MzE4ZTM0NzItZTFjNC00MDVlLTlhNTItYjA4NGNhM2ZkYTM0OGExMTgxNGYtOGQ4MS00NTg5LTgxNzMtYzc5NmQwZWFiMmRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230589486058091.MzE4ZTM0NzItZTFjNC00MDVlLTlhNTItYjA4NGNhM2ZkYTM0OGExMTgxNGYtOGQ4MS00NTg5LTgxNzMtYzc5NmQwZWFiMmRk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJBXys0mbskxOnSxSJdKchyN3AQfleQkSHfUr2eGIwe7o95F14I0qz-0_tgpo_wled3phZPuhYF8TwQrk_gPzXTJhBJBF8OO_qzmaBzS5ChRM7oKG7AEtydJYAssy6k-oOQMLZW4rLfQJwje9qp1RwMgJY01yfrOCqFhvLFmN7CwK3SI6IWJIsWEyg-BayJJ4TQZk05mQWOc_xusWDI-kDybhX1lwnR9ya7usicBDhczN6S9lNfX6giQDctuBSD1vReleXCtKM10fNg1xDIh46C","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:42:28.671 +02:00 [INF] Showing login: User is not authenticated
2020-04-21 11:42:28.688 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:42:28.705 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:28.706 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:28.706 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:42:28.706 +02:00 [DBG] No PKCE used.
2020-04-21 11:42:28.708 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:28.714 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:28.716 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:28.722 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:28.722 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:42:28.747 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:28.748 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:32.696 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 11:42:32.700 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:42:32.718 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:32.719 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:32.719 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:42:32.719 +02:00 [DBG] No PKCE used.
2020-04-21 11:42:32.721 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:32.727 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:32.729 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:32.733 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:32.734 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:42:32.752 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:42:32.752 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 11:42:32.752 +02:00 [DBG] Adding auth_time claim with value: 1587462152
2020-04-21 11:42:32.754 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:42:32.756 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5R0B3KAD2:00000001","TimeStamp":"2020-04-21T09:42:32.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 11:42:32.826 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:32.827 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:32.934 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-21 11:42:32.935 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-21 11:42:32.936 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-21 11:42:32.947 +02:00 [DBG] Start authorize callback request
2020-04-21 11:42:32.954 +02:00 [DBG] User in authorize request: 1
2020-04-21 11:42:32.959 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 11:42:32.978 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:32.978 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:32.978 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 11:42:32.978 +02:00 [DBG] No PKCE used.
2020-04-21 11:42:32.980 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:32.986 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:32.988 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:32.995 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:32.995 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 11:42:32.995 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJBXys0mbskxOnSxSJdKchyN3AQfleQkSHfUr2eGIwe7o95F14I0qz-0_tgpo_wled3phZPuhYF8TwQrk_gPzXTJhBJBF8OO_qzmaBzS5ChRM7oKG7AEtydJYAssy6k-oOQMLZW4rLfQJwje9qp1RwMgJY01yfrOCqFhvLFmN7CwK3SI6IWJIsWEyg-BayJJ4TQZk05mQWOc_xusWDI-kDybhX1lwnR9ya7usicBDhczN6S9lNfX6giQDctuBSD1vReleXCtKM10fNg1xDIh46C","UiLocales":null,"Nonce":"637230589486058091.MzE4ZTM0NzItZTFjNC00MDVlLTlhNTItYjA4NGNhM2ZkYTM0OGExMTgxNGYtOGQ4MS00NTg5LTgxNzMtYzc5NmQwZWFiMmRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"sKXCHZitpGG2rB2rIsJz_w","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230589486058091.MzE4ZTM0NzItZTFjNC00MDVlLTlhNTItYjA4NGNhM2ZkYTM0OGExMTgxNGYtOGQ4MS00NTg5LTgxNzMtYzc5NmQwZWFiMmRk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJBXys0mbskxOnSxSJdKchyN3AQfleQkSHfUr2eGIwe7o95F14I0qz-0_tgpo_wled3phZPuhYF8TwQrk_gPzXTJhBJBF8OO_qzmaBzS5ChRM7oKG7AEtydJYAssy6k-oOQMLZW4rLfQJwje9qp1RwMgJY01yfrOCqFhvLFmN7CwK3SI6IWJIsWEyg-BayJJ4TQZk05mQWOc_xusWDI-kDybhX1lwnR9ya7usicBDhczN6S9lNfX6giQDctuBSD1vReleXCtKM10fNg1xDIh46C","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 11:42:32.998 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 11:42:32.998 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 11:42:33.001 +02:00 [DBG] ajP1OQK6JV+jSWRkPdW1olUnpEHIrJK16O6Jz44Nfj0= not found in database
2020-04-21 11:42:33.051 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 11:42:33.051 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:42:33.057 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****i5FQ","$type":"Token"},{"TokenType":"code","TokenValue":"****CvfU","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KAD2:00000002","TimeStamp":"2020-04-21T09:42:33.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:42:33.059 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJBXys0mbskxOnSxSJdKchyN3AQfleQkSHfUr2eGIwe7o95F14I0qz-0_tgpo_wled3phZPuhYF8TwQrk_gPzXTJhBJBF8OO_qzmaBzS5ChRM7oKG7AEtydJYAssy6k-oOQMLZW4rLfQJwje9qp1RwMgJY01yfrOCqFhvLFmN7CwK3SI6IWJIsWEyg-BayJJ4TQZk05mQWOc_xusWDI-kDybhX1lwnR9ya7usicBDhczN6S9lNfX6giQDctuBSD1vReleXCtKM10fNg1xDIh46C","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 11:42:33.062 +02:00 [DBG] Augmenting SignInContext
2020-04-21 11:42:33.063 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 11:42:33.301 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 11:42:33.318 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 11:42:33.318 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 11:42:33.318 +02:00 [DBG] Start token request.
2020-04-21 11:42:33.318 +02:00 [DBG] Start client validation
2020-04-21 11:42:33.319 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 11:42:33.319 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 11:42:33.319 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 11:42:33.319 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 11:42:33.344 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:33.345 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:33.345 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 11:42:33.345 +02:00 [DBG] Client validation success
2020-04-21 11:42:33.345 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000007","TimeStamp":"2020-04-21T09:42:33.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 11:42:33.346 +02:00 [DBG] Start token request validation
2020-04-21 11:42:33.346 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 11:42:33.348 +02:00 [DBG] ajP1OQK6JV+jSWRkPdW1olUnpEHIrJK16O6Jz44Nfj0= found in database: true
2020-04-21 11:42:33.350 +02:00 [DBG] removing ajP1OQK6JV+jSWRkPdW1olUnpEHIrJK16O6Jz44Nfj0= persisted grant from database
2020-04-21 11:42:33.356 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 11:42:33.357 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"tna61sXVyVOgjwltdxvIbSjZGS2ONl0KErCSH69CvfU","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"tna61sXVyVOgjwltdxvIbSjZGS2ONl0KErCSH69CvfU","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 11:42:33.374 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:33.375 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:33.377 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:33.382 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:33.382 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 11:42:33.382 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 11:42:33.389 +02:00 [DBG] Creating refresh token
2020-04-21 11:42:33.389 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 11:42:33.391 +02:00 [DBG] EC9rMd61rl43yV07z59kDWNSf0ScORt+QE6FKoU1WXM= not found in database
2020-04-21 11:42:33.408 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:33.408 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:33.410 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:33.414 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 11:42:33.414 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 11:42:33.420 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****SuNg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****DtA8","$type":"Token"},{"TokenType":"access_token","TokenValue":"****9wbA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5R0B3KACU:00000007","TimeStamp":"2020-04-21T09:42:33.0000000Z","ProcessId":22708,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 11:42:33.420 +02:00 [DBG] Token request success.
2020-04-21 11:42:33.546 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 11:42:33.550 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 11:42:33.551 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 11:42:33.551 +02:00 [DBG] Start userinfo request
2020-04-21 11:42:33.551 +02:00 [DBG] Bearer token found in header
2020-04-21 11:42:33.570 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:33.570 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:33.586 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 11:42:33.586 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 11:42:33.589 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 11:42:33.589 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462153,"exp":1587548553,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587462152,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 11:42:33.589 +02:00 [DBG] Creating userinfo response
2020-04-21 11:42:33.590 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:33.590 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:33.591 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:33.592 +02:00 [DBG] Requested claim types: 
2020-04-21 11:42:33.592 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 11:42:33.593 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 11:42:33.596 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 11:42:33.597 +02:00 [DBG] End userinfo request
2020-04-21 12:40:19.201 +02:00 [INF] Removing 0 grants
2020-04-21 12:40:19.217 +02:00 [INF] Removing 0 device flow codes
2020-04-21 12:43:15.941 +02:00 [INF] Starting host...
2020-04-21 12:43:17.851 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 12:43:18.085 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 12:43:18.086 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 12:43:18.086 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 12:43:18.086 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 12:43:18.086 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 12:43:18.086 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 12:44:15.135 +02:00 [DBG] Login Url: /Account/Login
2020-04-21 12:44:15.139 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-21 12:44:15.139 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-21 12:44:15.139 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-21 12:44:15.139 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-21 12:44:15.139 +02:00 [DBG] Error Url: /home/error
2020-04-21 12:44:15.139 +02:00 [DBG] Error Id Parameter: errorId
2020-04-21 12:44:18.818 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 12:44:18.826 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 12:44:18.827 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 12:44:18.873 +02:00 [DBG] Processing signout request for 1
2020-04-21 12:44:18.878 +02:00 [DBG] Start end session request validation
2020-04-21 12:44:18.892 +02:00 [DBG] Start identity token validation
2020-04-21 12:44:20.404 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:44:20.424 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:44:20.427 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 12:44:20.545 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:44:20.555 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587462153,"exp":1587548553,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230589486058091.MzE4ZTM0NzItZTFjNC00MDVlLTlhNTItYjA4NGNhM2ZkYTM0OGExMTgxNGYtOGQ4MS00NTg5LTgxNzMtYzc5NmQwZWFiMmRk","iat":1587462153,"at_hash":"TNfpUUES_qvsktuHMrC-CQ","s_hash":"xIOaRB98V-nDWFBUKACI3Q","sid":"sKXCHZitpGG2rB2rIsJz_w","sub":"1","auth_time":1587462152,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:44:20.586 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLIZFNk_zXBP-noOCBiIDaNCGs1hd0WD7Id4_lWw0g12VduXEbI736KiHRS1IMxPQIx77xdNigr1Tj4Oz_QE7NM38rxRtw1aROBLR17FfrnpaQnwpZgTjJm1SO-PDuVOqNo19Iz824Rp61_8M60SY5b","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLIZFNk_zXBP-noOCBiIDaNCGs1hd0WD7Id4_lWw0g12VduXEbI736KiHRS1IMxPQIx77xdNigr1Tj4Oz_QE7NM38rxRtw1aROBLR17FfrnpaQnwpZgTjJm1SO-PDuVOqNo19Iz824Rp61_8M60SY5b","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 12:44:20.587 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 12:44:21.057 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 12:44:21.060 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 12:44:21.064 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 12:44:21.075 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5S3NNDKJ6:00000002","TimeStamp":"2020-04-21T10:44:21.0000000Z","ProcessId":11528,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 12:44:21.541 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 12:44:21.547 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 12:44:21.547 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 12:44:21.553 +02:00 [DBG] Processing signout callback request
2020-04-21 12:44:21.663 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:44:21.663 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:44:21.664 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 12:44:21.664 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 12:44:21.667 +02:00 [INF] Successful signout callback.
2020-04-21 12:44:21.668 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 12:44:21.668 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 12:44:24.089 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 12:44:24.098 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 12:44:24.098 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 12:44:24.102 +02:00 [DBG] Start authorize request
2020-04-21 12:44:24.106 +02:00 [DBG] No user present in authorize request
2020-04-21 12:44:24.112 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:44:24.148 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:44:24.148 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:44:24.164 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:44:24.166 +02:00 [DBG] No PKCE used.
2020-04-21 12:44:24.359 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:44:24.800 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:44:24.840 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:44:24.847 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:44:24.856 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:44:24.864 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLCXkCWLonOujU62RFRizSj2-DISvfZb0Nx_GB-vmuPhVvhcn9b7F6Trab8uvJwO1shMeuRJjW7WO5MFrOi3CN1An41G3h5bSBYE9gbL0ykw7BMyxQPJkTnwbK-SHlWKrP8zrL6s3trJUWGeM2-sEdyQJm8Lo0XzyJC2fsnfyf7-VoW8IXlJTd4s-TQEcHPAzkHunieCPbjKlySu7enAsHXRZOsEm9i0Fz8bx-NvpY3Bufu7BNxtiCZQsQE9HGy6jDXqvyWuHsFkfx2_1275NAi","UiLocales":null,"Nonce":"637230626639595674.ZTdmMjAxMmEtYjhhZC00MDQyLTkyNTEtOTZkOTY5MjIxM2ZjMDUwNTJlMzItNjc2Mi00MjI4LTlmNjMtZWIyN2Q0MDA5ZDdl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230626639595674.ZTdmMjAxMmEtYjhhZC00MDQyLTkyNTEtOTZkOTY5MjIxM2ZjMDUwNTJlMzItNjc2Mi00MjI4LTlmNjMtZWIyN2Q0MDA5ZDdl","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLCXkCWLonOujU62RFRizSj2-DISvfZb0Nx_GB-vmuPhVvhcn9b7F6Trab8uvJwO1shMeuRJjW7WO5MFrOi3CN1An41G3h5bSBYE9gbL0ykw7BMyxQPJkTnwbK-SHlWKrP8zrL6s3trJUWGeM2-sEdyQJm8Lo0XzyJC2fsnfyf7-VoW8IXlJTd4s-TQEcHPAzkHunieCPbjKlySu7enAsHXRZOsEm9i0Fz8bx-NvpY3Bufu7BNxtiCZQsQE9HGy6jDXqvyWuHsFkfx2_1275NAi","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:44:24.868 +02:00 [INF] Showing login: User is not authenticated
2020-04-21 12:44:25.235 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:44:25.276 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:44:25.277 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:44:25.278 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:44:25.278 +02:00 [DBG] No PKCE used.
2020-04-21 12:44:25.281 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:44:25.287 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:44:25.291 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:44:25.297 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:44:25.298 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:44:25.328 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:44:25.328 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:17.711 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 12:46:17.788 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:46:17.814 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:17.815 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:17.815 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:46:17.815 +02:00 [DBG] No PKCE used.
2020-04-21 12:46:17.818 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:17.825 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:17.828 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:17.834 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:17.835 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:46:17.895 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:46:17.896 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 12:46:17.896 +02:00 [DBG] Adding auth_time claim with value: 1587465977
2020-04-21 12:46:17.902 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:46:17.908 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5S3NNDKJB:00000001","TimeStamp":"2020-04-21T10:46:17.0000000Z","ProcessId":11528,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 12:46:18.181 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-21 12:46:18.182 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-21 12:46:18.182 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-21 12:46:18.196 +02:00 [DBG] Start authorize callback request
2020-04-21 12:46:18.265 +02:00 [DBG] User in authorize request: 1
2020-04-21 12:46:18.265 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:46:18.296 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:18.296 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:18.297 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:46:18.297 +02:00 [DBG] No PKCE used.
2020-04-21 12:46:18.299 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:18.306 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:18.309 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:18.316 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:18.316 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:46:18.317 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLCXkCWLonOujU62RFRizSj2-DISvfZb0Nx_GB-vmuPhVvhcn9b7F6Trab8uvJwO1shMeuRJjW7WO5MFrOi3CN1An41G3h5bSBYE9gbL0ykw7BMyxQPJkTnwbK-SHlWKrP8zrL6s3trJUWGeM2-sEdyQJm8Lo0XzyJC2fsnfyf7-VoW8IXlJTd4s-TQEcHPAzkHunieCPbjKlySu7enAsHXRZOsEm9i0Fz8bx-NvpY3Bufu7BNxtiCZQsQE9HGy6jDXqvyWuHsFkfx2_1275NAi","UiLocales":null,"Nonce":"637230626639595674.ZTdmMjAxMmEtYjhhZC00MDQyLTkyNTEtOTZkOTY5MjIxM2ZjMDUwNTJlMzItNjc2Mi00MjI4LTlmNjMtZWIyN2Q0MDA5ZDdl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"vl5AHcc9z0jhUr1IqmSpyg","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230626639595674.ZTdmMjAxMmEtYjhhZC00MDQyLTkyNTEtOTZkOTY5MjIxM2ZjMDUwNTJlMzItNjc2Mi00MjI4LTlmNjMtZWIyN2Q0MDA5ZDdl","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLCXkCWLonOujU62RFRizSj2-DISvfZb0Nx_GB-vmuPhVvhcn9b7F6Trab8uvJwO1shMeuRJjW7WO5MFrOi3CN1An41G3h5bSBYE9gbL0ykw7BMyxQPJkTnwbK-SHlWKrP8zrL6s3trJUWGeM2-sEdyQJm8Lo0XzyJC2fsnfyf7-VoW8IXlJTd4s-TQEcHPAzkHunieCPbjKlySu7enAsHXRZOsEm9i0Fz8bx-NvpY3Bufu7BNxtiCZQsQE9HGy6jDXqvyWuHsFkfx2_1275NAi","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:46:18.354 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 12:46:18.368 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 12:46:18.517 +02:00 [DBG] 7k5MFMeODBsfB82yiqzc4mSSAbexllApvpys7ffeSU0= not found in database
2020-04-21 12:46:19.082 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 12:46:19.099 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:46:19.176 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****6lsA","$type":"Token"},{"TokenType":"code","TokenValue":"****fj3U","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S3NNDKJB:00000002","TimeStamp":"2020-04-21T10:46:19.0000000Z","ProcessId":11528,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:46:19.179 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLCXkCWLonOujU62RFRizSj2-DISvfZb0Nx_GB-vmuPhVvhcn9b7F6Trab8uvJwO1shMeuRJjW7WO5MFrOi3CN1An41G3h5bSBYE9gbL0ykw7BMyxQPJkTnwbK-SHlWKrP8zrL6s3trJUWGeM2-sEdyQJm8Lo0XzyJC2fsnfyf7-VoW8IXlJTd4s-TQEcHPAzkHunieCPbjKlySu7enAsHXRZOsEm9i0Fz8bx-NvpY3Bufu7BNxtiCZQsQE9HGy6jDXqvyWuHsFkfx2_1275NAi","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 12:46:19.198 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:46:19.199 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:46:19.960 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 12:46:19.968 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 12:46:19.968 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 12:46:19.974 +02:00 [DBG] Start token request.
2020-04-21 12:46:19.991 +02:00 [DBG] Start client validation
2020-04-21 12:46:19.999 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 12:46:20.001 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 12:46:20.002 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 12:46:20.002 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 12:46:20.031 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:20.031 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:20.045 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 12:46:20.045 +02:00 [DBG] Client validation success
2020-04-21 12:46:20.047 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5S3NNDKJC:00000001","TimeStamp":"2020-04-21T10:46:20.0000000Z","ProcessId":11528,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 12:46:20.052 +02:00 [DBG] Start token request validation
2020-04-21 12:46:20.061 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 12:46:20.109 +02:00 [DBG] 7k5MFMeODBsfB82yiqzc4mSSAbexllApvpys7ffeSU0= found in database: true
2020-04-21 12:46:20.179 +02:00 [DBG] removing 7k5MFMeODBsfB82yiqzc4mSSAbexllApvpys7ffeSU0= persisted grant from database
2020-04-21 12:46:20.246 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 12:46:20.251 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"cRmFfyheA3FAYxXh0s6OfL7cDBj3IkKVbAnzsW4fj3U","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"cRmFfyheA3FAYxXh0s6OfL7cDBj3IkKVbAnzsW4fj3U","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 12:46:20.281 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:20.282 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:20.285 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:20.302 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:20.326 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 12:46:20.327 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 12:46:20.339 +02:00 [DBG] Creating refresh token
2020-04-21 12:46:20.340 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 12:46:20.413 +02:00 [DBG] j+abX3FfE4VZy2uStA1X6bO9cmm1sO35QFYu7JcrgMY= not found in database
2020-04-21 12:46:20.443 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:20.443 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:20.446 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:20.452 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:46:20.453 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:46:20.464 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****eXFg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****-MEw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****wttA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S3NNDKJC:00000001","TimeStamp":"2020-04-21T10:46:20.0000000Z","ProcessId":11528,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:46:20.465 +02:00 [DBG] Token request success.
2020-04-21 12:46:20.769 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 12:46:20.775 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 12:46:20.775 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 12:46:20.781 +02:00 [DBG] Start userinfo request
2020-04-21 12:46:20.784 +02:00 [DBG] Bearer token found in header
2020-04-21 12:46:20.833 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:20.833 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:20.856 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:46:20.857 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:46:20.861 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:46:20.861 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587465980,"exp":1587552380,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587465977,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:46:20.869 +02:00 [DBG] Creating userinfo response
2020-04-21 12:46:20.875 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:46:20.876 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:46:20.880 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:20.885 +02:00 [DBG] Requested claim types: 
2020-04-21 12:46:20.886 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:46:20.888 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:46:20.893 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 12:46:20.893 +02:00 [DBG] End userinfo request
2020-04-21 12:46:41.012 +02:00 [INF] Starting host...
2020-04-21 12:46:42.168 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 12:46:42.383 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 12:46:42.383 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 12:46:42.383 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 12:46:42.383 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 12:46:42.383 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 12:46:42.383 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 12:47:11.187 +02:00 [DBG] Login Url: /Account/Login
2020-04-21 12:47:11.190 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-21 12:47:11.190 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-21 12:47:11.190 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-21 12:47:11.190 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-21 12:47:11.190 +02:00 [DBG] Error Url: /home/error
2020-04-21 12:47:11.190 +02:00 [DBG] Error Id Parameter: errorId
2020-04-21 12:47:11.271 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 12:47:11.279 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 12:47:11.279 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 12:47:11.299 +02:00 [DBG] Processing signout request for 1
2020-04-21 12:47:11.304 +02:00 [DBG] Start end session request validation
2020-04-21 12:47:11.314 +02:00 [DBG] Start identity token validation
2020-04-21 12:47:16.664 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:16.691 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:16.694 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 12:47:17.318 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:47:17.360 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587465980,"exp":1587552380,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230626639595674.ZTdmMjAxMmEtYjhhZC00MDQyLTkyNTEtOTZkOTY5MjIxM2ZjMDUwNTJlMzItNjc2Mi00MjI4LTlmNjMtZWIyN2Q0MDA5ZDdl","iat":1587465980,"at_hash":"caYtSGt--L1UIkplrrhOGA","s_hash":"in0S0YIE91FcqWNyCxdwaA","sid":"vl5AHcc9z0jhUr1IqmSpyg","sub":"1","auth_time":1587465977,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:47:17.427 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtINE9_ddIoTjKSaZjRRkDEZUqhNPbWBImvnI9ezy9yEt9NAjSzwfq0CtubMxu0cq1zG6GufF89WhuECMyPTqxNW3tsxp-KgUM5CngsxesEVqbOKsGOz6gUZYGG2inkU6wypaEwOaw_Rn3MMcnrbuWOF","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtINE9_ddIoTjKSaZjRRkDEZUqhNPbWBImvnI9ezy9yEt9NAjSzwfq0CtubMxu0cq1zG6GufF89WhuECMyPTqxNW3tsxp-KgUM5CngsxesEVqbOKsGOz6gUZYGG2inkU6wypaEwOaw_Rn3MMcnrbuWOF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 12:47:17.432 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 12:47:18.058 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 12:47:18.063 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 12:47:18.064 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 12:47:18.084 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5S5C7G46R:00000002","TimeStamp":"2020-04-21T10:47:18.0000000Z","ProcessId":16068,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 12:47:19.023 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 12:47:19.030 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 12:47:19.030 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 12:47:19.032 +02:00 [DBG] Processing signout callback request
2020-04-21 12:47:19.122 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:19.123 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:19.124 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 12:47:19.124 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 12:47:19.127 +02:00 [INF] Successful signout callback.
2020-04-21 12:47:19.127 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 12:47:19.128 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 12:47:19.541 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 12:47:19.555 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 12:47:19.556 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 12:47:19.559 +02:00 [DBG] Start authorize request
2020-04-21 12:47:19.562 +02:00 [DBG] No user present in authorize request
2020-04-21 12:47:19.565 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:47:19.602 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:19.602 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:19.620 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:47:19.621 +02:00 [DBG] No PKCE used.
2020-04-21 12:47:19.756 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:20.059 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:20.085 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:20.092 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:20.100 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:47:20.108 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJQbuLQ-bTUHBdcGAGicHXJA1aksYfo9QH97uCGaPtTiBwC7gWF9joSvKXb4rZG7y9WrDl-VHtwxFq3w9DJ2s6vOsniITfGuCO3oaux3gTIGQ5jUOnebUB20CVlzAMRIi8GX9wFgqak9V3wn3muQryQJjyZVaW1bjlnsaPxokkILSAADlIipArzNqdftyxK7Zrk1x-IR62-nyttjgr8pnP2N6XJNpbNx7uoO1BMUV3BVv01pvVPA7om-mBfgSX9IgWzGM-U9nK0BdlMB8FbCFrW","UiLocales":null,"Nonce":"637230628394807140.OGZhZjg3Y2ItMDgzZC00NjYyLTlhYjAtZGQ2YzY1ZmI0NDVmM2QzYmM0ZmQtZGU4NS00ZTNkLTg5ZTItOGE5YjRhYTA2OTJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230628394807140.OGZhZjg3Y2ItMDgzZC00NjYyLTlhYjAtZGQ2YzY1ZmI0NDVmM2QzYmM0ZmQtZGU4NS00ZTNkLTg5ZTItOGE5YjRhYTA2OTJm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJQbuLQ-bTUHBdcGAGicHXJA1aksYfo9QH97uCGaPtTiBwC7gWF9joSvKXb4rZG7y9WrDl-VHtwxFq3w9DJ2s6vOsniITfGuCO3oaux3gTIGQ5jUOnebUB20CVlzAMRIi8GX9wFgqak9V3wn3muQryQJjyZVaW1bjlnsaPxokkILSAADlIipArzNqdftyxK7Zrk1x-IR62-nyttjgr8pnP2N6XJNpbNx7uoO1BMUV3BVv01pvVPA7om-mBfgSX9IgWzGM-U9nK0BdlMB8FbCFrW","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:47:20.112 +02:00 [INF] Showing login: User is not authenticated
2020-04-21 12:47:20.172 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:47:20.197 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:20.197 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:20.197 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:47:20.197 +02:00 [DBG] No PKCE used.
2020-04-21 12:47:20.200 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:20.208 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:20.210 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:20.219 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:20.220 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:47:20.250 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:20.250 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:27.071 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 12:47:27.219 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:47:27.247 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:27.247 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:27.248 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:47:27.248 +02:00 [DBG] No PKCE used.
2020-04-21 12:47:27.252 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:27.259 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:27.262 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:27.269 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:27.270 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:47:27.545 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:47:27.546 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 12:47:27.546 +02:00 [DBG] Adding auth_time claim with value: 1587466047
2020-04-21 12:47:27.551 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:47:27.556 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5S5C7G46R:00000006","TimeStamp":"2020-04-21T10:47:27.0000000Z","ProcessId":16068,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 12:47:27.609 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-21 12:47:27.610 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-21 12:47:27.610 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-21 12:47:27.614 +02:00 [DBG] Start authorize callback request
2020-04-21 12:47:27.619 +02:00 [DBG] User in authorize request: 1
2020-04-21 12:47:27.619 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:47:27.643 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:27.643 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:27.643 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:47:27.643 +02:00 [DBG] No PKCE used.
2020-04-21 12:47:27.645 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:27.652 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:27.655 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:27.662 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:27.663 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:47:27.663 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJQbuLQ-bTUHBdcGAGicHXJA1aksYfo9QH97uCGaPtTiBwC7gWF9joSvKXb4rZG7y9WrDl-VHtwxFq3w9DJ2s6vOsniITfGuCO3oaux3gTIGQ5jUOnebUB20CVlzAMRIi8GX9wFgqak9V3wn3muQryQJjyZVaW1bjlnsaPxokkILSAADlIipArzNqdftyxK7Zrk1x-IR62-nyttjgr8pnP2N6XJNpbNx7uoO1BMUV3BVv01pvVPA7om-mBfgSX9IgWzGM-U9nK0BdlMB8FbCFrW","UiLocales":null,"Nonce":"637230628394807140.OGZhZjg3Y2ItMDgzZC00NjYyLTlhYjAtZGQ2YzY1ZmI0NDVmM2QzYmM0ZmQtZGU4NS00ZTNkLTg5ZTItOGE5YjRhYTA2OTJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"c5-8uqO-v4Vsvda24rr7mQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230628394807140.OGZhZjg3Y2ItMDgzZC00NjYyLTlhYjAtZGQ2YzY1ZmI0NDVmM2QzYmM0ZmQtZGU4NS00ZTNkLTg5ZTItOGE5YjRhYTA2OTJm","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJQbuLQ-bTUHBdcGAGicHXJA1aksYfo9QH97uCGaPtTiBwC7gWF9joSvKXb4rZG7y9WrDl-VHtwxFq3w9DJ2s6vOsniITfGuCO3oaux3gTIGQ5jUOnebUB20CVlzAMRIi8GX9wFgqak9V3wn3muQryQJjyZVaW1bjlnsaPxokkILSAADlIipArzNqdftyxK7Zrk1x-IR62-nyttjgr8pnP2N6XJNpbNx7uoO1BMUV3BVv01pvVPA7om-mBfgSX9IgWzGM-U9nK0BdlMB8FbCFrW","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:47:27.677 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 12:47:27.682 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 12:47:27.808 +02:00 [DBG] L3T04owrlf79t7TJzjPA+ksxP2uJ48S2tZvIuIH8oBY= not found in database
2020-04-21 12:47:28.107 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 12:47:28.117 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:47:28.174 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****cnUw","$type":"Token"},{"TokenType":"code","TokenValue":"****bk40","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S5C7G46S:00000001","TimeStamp":"2020-04-21T10:47:28.0000000Z","ProcessId":16068,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:47:28.176 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJQbuLQ-bTUHBdcGAGicHXJA1aksYfo9QH97uCGaPtTiBwC7gWF9joSvKXb4rZG7y9WrDl-VHtwxFq3w9DJ2s6vOsniITfGuCO3oaux3gTIGQ5jUOnebUB20CVlzAMRIi8GX9wFgqak9V3wn3muQryQJjyZVaW1bjlnsaPxokkILSAADlIipArzNqdftyxK7Zrk1x-IR62-nyttjgr8pnP2N6XJNpbNx7uoO1BMUV3BVv01pvVPA7om-mBfgSX9IgWzGM-U9nK0BdlMB8FbCFrW","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 12:47:28.186 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:47:28.186 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:47:28.528 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 12:47:28.537 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 12:47:28.537 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 12:47:28.544 +02:00 [DBG] Start token request.
2020-04-21 12:47:28.550 +02:00 [DBG] Start client validation
2020-04-21 12:47:28.556 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 12:47:28.559 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 12:47:28.560 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 12:47:28.560 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 12:47:28.586 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:28.586 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:28.601 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 12:47:28.601 +02:00 [DBG] Client validation success
2020-04-21 12:47:28.603 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5S5C7G46T:00000001","TimeStamp":"2020-04-21T10:47:28.0000000Z","ProcessId":16068,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 12:47:28.607 +02:00 [DBG] Start token request validation
2020-04-21 12:47:28.613 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 12:47:28.645 +02:00 [DBG] L3T04owrlf79t7TJzjPA+ksxP2uJ48S2tZvIuIH8oBY= found in database: true
2020-04-21 12:47:28.713 +02:00 [DBG] removing L3T04owrlf79t7TJzjPA+ksxP2uJ48S2tZvIuIH8oBY= persisted grant from database
2020-04-21 12:47:28.755 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 12:47:28.760 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"UWh7LapvrJh5Dy0JknSzz2gBFa4q2y2qNcm4ff6bk40","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"UWh7LapvrJh5Dy0JknSzz2gBFa4q2y2qNcm4ff6bk40","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 12:47:28.790 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:28.790 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:28.794 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:28.801 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:28.818 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 12:47:28.819 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 12:47:28.830 +02:00 [DBG] Creating refresh token
2020-04-21 12:47:28.830 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 12:47:28.863 +02:00 [DBG] NX5xP7nTAwtaZ6QAW0hU+VjddA5j6QDz2OlhwS+xvDI= not found in database
2020-04-21 12:47:28.891 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:28.891 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:28.893 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:28.899 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:47:28.900 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:47:28.907 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****jodw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****YlGs","$type":"Token"},{"TokenType":"access_token","TokenValue":"****84gw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S5C7G46T:00000001","TimeStamp":"2020-04-21T10:47:28.0000000Z","ProcessId":16068,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:47:28.908 +02:00 [DBG] Token request success.
2020-04-21 12:47:29.105 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 12:47:29.107 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 12:47:29.107 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 12:47:29.111 +02:00 [DBG] Start userinfo request
2020-04-21 12:47:29.117 +02:00 [DBG] Bearer token found in header
2020-04-21 12:47:29.152 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:29.152 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:29.176 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:47:29.176 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:47:29.180 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:47:29.180 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587466048,"exp":1587552448,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587466047,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:47:29.187 +02:00 [DBG] Creating userinfo response
2020-04-21 12:47:29.192 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:47:29.194 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:47:29.198 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:29.203 +02:00 [DBG] Requested claim types: 
2020-04-21 12:47:29.204 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:47:29.206 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:47:29.210 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 12:47:29.210 +02:00 [DBG] End userinfo request
2020-04-21 12:49:35.503 +02:00 [INF] Starting host...
2020-04-21 12:49:46.810 +02:00 [FTL] Application startup exception
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
2020-04-21 12:49:48.573 +02:00 [FTL] Host terminated unexpectedly.
System.InvalidOperationException: Application is running inside IIS process but is not configured to use IIS server.
   at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-21 12:50:23.129 +02:00 [INF] Starting host...
2020-04-21 12:50:28.924 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 12:50:30.478 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 12:50:30.844 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 12:50:31.064 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 12:50:31.392 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 12:50:31.662 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 12:50:31.731 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 12:50:34.591 +02:00 [FTL] Unable to start Kestrel.
System.IO.IOException: Failed to bind to address http://[::]:5004: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
2020-04-21 12:50:34.913 +02:00 [FTL] Host terminated unexpectedly.
System.IO.IOException: Failed to bind to address http://[::]:5004: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass21_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-21 12:50:50.836 +02:00 [INF] Starting host...
2020-04-21 12:50:56.473 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-21 12:50:57.016 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-21 12:50:57.068 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-21 12:50:57.069 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-21 12:50:57.069 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-21 12:50:57.070 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-21 12:50:57.071 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-21 12:51:01.804 +02:00 [DBG] Login Url: /Account/Login
2020-04-21 12:51:01.839 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-21 12:51:01.875 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-21 12:51:01.919 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-21 12:51:01.925 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-21 12:51:01.929 +02:00 [DBG] Error Url: /home/error
2020-04-21 12:51:01.932 +02:00 [DBG] Error Id Parameter: errorId
2020-04-21 12:51:16.424 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-21 12:51:16.432 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-21 12:51:16.440 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-21 12:51:16.461 +02:00 [DBG] Processing signout request for 1
2020-04-21 12:51:16.465 +02:00 [DBG] Start end session request validation
2020-04-21 12:51:16.503 +02:00 [DBG] Start identity token validation
2020-04-21 12:51:23.392 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:23.415 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:23.422 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-21 12:51:23.981 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:51:24.010 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587466048,"exp":1587552448,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230628394807140.OGZhZjg3Y2ItMDgzZC00NjYyLTlhYjAtZGQ2YzY1ZmI0NDVmM2QzYmM0ZmQtZGU4NS00ZTNkLTg5ZTItOGE5YjRhYTA2OTJm","iat":1587466048,"at_hash":"EI68llWARK8RAQg4liG_uQ","s_hash":"xA4f6FB7tV6NVzz_Bz0ANQ","sid":"c5-8uqO-v4Vsvda24rr7mQ","sub":"1","auth_time":1587466047,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:51:24.127 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLU7Nvjk1FTcSED9fV1C9nhVKQKijCvIioW1kN-MXosZsGUU41wEQRWQ1jpqUJMrhQu79ALJgweImMW-Pv38x3vCqK4If_UX64Tg79xQ_eH1y22xMOSCWwxT0cBXjelWb6JJQx_E6vy2WQlo6byUCPv","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLU7Nvjk1FTcSED9fV1C9nhVKQKijCvIioW1kN-MXosZsGUU41wEQRWQ1jpqUJMrhQu79ALJgweImMW-Pv38x3vCqK4If_UX64Tg79xQ_eH1y22xMOSCWwxT0cBXjelWb6JJQx_E6vy2WQlo6byUCPv","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-21 12:51:24.148 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-21 12:51:24.622 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-21 12:51:24.627 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-21 12:51:24.632 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-21 12:51:24.671 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV5S7FVO1BV:00000002","TimeStamp":"2020-04-21T10:51:24.0000000Z","ProcessId":28052,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-21 12:51:25.141 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-21 12:51:25.177 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-21 12:51:25.181 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-21 12:51:25.189 +02:00 [DBG] Processing signout callback request
2020-04-21 12:51:25.275 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:25.278 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:25.282 +02:00 [DBG] No client front-channel logout URLs
2020-04-21 12:51:25.283 +02:00 [DBG] No client back-channel logout URLs
2020-04-21 12:51:25.291 +02:00 [INF] Successful signout callback.
2020-04-21 12:51:25.292 +02:00 [DBG] No client front-channel iframe urls
2020-04-21 12:51:25.298 +02:00 [DBG] No client back-channel iframe urls
2020-04-21 12:51:25.444 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-21 12:51:25.452 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-21 12:51:25.453 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-21 12:51:25.459 +02:00 [DBG] Start authorize request
2020-04-21 12:51:25.464 +02:00 [DBG] No user present in authorize request
2020-04-21 12:51:25.468 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:51:25.519 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:25.528 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:25.566 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:51:25.578 +02:00 [DBG] No PKCE used.
2020-04-21 12:51:25.822 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:26.081 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:26.121 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:26.130 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:26.150 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:51:26.159 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLZlQ4-E-iTv7wBJ1KEpc7aMO-VxBup8-5YiUSB_8OGoT16raPbvo3kM1Hi6CJNLZxSgk0vObOaUl4zZSPadVTpjQDYHyIjGKDAERGuu6GHcjg-4fG4pEVFFQAinUJfUVYvsvX_mGDr10J5mK3uNamX5xZJbjc04T5OlTDGzyBP8_CxD6QhlqL_htJymM0QBk6snipyyth_VHZIfhxdRD-UV9E6p4AqJc8XjAgSnwf5PTFyH0GB1CaLFjS6FtWYUTgLy2gUH8AWz9q7YB1D-s7M","UiLocales":null,"Nonce":"637230630853946197.OTJhMTEyMzYtOWUxZi00OGJlLWI3YjMtZmVkOTk5YTAwZmNlMmQxYmZjYmMtN2M0NC00MDM5LWEzOTEtOWQ5MGJmYWJiYzRh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230630853946197.OTJhMTEyMzYtOWUxZi00OGJlLWI3YjMtZmVkOTk5YTAwZmNlMmQxYmZjYmMtN2M0NC00MDM5LWEzOTEtOWQ5MGJmYWJiYzRh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLZlQ4-E-iTv7wBJ1KEpc7aMO-VxBup8-5YiUSB_8OGoT16raPbvo3kM1Hi6CJNLZxSgk0vObOaUl4zZSPadVTpjQDYHyIjGKDAERGuu6GHcjg-4fG4pEVFFQAinUJfUVYvsvX_mGDr10J5mK3uNamX5xZJbjc04T5OlTDGzyBP8_CxD6QhlqL_htJymM0QBk6snipyyth_VHZIfhxdRD-UV9E6p4AqJc8XjAgSnwf5PTFyH0GB1CaLFjS6FtWYUTgLy2gUH8AWz9q7YB1D-s7M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:51:26.209 +02:00 [INF] Showing login: User is not authenticated
2020-04-21 12:51:26.353 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:51:26.466 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:26.471 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:26.472 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:51:26.473 +02:00 [DBG] No PKCE used.
2020-04-21 12:51:26.479 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:26.489 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:26.501 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:26.511 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:26.520 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:51:26.558 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:26.560 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:49.367 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-21 12:51:49.538 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:51:49.601 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:51:49.605 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:51:49.609 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:51:49.609 +02:00 [DBG] No PKCE used.
2020-04-21 12:51:49.621 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:49.632 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:49.650 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:51:49.668 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:51:49.684 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:51:50.207 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:51:50.211 +02:00 [DBG] Adding idp claim with value: local
2020-04-21 12:51:50.213 +02:00 [DBG] Adding auth_time claim with value: 1587466310
2020-04-21 12:51:50.238 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:51:57.872 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV5S7FVO1CB:00000001","TimeStamp":"2020-04-21T10:51:57.0000000Z","ProcessId":28052,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-21 12:52:11.676 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-21 12:52:11.680 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-21 12:52:11.683 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-21 12:52:11.695 +02:00 [DBG] Start authorize callback request
2020-04-21 12:52:11.700 +02:00 [DBG] User in authorize request: 1
2020-04-21 12:52:11.701 +02:00 [DBG] Start authorize request protocol validation
2020-04-21 12:52:11.747 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:11.750 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:11.755 +02:00 [DBG] Checking for PKCE parameters
2020-04-21 12:52:11.757 +02:00 [DBG] No PKCE used.
2020-04-21 12:52:11.763 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:11.779 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:52:11.806 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:11.826 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:52:11.875 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-21 12:52:11.908 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLZlQ4-E-iTv7wBJ1KEpc7aMO-VxBup8-5YiUSB_8OGoT16raPbvo3kM1Hi6CJNLZxSgk0vObOaUl4zZSPadVTpjQDYHyIjGKDAERGuu6GHcjg-4fG4pEVFFQAinUJfUVYvsvX_mGDr10J5mK3uNamX5xZJbjc04T5OlTDGzyBP8_CxD6QhlqL_htJymM0QBk6snipyyth_VHZIfhxdRD-UV9E6p4AqJc8XjAgSnwf5PTFyH0GB1CaLFjS6FtWYUTgLy2gUH8AWz9q7YB1D-s7M","UiLocales":null,"Nonce":"637230630853946197.OTJhMTEyMzYtOWUxZi00OGJlLWI3YjMtZmVkOTk5YTAwZmNlMmQxYmZjYmMtN2M0NC00MDM5LWEzOTEtOWQ5MGJmYWJiYzRh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"RrjoZost7qcMu8aAOLYDyA","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637230630853946197.OTJhMTEyMzYtOWUxZi00OGJlLWI3YjMtZmVkOTk5YTAwZmNlMmQxYmZjYmMtN2M0NC00MDM5LWEzOTEtOWQ5MGJmYWJiYzRh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLZlQ4-E-iTv7wBJ1KEpc7aMO-VxBup8-5YiUSB_8OGoT16raPbvo3kM1Hi6CJNLZxSgk0vObOaUl4zZSPadVTpjQDYHyIjGKDAERGuu6GHcjg-4fG4pEVFFQAinUJfUVYvsvX_mGDr10J5mK3uNamX5xZJbjc04T5OlTDGzyBP8_CxD6QhlqL_htJymM0QBk6snipyyth_VHZIfhxdRD-UV9E6p4AqJc8XjAgSnwf5PTFyH0GB1CaLFjS6FtWYUTgLy2gUH8AWz9q7YB1D-s7M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-21 12:52:12.535 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-21 12:52:12.545 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-21 12:52:12.745 +02:00 [DBG] xG6hCINKKuQPkATWM8F7+l5FTXnzGmz1AxeUxYwSMHg= not found in database
2020-04-21 12:52:13.279 +02:00 [DBG] Creating Implicit Flow response.
2020-04-21 12:52:13.361 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:52:13.583 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****IvKA","$type":"Token"},{"TokenType":"code","TokenValue":"****-0bo","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S7FVO1CB:00000002","TimeStamp":"2020-04-21T10:52:13.0000000Z","ProcessId":28052,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:52:13.602 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLZlQ4-E-iTv7wBJ1KEpc7aMO-VxBup8-5YiUSB_8OGoT16raPbvo3kM1Hi6CJNLZxSgk0vObOaUl4zZSPadVTpjQDYHyIjGKDAERGuu6GHcjg-4fG4pEVFFQAinUJfUVYvsvX_mGDr10J5mK3uNamX5xZJbjc04T5OlTDGzyBP8_CxD6QhlqL_htJymM0QBk6snipyyth_VHZIfhxdRD-UV9E6p4AqJc8XjAgSnwf5PTFyH0GB1CaLFjS6FtWYUTgLy2gUH8AWz9q7YB1D-s7M","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-21 12:52:13.627 +02:00 [DBG] Augmenting SignInContext
2020-04-21 12:52:13.628 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-21 12:52:13.816 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-21 12:52:13.863 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-21 12:52:13.883 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-21 12:52:13.897 +02:00 [DBG] Start token request.
2020-04-21 12:52:13.910 +02:00 [DBG] Start client validation
2020-04-21 12:52:13.926 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-21 12:52:13.938 +02:00 [DBG] Start parsing for secret in post body
2020-04-21 12:52:13.950 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-21 12:52:13.976 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-21 12:52:14.107 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:14.138 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:14.239 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-21 12:52:14.258 +02:00 [DBG] Client validation success
2020-04-21 12:52:14.298 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV5S7FVO1CC:00000001","TimeStamp":"2020-04-21T10:52:14.0000000Z","ProcessId":28052,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-21 12:52:14.365 +02:00 [DBG] Start token request validation
2020-04-21 12:52:14.377 +02:00 [DBG] Start validation of authorization code token request
2020-04-21 12:52:14.412 +02:00 [DBG] xG6hCINKKuQPkATWM8F7+l5FTXnzGmz1AxeUxYwSMHg= found in database: true
2020-04-21 12:52:14.531 +02:00 [DBG] removing xG6hCINKKuQPkATWM8F7+l5FTXnzGmz1AxeUxYwSMHg= persisted grant from database
2020-04-21 12:52:14.619 +02:00 [DBG] Validation of authorization code token request success
2020-04-21 12:52:14.631 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"BfgaV5w0MuLfrCOueyVdL0NkPPtepksOu5MNoFt-0bo","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"BfgaV5w0MuLfrCOueyVdL0NkPPtepksOu5MNoFt-0bo","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-21 12:52:15.088 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:15.096 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:15.112 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:15.121 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:52:15.163 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-21 12:52:15.164 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-21 12:52:15.198 +02:00 [DBG] Creating refresh token
2020-04-21 12:52:15.199 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-21 12:52:15.241 +02:00 [DBG] /S6rS5msg827J5seykXc+y1FuqEYsGr8V7uFhO0V6pA= not found in database
2020-04-21 12:52:15.299 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:15.316 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:15.346 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:15.409 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-21 12:52:15.458 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-21 12:52:15.494 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****RSCw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****VEz0","$type":"Token"},{"TokenType":"access_token","TokenValue":"****3UKA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV5S7FVO1CC:00000001","TimeStamp":"2020-04-21T10:52:15.0000000Z","ProcessId":28052,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-21 12:52:15.863 +02:00 [DBG] Token request success.
2020-04-21 12:52:16.121 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-21 12:52:16.175 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-21 12:52:16.204 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-21 12:52:16.228 +02:00 [DBG] Start userinfo request
2020-04-21 12:52:16.256 +02:00 [DBG] Bearer token found in header
2020-04-21 12:52:16.323 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:16.599 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:16.655 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-21 12:52:16.658 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-21 12:52:16.673 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-21 12:52:16.675 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587466335,"exp":1587552735,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587466310,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-21 12:52:16.712 +02:00 [DBG] Creating userinfo response
2020-04-21 12:52:16.724 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:52:16.734 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:52:16.743 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:16.760 +02:00 [DBG] Requested claim types: 
2020-04-21 12:52:16.761 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-21 12:52:16.771 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-21 12:52:16.783 +02:00 [INF] Profile service returned the following claim types: 
2020-04-21 12:52:16.787 +02:00 [DBG] End userinfo request
2020-04-21 13:50:56.694 +02:00 [INF] Removing 0 grants
2020-04-21 13:50:56.725 +02:00 [INF] Removing 0 device flow codes
2020-04-21 14:50:56.971 +02:00 [INF] Removing 0 grants
2020-04-22 11:18:29.463 +02:00 [INF] Starting host...
2020-04-22 11:18:36.002 +02:00 [FTL] Host terminated unexpectedly.
System.AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: Thandizo.IdentityServer.Services.IUserManagementService Lifetime: Transient ImplementationType: Thandizo.IdentityServer.Services.UserManagementService': Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.)
 ---> System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: Thandizo.IdentityServer.Services.IUserManagementService Lifetime: Transient ImplementationType: Thandizo.IdentityServer.Services.UserManagementService': Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(Type serviceType, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, Type serviceType, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, Type serviceType, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable`1 serviceDescriptors, ServiceProviderOptions options)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable`1 serviceDescriptors, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.DefaultServiceProviderFactory.CreateServiceProvider(IServiceCollection containerBuilder)
   at Microsoft.Extensions.Hosting.Internal.ServiceFactoryAdapter`1.CreateServiceProvider(Object containerBuilder)
   at Microsoft.Extensions.Hosting.HostBuilder.CreateServiceProvider()
   at Microsoft.Extensions.Hosting.HostBuilder.Build()
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-22 11:19:22.679 +02:00 [INF] Starting host...
2020-04-22 11:19:25.399 +02:00 [FTL] Host terminated unexpectedly.
System.AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: Thandizo.IdentityServer.Services.IUserManagementService Lifetime: Transient ImplementationType: Thandizo.IdentityServer.Services.UserManagementService': Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.)
 ---> System.InvalidOperationException: Error while validating the service descriptor 'ServiceType: Thandizo.IdentityServer.Services.IUserManagementService Lifetime: Transient ImplementationType: Thandizo.IdentityServer.Services.UserManagementService': Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.
 ---> System.InvalidOperationException: Unable to resolve service for type 'Thandizo.IdentityServer.Services.Messaging.ISMSService' while attempting to activate 'Thandizo.IdentityServer.Services.UserManagementService'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(Type serviceType, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, Type serviceType, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, Type serviceType, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceDescriptor serviceDescriptor, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.ValidateService(ServiceDescriptor descriptor)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngine.ValidateService(ServiceDescriptor descriptor)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable`1 serviceDescriptors, ServiceProviderOptions options)
   --- End of inner exception stack trace ---
   at Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable`1 serviceDescriptors, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.ServiceCollectionContainerBuilderExtensions.BuildServiceProvider(IServiceCollection services, ServiceProviderOptions options)
   at Microsoft.Extensions.DependencyInjection.DefaultServiceProviderFactory.CreateServiceProvider(IServiceCollection containerBuilder)
   at Microsoft.Extensions.Hosting.Internal.ServiceFactoryAdapter`1.CreateServiceProvider(Object containerBuilder)
   at Microsoft.Extensions.Hosting.HostBuilder.CreateServiceProvider()
   at Microsoft.Extensions.Hosting.HostBuilder.Build()
   at IdentityServer.Program.Main(String[] args) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Program.cs:line 32
2020-04-22 11:20:39.290 +02:00 [INF] Starting host...
2020-04-22 11:20:41.857 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 11:20:43.037 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 11:20:43.061 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 11:20:43.062 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 11:20:43.063 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 11:20:43.125 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 11:20:43.177 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 11:20:48.815 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 11:20:48.817 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 11:20:48.818 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 11:20:48.819 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 11:20:48.821 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 11:20:48.823 +02:00 [DBG] Error Url: /home/error
2020-04-22 11:20:48.824 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 11:21:00.864 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 11:21:00.930 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 11:21:00.935 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 11:21:00.940 +02:00 [DBG] Start discovery request
2020-04-22 11:21:02.385 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 11:21:08.692 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-22 11:21:08.710 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-22 11:21:08.712 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-22 11:21:08.725 +02:00 [WRN] Invalid HTTP request for token endpoint
2020-04-22 12:08:21.911 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 12:08:21.952 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 12:08:21.956 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 12:08:21.960 +02:00 [DBG] Start discovery request
2020-04-22 12:08:22.092 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 12:08:22.681 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 12:08:22.691 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 12:08:22.693 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 12:08:22.704 +02:00 [DBG] Start key discovery request
2020-04-22 12:08:23.217 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-22 12:08:23.222 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-22 12:08:23.224 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-22 12:08:23.359 +02:00 [DBG] Processing signout request for 1
2020-04-22 12:08:23.364 +02:00 [DBG] Start end session request validation
2020-04-22 12:08:23.407 +02:00 [DBG] Start identity token validation
2020-04-22 12:08:24.318 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:08:24.366 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:08:24.374 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-22 12:08:24.583 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-22 12:08:24.603 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587466335,"exp":1587552735,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637230630853946197.OTJhMTEyMzYtOWUxZi00OGJlLWI3YjMtZmVkOTk5YTAwZmNlMmQxYmZjYmMtN2M0NC00MDM5LWEzOTEtOWQ5MGJmYWJiYzRh","iat":1587466335,"at_hash":"uQ0KKVp_EW5XpVpkaDPjag","s_hash":"7v8IzvXa3BUkHM2aqxMGOA","sid":"RrjoZost7qcMu8aAOLYDyA","sub":"1","auth_time":1587466310,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-22 12:08:24.634 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIZQDby4fwTuWQT_rCKIJLPDQ8HhWTtBHQEvjjVE2ayXtYbdKmUMGoC4uagOdyB9ANhqrvMsYM-RgmOFjoaN8Tdb0qtSyjFfKLFQEsk8XXWlBifBbK9wGjcTf5scjjjerovKKKMj9TzslAkDJYirwHT","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIZQDby4fwTuWQT_rCKIJLPDQ8HhWTtBHQEvjjVE2ayXtYbdKmUMGoC4uagOdyB9ANhqrvMsYM-RgmOFjoaN8Tdb0qtSyjFfKLFQEsk8XXWlBifBbK9wGjcTf5scjjjerovKKKMj9TzslAkDJYirwHT","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-22 12:08:24.641 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-22 12:08:24.988 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-22 12:08:24.992 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-22 12:08:24.995 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-22 12:08:25.125 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV6JPO2CQNN:00000002","TimeStamp":"2020-04-22T10:08:25.0000000Z","ProcessId":16704,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-22 12:08:25.687 +02:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2020-04-22 12:08:25.695 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2020-04-22 12:08:25.696 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2020-04-22 12:08:25.703 +02:00 [DBG] Processing signout callback request
2020-04-22 12:08:25.789 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:08:25.792 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:08:25.797 +02:00 [DBG] No client front-channel logout URLs
2020-04-22 12:08:25.798 +02:00 [DBG] No client back-channel logout URLs
2020-04-22 12:08:25.804 +02:00 [INF] Successful signout callback.
2020-04-22 12:08:25.806 +02:00 [DBG] No client front-channel iframe urls
2020-04-22 12:08:25.807 +02:00 [DBG] No client back-channel iframe urls
2020-04-22 12:08:26.271 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-22 12:08:26.280 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-22 12:08:26.282 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-22 12:08:26.287 +02:00 [DBG] Start authorize request
2020-04-22 12:08:26.295 +02:00 [DBG] No user present in authorize request
2020-04-22 12:08:26.313 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:08:26.333 +02:00 [ERR] Unknown client or not enabled: ****
{"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"****","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile **** offline_access","response_mode":"form_post","nonce":"637231469062337901.ZmNhOGQ2NTItYmE1Ny00YTU5LThlMGItMmJmYTEzYmVkNTRiYTY1MzAxNTAtYWQwMi00MTllLWFmNzAtNDBhN2RkM2Y0MjMw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIWtTSuGpCQILi6OVJ6VTqe1iz_ArUAPhPWy1yrhvOpOgqqorHB0Kdh6DmJrdGQmxk7D81lrc46cUD5mXjtJfXQE76l5dT5NGMwMux-4Ny_oZ0EnmWJaJLrKTpyBYgo3TmBchdAOFxY5MFtmduCmqemXa2QgfW7XQylrLQJ_f9kwiaLUjhOkERNfDOj09yzZ_cQ6mpP_B_zFfYc7C6EJJZfR2FC_5ayHE0oElAcCPM9a9CWXeYdIsNl67eh0LupKAGnx5SITtjgD4_WC04t8s7G","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 12:08:26.359 +02:00 [ERR] Request validation failed
2020-04-22 12:08:26.361 +02:00 [INF] {"ClientId":null,"ClientName":null,"RedirectUri":null,"AllowedRedirectUris":null,"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"****","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile **** offline_access","response_mode":"form_post","nonce":"637231469062337901.ZmNhOGQ2NTItYmE1Ny00YTU5LThlMGItMmJmYTEzYmVkNTRiYTY1MzAxNTAtYWQwMi00MTllLWFmNzAtNDBhN2RkM2Y0MjMw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIWtTSuGpCQILi6OVJ6VTqe1iz_ArUAPhPWy1yrhvOpOgqqorHB0Kdh6DmJrdGQmxk7D81lrc46cUD5mXjtJfXQE76l5dT5NGMwMux-4Ny_oZ0EnmWJaJLrKTpyBYgo3TmBchdAOFxY5MFtmduCmqemXa2QgfW7XQylrLQJ_f9kwiaLUjhOkERNfDOj09yzZ_cQ6mpP_B_zFfYc7C6EJJZfR2FC_5ayHE0oElAcCPM9a9CWXeYdIsNl67eh0LupKAGnx5SITtjgD4_WC04t8s7G","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 12:08:26.393 +02:00 [INF] {"ClientId":"****","ClientName":null,"RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Unknown client or client not enabled","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLV6JPO2CQNO:00000002","TimeStamp":"2020-04-22T10:08:26.0000000Z","ProcessId":16704,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2020-04-22 12:09:23.755 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 12:09:23.777 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 12:09:23.782 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 12:09:23.786 +02:00 [DBG] Start discovery request
2020-04-22 12:09:23.820 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 12:09:24.407 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 12:09:24.424 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 12:09:24.456 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 12:09:24.463 +02:00 [DBG] Start key discovery request
2020-04-22 12:09:24.586 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-22 12:09:24.594 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-22 12:09:24.602 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-22 12:09:24.604 +02:00 [DBG] Start authorize request
2020-04-22 12:09:24.606 +02:00 [DBG] No user present in authorize request
2020-04-22 12:09:24.607 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:09:24.651 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:09:24.655 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:09:24.717 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 12:09:24.718 +02:00 [DBG] No PKCE used.
2020-04-22 12:09:25.069 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:09:25.188 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:09:25.236 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:09:25.249 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:09:25.272 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 12:09:25.275 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL18E1Pzc5bNC9xwdGFHVvYDadaxR33oH3B4mNr7w0cDybZDj5jqlWV9awrfnhuLFMw7PEp8tD9kGPjhV21Sh4E1J6gLONE_eblO79dBCPI9wzkj6eN0YZ7WHHty3ywdskbT6RSF8ibT8UEy7ALB6G8wsKkATYt3bLuufOSECFwgoXJjx6wYVMCcixk2qHG-dYnuBxkYk7FQVDEGNJvTFFufu65L-HWcsH1Kp79sFpB7gotExyrfJ4xoD2gBYOaksjq9oDWRLyY1DxyWY12MsoP","UiLocales":null,"Nonce":"637231469645066328.ZTg5MTZlMDktNmY4NS00MDdmLWFiMWEtNjIzOWNkODczNjZlMTJmZTE3YzgtMGQ0Yy00YTRmLWEyNDYtNDBkY2E2ZTI5ZmE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637231469645066328.ZTg5MTZlMDktNmY4NS00MDdmLWFiMWEtNjIzOWNkODczNjZlMTJmZTE3YzgtMGQ0Yy00YTRmLWEyNDYtNDBkY2E2ZTI5ZmE2","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL18E1Pzc5bNC9xwdGFHVvYDadaxR33oH3B4mNr7w0cDybZDj5jqlWV9awrfnhuLFMw7PEp8tD9kGPjhV21Sh4E1J6gLONE_eblO79dBCPI9wzkj6eN0YZ7WHHty3ywdskbT6RSF8ibT8UEy7ALB6G8wsKkATYt3bLuufOSECFwgoXJjx6wYVMCcixk2qHG-dYnuBxkYk7FQVDEGNJvTFFufu65L-HWcsH1Kp79sFpB7gotExyrfJ4xoD2gBYOaksjq9oDWRLyY1DxyWY12MsoP","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 12:09:25.348 +02:00 [INF] Showing login: User is not authenticated
2020-04-22 12:09:25.452 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:09:25.532 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:09:25.535 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:09:25.539 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 12:09:25.540 +02:00 [DBG] No PKCE used.
2020-04-22 12:09:25.549 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:09:25.556 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:09:25.573 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:09:25.584 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:09:25.597 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 12:09:25.650 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:09:25.657 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:12:19.154 +02:00 [INF] Starting host...
2020-04-22 12:12:22.753 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 12:12:23.240 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 12:12:23.242 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 12:12:23.243 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 12:12:23.243 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 12:12:23.244 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 12:12:23.245 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 12:12:26.710 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 12:12:26.716 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 12:12:26.717 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 12:12:26.719 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 12:12:26.721 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 12:12:26.721 +02:00 [DBG] Error Url: /home/error
2020-04-22 12:12:26.722 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 12:12:53.319 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:12:59.184 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:12:59.208 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:12:59.240 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 12:12:59.245 +02:00 [DBG] No PKCE used.
2020-04-22 12:12:59.470 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:12:59.934 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:13:00.064 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:13:00.099 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:13:00.147 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 12:13:00.230 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:13:00.233 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:29.547 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-22 12:15:29.861 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:15:30.018 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:30.022 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:30.025 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 12:15:30.026 +02:00 [DBG] No PKCE used.
2020-04-22 12:15:30.041 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:30.051 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:30.097 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:30.130 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:30.142 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 12:15:30.714 +02:00 [DBG] Augmenting SignInContext
2020-04-22 12:15:30.717 +02:00 [DBG] Adding idp claim with value: local
2020-04-22 12:15:30.718 +02:00 [DBG] Adding auth_time claim with value: 1587550530
2020-04-22 12:15:30.764 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-22 12:15:30.844 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV6KMJEMEQM:00000007","TimeStamp":"2020-04-22T10:15:30.0000000Z","ProcessId":33680,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-22 12:15:30.972 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-22 12:15:30.980 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-22 12:15:30.983 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-22 12:15:30.996 +02:00 [DBG] Start authorize callback request
2020-04-22 12:15:31.008 +02:00 [DBG] User in authorize request: 1
2020-04-22 12:15:31.009 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 12:15:31.048 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:31.051 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:31.056 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 12:15:31.057 +02:00 [DBG] No PKCE used.
2020-04-22 12:15:31.061 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:31.069 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:31.083 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:31.096 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:31.111 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 12:15:31.133 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL18E1Pzc5bNC9xwdGFHVvYDadaxR33oH3B4mNr7w0cDybZDj5jqlWV9awrfnhuLFMw7PEp8tD9kGPjhV21Sh4E1J6gLONE_eblO79dBCPI9wzkj6eN0YZ7WHHty3ywdskbT6RSF8ibT8UEy7ALB6G8wsKkATYt3bLuufOSECFwgoXJjx6wYVMCcixk2qHG-dYnuBxkYk7FQVDEGNJvTFFufu65L-HWcsH1Kp79sFpB7gotExyrfJ4xoD2gBYOaksjq9oDWRLyY1DxyWY12MsoP","UiLocales":null,"Nonce":"637231469645066328.ZTg5MTZlMDktNmY4NS00MDdmLWFiMWEtNjIzOWNkODczNjZlMTJmZTE3YzgtMGQ0Yy00YTRmLWEyNDYtNDBkY2E2ZTI5ZmE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"pbK-sc1xX9gHGhLW_htUHQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637231469645066328.ZTg5MTZlMDktNmY4NS00MDdmLWFiMWEtNjIzOWNkODczNjZlMTJmZTE3YzgtMGQ0Yy00YTRmLWEyNDYtNDBkY2E2ZTI5ZmE2","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL18E1Pzc5bNC9xwdGFHVvYDadaxR33oH3B4mNr7w0cDybZDj5jqlWV9awrfnhuLFMw7PEp8tD9kGPjhV21Sh4E1J6gLONE_eblO79dBCPI9wzkj6eN0YZ7WHHty3ywdskbT6RSF8ibT8UEy7ALB6G8wsKkATYt3bLuufOSECFwgoXJjx6wYVMCcixk2qHG-dYnuBxkYk7FQVDEGNJvTFFufu65L-HWcsH1Kp79sFpB7gotExyrfJ4xoD2gBYOaksjq9oDWRLyY1DxyWY12MsoP","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 12:15:31.307 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-22 12:15:31.313 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-22 12:15:31.773 +02:00 [DBG] d9qGOcvIUG0K0xT58okVLTzJpzJEaXZdhdMnDDyAoL0= not found in database
2020-04-22 12:15:32.521 +02:00 [DBG] Creating Implicit Flow response.
2020-04-22 12:15:32.533 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-22 12:15:32.724 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****-gjQ","$type":"Token"},{"TokenType":"code","TokenValue":"****P21M","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV6KMJEMEQM:00000008","TimeStamp":"2020-04-22T10:15:32.0000000Z","ProcessId":33680,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-22 12:15:32.747 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL18E1Pzc5bNC9xwdGFHVvYDadaxR33oH3B4mNr7w0cDybZDj5jqlWV9awrfnhuLFMw7PEp8tD9kGPjhV21Sh4E1J6gLONE_eblO79dBCPI9wzkj6eN0YZ7WHHty3ywdskbT6RSF8ibT8UEy7ALB6G8wsKkATYt3bLuufOSECFwgoXJjx6wYVMCcixk2qHG-dYnuBxkYk7FQVDEGNJvTFFufu65L-HWcsH1Kp79sFpB7gotExyrfJ4xoD2gBYOaksjq9oDWRLyY1DxyWY12MsoP","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-22 12:15:33.012 +02:00 [DBG] Augmenting SignInContext
2020-04-22 12:15:33.023 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-22 12:15:33.820 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-22 12:15:33.834 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-22 12:15:33.837 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-22 12:15:33.848 +02:00 [DBG] Start token request.
2020-04-22 12:15:33.854 +02:00 [DBG] Start client validation
2020-04-22 12:15:33.861 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-22 12:15:33.865 +02:00 [DBG] Start parsing for secret in post body
2020-04-22 12:15:33.871 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-22 12:15:33.873 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-22 12:15:33.937 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:33.940 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:33.997 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-22 12:15:34.003 +02:00 [DBG] Client validation success
2020-04-22 12:15:34.030 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV6KMJEMEQS:00000001","TimeStamp":"2020-04-22T10:15:34.0000000Z","ProcessId":33680,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-22 12:15:34.064 +02:00 [DBG] Start token request validation
2020-04-22 12:15:34.088 +02:00 [DBG] Start validation of authorization code token request
2020-04-22 12:15:34.133 +02:00 [DBG] d9qGOcvIUG0K0xT58okVLTzJpzJEaXZdhdMnDDyAoL0= found in database: true
2020-04-22 12:15:34.340 +02:00 [DBG] removing d9qGOcvIUG0K0xT58okVLTzJpzJEaXZdhdMnDDyAoL0= persisted grant from database
2020-04-22 12:15:34.469 +02:00 [DBG] Validation of authorization code token request success
2020-04-22 12:15:34.480 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"MGMTqMfNYJKZC0G9szy7OBA5hc8i74wFo8kZVacP21M","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"MGMTqMfNYJKZC0G9szy7OBA5hc8i74wFo8kZVacP21M","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-22 12:15:34.569 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:34.572 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:34.602 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:34.613 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:34.642 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-22 12:15:34.644 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-22 12:15:34.669 +02:00 [DBG] Creating refresh token
2020-04-22 12:15:34.670 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-22 12:15:34.698 +02:00 [DBG] +y5ugh97ZdBAJNFWifb1onOOHdhAFqlQNbMTzDitJ4o= not found in database
2020-04-22 12:15:34.745 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:34.748 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:34.757 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:34.765 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 12:15:34.780 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-22 12:15:34.798 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****ek9g","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****MLeM","$type":"Token"},{"TokenType":"access_token","TokenValue":"****skxA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV6KMJEMEQS:00000001","TimeStamp":"2020-04-22T10:15:34.0000000Z","ProcessId":33680,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-22 12:15:34.827 +02:00 [DBG] Token request success.
2020-04-22 12:15:35.086 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-22 12:15:35.102 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-22 12:15:35.109 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-22 12:15:35.123 +02:00 [DBG] Start userinfo request
2020-04-22 12:15:35.126 +02:00 [DBG] Bearer token found in header
2020-04-22 12:15:35.262 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:35.267 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:35.308 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:15:35.311 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:15:35.322 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-22 12:15:35.326 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587550534,"exp":1587636934,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587550530,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-22 12:15:35.362 +02:00 [DBG] Creating userinfo response
2020-04-22 12:15:35.368 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 12:15:35.373 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 12:15:35.385 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:35.397 +02:00 [DBG] Requested claim types: 
2020-04-22 12:15:35.398 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 12:15:35.411 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 12:15:35.428 +02:00 [INF] Profile service returned the following claim types: 
2020-04-22 12:15:35.430 +02:00 [DBG] End userinfo request
2020-04-22 12:20:19.299 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-22 12:20:19.307 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-22 12:20:19.330 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-22 12:20:19.338 +02:00 [DBG] Processing signout request for 1
2020-04-22 12:20:19.346 +02:00 [DBG] Start end session request validation
2020-04-22 12:20:19.352 +02:00 [DBG] Start identity token validation
2020-04-22 12:20:19.537 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 12:20:19.540 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 12:20:19.547 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-22 12:20:19.563 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-22 12:20:19.566 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587550534,"exp":1587636934,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637231469645066328.ZTg5MTZlMDktNmY4NS00MDdmLWFiMWEtNjIzOWNkODczNjZlMTJmZTE3YzgtMGQ0Yy00YTRmLWEyNDYtNDBkY2E2ZTI5ZmE2","iat":1587550534,"at_hash":"gQbW6WJqH-mpipLorWJPxg","s_hash":"zmRVthLOXF1dpIyuTNDbkg","sid":"pbK-sc1xX9gHGhLW_htUHQ","sub":"1","auth_time":1587550530,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-22 12:20:19.595 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLi64AXV7jggoavo9GdQHEoWixm3BrXbPZSnB2r5hYlvQO3Z3c9-_qf6OkRSKjAu6ysOBGxqDWPErwMu6uB88SSDMF9CJZ0yFI8pPmdvTz-TBbd4YTpPkLJfchStzaIidBR7eIn9xHltLSofSdABjFe","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLi64AXV7jggoavo9GdQHEoWixm3BrXbPZSnB2r5hYlvQO3Z3c9-_qf6OkRSKjAu6ysOBGxqDWPErwMu6uB88SSDMF9CJZ0yFI8pPmdvTz-TBbd4YTpPkLJfchStzaIidBR7eIn9xHltLSofSdABjFe","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-22 12:20:19.604 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-22 12:20:19.835 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-22 12:20:19.843 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-22 12:20:19.845 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-22 12:20:19.849 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV6KMJEMEQT:00000002","TimeStamp":"2020-04-22T10:20:19.0000000Z","ProcessId":33680,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-22 13:12:23.192 +02:00 [INF] Removing 0 grants
2020-04-22 13:12:23.247 +02:00 [INF] Removing 0 device flow codes
2020-04-22 15:45:59.633 +02:00 [INF] Starting host...
2020-04-22 15:46:10.793 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 15:46:11.719 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 15:46:11.742 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 15:46:11.743 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 15:46:11.744 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 15:46:11.746 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 15:46:11.753 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 15:46:23.951 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 15:46:23.965 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 15:46:23.968 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 15:46:23.970 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 15:46:23.971 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 15:46:23.972 +02:00 [DBG] Error Url: /home/error
2020-04-22 15:46:23.973 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 15:59:00.044 +02:00 [INF] Starting host...
2020-04-22 15:59:11.431 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 15:59:12.335 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 15:59:12.340 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 15:59:12.340 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 15:59:12.341 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 15:59:12.341 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 15:59:12.342 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 15:59:18.812 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 15:59:18.840 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 15:59:18.873 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 15:59:18.880 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 15:59:18.886 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 15:59:18.893 +02:00 [DBG] Error Url: /home/error
2020-04-22 15:59:18.894 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 16:00:31.135 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 16:00:31.205 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 16:00:31.210 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 16:00:31.217 +02:00 [DBG] Start discovery request
2020-04-22 16:00:40.696 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 16:00:51.380 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 16:00:51.396 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 16:00:51.451 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 16:00:51.455 +02:00 [DBG] Start discovery request
2020-04-22 16:00:51.558 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 16:00:52.486 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 16:00:52.514 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 16:00:52.526 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 16:00:52.539 +02:00 [DBG] Start key discovery request
2020-04-22 16:00:53.041 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-22 16:00:53.124 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-22 16:00:53.131 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-22 16:00:53.140 +02:00 [DBG] Start authorize request
2020-04-22 16:00:53.174 +02:00 [DBG] No user present in authorize request
2020-04-22 16:00:53.184 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 16:00:54.123 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:00:54.214 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:00:54.315 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 16:00:54.347 +02:00 [DBG] No PKCE used.
2020-04-22 16:00:54.523 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:00:54.721 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:00:54.770 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:00:54.782 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:00:54.806 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 16:00:54.833 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL6HgfGNp-sVGk61D8SJAJ7Wmv_h6UNPR7Cml5vHkhbllJjgy7xnuWH806pU-hkmmBBnYwBI5D8OXhCbhbz8dIjjTgyh9dzNPm_vTp0eDHltTyfVQwdJu1hRzL1BX8hCPPnnTdhO4BFgolb24ySXTNFjsoCDGPqfiKF_91ZSegIBqRIeNJLIO_SOei4HxJY1O8KYQTqhVdNZjY7vl53PlWw0DDS5hy5fFuS9DDGZvVwn-z_M469upxzoLbz9j9NqxfWW0Lh81WGmrU9-0ytGxqW","UiLocales":null,"Nonce":"637231608529728474.NzA4NTVhN2YtZmZlMy00NTQ4LTliMjgtMTY3MDliYzhjODdlMmE4MWZkNjMtMGMxZS00NmFiLTg0OTgtNTE0NmM2ODE0MmFh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637231608529728474.NzA4NTVhN2YtZmZlMy00NTQ4LTliMjgtMTY3MDliYzhjODdlMmE4MWZkNjMtMGMxZS00NmFiLTg0OTgtNTE0NmM2ODE0MmFh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL6HgfGNp-sVGk61D8SJAJ7Wmv_h6UNPR7Cml5vHkhbllJjgy7xnuWH806pU-hkmmBBnYwBI5D8OXhCbhbz8dIjjTgyh9dzNPm_vTp0eDHltTyfVQwdJu1hRzL1BX8hCPPnnTdhO4BFgolb24ySXTNFjsoCDGPqfiKF_91ZSegIBqRIeNJLIO_SOei4HxJY1O8KYQTqhVdNZjY7vl53PlWw0DDS5hy5fFuS9DDGZvVwn-z_M469upxzoLbz9j9NqxfWW0Lh81WGmrU9-0ytGxqW","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 16:00:54.919 +02:00 [INF] Showing login: User is not authenticated
2020-04-22 16:00:55.192 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 16:00:55.331 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:00:55.337 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:00:55.341 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 16:00:55.343 +02:00 [DBG] No PKCE used.
2020-04-22 16:00:55.355 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:00:55.366 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:00:55.384 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:00:55.394 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:00:55.405 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 16:00:55.459 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:00:55.464 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:00.422 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-22 16:01:00.678 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 16:01:00.729 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:00.736 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:00.738 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 16:01:00.738 +02:00 [DBG] No PKCE used.
2020-04-22 16:01:00.748 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:00.764 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:00.790 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:00.806 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:00.826 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 16:01:01.648 +02:00 [DBG] Augmenting SignInContext
2020-04-22 16:01:01.652 +02:00 [DBG] Adding idp claim with value: local
2020-04-22 16:01:01.653 +02:00 [DBG] Adding auth_time claim with value: 1587564061
2020-04-22 16:01:01.679 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-22 16:01:01.782 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV6OLBTOLB6:00000001","TimeStamp":"2020-04-22T14:01:01.0000000Z","ProcessId":37944,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-22 16:01:02.090 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-22 16:01:02.095 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-22 16:01:02.096 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-22 16:01:02.106 +02:00 [DBG] Start authorize callback request
2020-04-22 16:01:02.111 +02:00 [DBG] User in authorize request: 1
2020-04-22 16:01:02.112 +02:00 [DBG] Start authorize request protocol validation
2020-04-22 16:01:02.291 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:02.295 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:02.300 +02:00 [DBG] Checking for PKCE parameters
2020-04-22 16:01:02.301 +02:00 [DBG] No PKCE used.
2020-04-22 16:01:02.309 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:02.321 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:02.337 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:02.356 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:02.367 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-22 16:01:02.374 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL6HgfGNp-sVGk61D8SJAJ7Wmv_h6UNPR7Cml5vHkhbllJjgy7xnuWH806pU-hkmmBBnYwBI5D8OXhCbhbz8dIjjTgyh9dzNPm_vTp0eDHltTyfVQwdJu1hRzL1BX8hCPPnnTdhO4BFgolb24ySXTNFjsoCDGPqfiKF_91ZSegIBqRIeNJLIO_SOei4HxJY1O8KYQTqhVdNZjY7vl53PlWw0DDS5hy5fFuS9DDGZvVwn-z_M469upxzoLbz9j9NqxfWW0Lh81WGmrU9-0ytGxqW","UiLocales":null,"Nonce":"637231608529728474.NzA4NTVhN2YtZmZlMy00NTQ4LTliMjgtMTY3MDliYzhjODdlMmE4MWZkNjMtMGMxZS00NmFiLTg0OTgtNTE0NmM2ODE0MmFh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"g1GX3CP0ZXvnpRR8h4gU0Q","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637231608529728474.NzA4NTVhN2YtZmZlMy00NTQ4LTliMjgtMTY3MDliYzhjODdlMmE4MWZkNjMtMGMxZS00NmFiLTg0OTgtNTE0NmM2ODE0MmFh","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL6HgfGNp-sVGk61D8SJAJ7Wmv_h6UNPR7Cml5vHkhbllJjgy7xnuWH806pU-hkmmBBnYwBI5D8OXhCbhbz8dIjjTgyh9dzNPm_vTp0eDHltTyfVQwdJu1hRzL1BX8hCPPnnTdhO4BFgolb24ySXTNFjsoCDGPqfiKF_91ZSegIBqRIeNJLIO_SOei4HxJY1O8KYQTqhVdNZjY7vl53PlWw0DDS5hy5fFuS9DDGZvVwn-z_M469upxzoLbz9j9NqxfWW0Lh81WGmrU9-0ytGxqW","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-22 16:01:02.491 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-22 16:01:02.499 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-22 16:01:02.692 +02:00 [DBG] c63dMV2E+umuhXI9D+yePqCYJ5hvjCdbTr1mR47fkp8= not found in database
2020-04-22 16:01:03.090 +02:00 [DBG] Creating Implicit Flow response.
2020-04-22 16:01:03.105 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-22 16:01:03.443 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****fR5Q","$type":"Token"},{"TokenType":"code","TokenValue":"****c9dg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV6OLBTOLB6:00000002","TimeStamp":"2020-04-22T14:01:03.0000000Z","ProcessId":37944,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-22 16:01:03.465 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtL6HgfGNp-sVGk61D8SJAJ7Wmv_h6UNPR7Cml5vHkhbllJjgy7xnuWH806pU-hkmmBBnYwBI5D8OXhCbhbz8dIjjTgyh9dzNPm_vTp0eDHltTyfVQwdJu1hRzL1BX8hCPPnnTdhO4BFgolb24ySXTNFjsoCDGPqfiKF_91ZSegIBqRIeNJLIO_SOei4HxJY1O8KYQTqhVdNZjY7vl53PlWw0DDS5hy5fFuS9DDGZvVwn-z_M469upxzoLbz9j9NqxfWW0Lh81WGmrU9-0ytGxqW","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-22 16:01:03.504 +02:00 [DBG] Augmenting SignInContext
2020-04-22 16:01:03.508 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-22 16:01:04.115 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-22 16:01:04.135 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-22 16:01:04.137 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-22 16:01:04.151 +02:00 [DBG] Start token request.
2020-04-22 16:01:04.155 +02:00 [DBG] Start client validation
2020-04-22 16:01:04.170 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-22 16:01:04.175 +02:00 [DBG] Start parsing for secret in post body
2020-04-22 16:01:04.178 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-22 16:01:04.179 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-22 16:01:04.245 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:04.251 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:04.277 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-22 16:01:04.282 +02:00 [DBG] Client validation success
2020-04-22 16:01:04.286 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV6OLBTOLAP:00000003","TimeStamp":"2020-04-22T14:01:04.0000000Z","ProcessId":37944,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-22 16:01:04.302 +02:00 [DBG] Start token request validation
2020-04-22 16:01:04.317 +02:00 [DBG] Start validation of authorization code token request
2020-04-22 16:01:04.364 +02:00 [DBG] c63dMV2E+umuhXI9D+yePqCYJ5hvjCdbTr1mR47fkp8= found in database: true
2020-04-22 16:01:04.452 +02:00 [DBG] removing c63dMV2E+umuhXI9D+yePqCYJ5hvjCdbTr1mR47fkp8= persisted grant from database
2020-04-22 16:01:04.492 +02:00 [DBG] Validation of authorization code token request success
2020-04-22 16:01:04.501 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"y0jkbXvHE2Dpcxxi9Q-rXZMcQyijOTr_Nw85GmGc9dg","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"y0jkbXvHE2Dpcxxi9Q-rXZMcQyijOTr_Nw85GmGc9dg","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-22 16:01:04.571 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:04.573 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:04.582 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:04.606 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:04.641 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-22 16:01:04.644 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-22 16:01:04.672 +02:00 [DBG] Creating refresh token
2020-04-22 16:01:04.673 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-22 16:01:04.704 +02:00 [DBG] wAMzMxhf0nA7YyJtC97yRe051hlF0aY9/F0Y8LsCv2M= not found in database
2020-04-22 16:01:04.942 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:04.948 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:04.957 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:04.968 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-22 16:01:04.980 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-22 16:01:05.000 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****QAxw","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****kCm8","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Ennw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV6OLBTOLAP:00000003","TimeStamp":"2020-04-22T14:01:05.0000000Z","ProcessId":37944,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-22 16:01:05.034 +02:00 [DBG] Token request success.
2020-04-22 16:01:05.266 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-22 16:01:05.274 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-22 16:01:05.277 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-22 16:01:05.290 +02:00 [DBG] Start userinfo request
2020-04-22 16:01:05.295 +02:00 [DBG] Bearer token found in header
2020-04-22 16:01:05.467 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:05.471 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:05.519 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-22 16:01:05.524 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-22 16:01:05.534 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-22 16:01:05.540 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587564064,"exp":1587650464,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587564061,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-22 16:01:05.576 +02:00 [DBG] Creating userinfo response
2020-04-22 16:01:05.584 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 16:01:05.590 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 16:01:05.606 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:05.621 +02:00 [DBG] Requested claim types: 
2020-04-22 16:01:05.622 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-22 16:01:05.630 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-22 16:01:05.643 +02:00 [INF] Profile service returned the following claim types: 
2020-04-22 16:01:05.650 +02:00 [DBG] End userinfo request
2020-04-22 16:59:13.348 +02:00 [INF] Removing 0 grants
2020-04-22 16:59:13.674 +02:00 [INF] Removing 0 device flow codes
2020-04-22 17:20:40.444 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 17:20:40.761 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 17:20:41.311 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 17:20:41.329 +02:00 [DBG] Start discovery request
2020-04-22 17:20:42.553 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 17:20:44.305 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 17:20:44.353 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 17:20:44.359 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 17:20:44.376 +02:00 [DBG] Start key discovery request
2020-04-22 17:31:29.546 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 17:31:29.654 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 17:31:29.720 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 17:31:29.756 +02:00 [DBG] Start discovery request
2020-04-22 17:31:30.383 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 17:31:31.868 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 17:31:31.951 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 17:31:32.017 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 17:31:32.042 +02:00 [DBG] Start key discovery request
2020-04-22 18:02:07.763 +02:00 [INF] Starting host...
2020-04-22 18:02:18.390 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 18:02:18.760 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 18:02:18.763 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 18:02:18.764 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 18:02:18.765 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 18:02:18.765 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 18:02:18.766 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 18:02:24.558 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 18:02:24.562 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 18:02:24.563 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 18:02:24.565 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 18:02:24.566 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 18:02:24.567 +02:00 [DBG] Error Url: /home/error
2020-04-22 18:02:24.568 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 18:06:38.410 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-22 18:06:38.456 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-22 18:06:38.465 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-22 18:06:38.476 +02:00 [DBG] Start discovery request
2020-04-22 18:06:40.037 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-22 18:06:40.830 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-22 18:06:40.840 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-22 18:06:40.841 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-22 18:06:40.848 +02:00 [DBG] Start key discovery request
2020-04-22 19:02:18.518 +02:00 [INF] Removing 0 grants
2020-04-22 19:02:18.548 +02:00 [INF] Removing 0 device flow codes
2020-04-22 19:19:08.651 +02:00 [INF] Starting host...
2020-04-22 19:19:16.797 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-22 19:19:17.255 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-22 19:19:17.257 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-22 19:19:17.261 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-22 19:19:17.262 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-22 19:19:17.262 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-22 19:19:17.263 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-22 19:19:18.920 +02:00 [DBG] Login Url: /Account/Login
2020-04-22 19:19:18.923 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-22 19:19:18.924 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-22 19:19:18.926 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-22 19:19:18.927 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-22 19:19:18.928 +02:00 [DBG] Error Url: /home/error
2020-04-22 19:19:18.929 +02:00 [DBG] Error Id Parameter: errorId
2020-04-22 19:21:26.724 +02:00 [INF] RuAMYYT)
2020-04-23 12:25:43.444 +02:00 [INF] Starting host...
2020-04-23 12:26:11.017 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 12:26:12.775 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 12:26:12.782 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 12:26:12.783 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 12:26:12.783 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 12:26:12.784 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 12:26:12.785 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 12:26:19.239 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 12:26:19.245 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 12:26:19.246 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 12:26:19.247 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 12:26:19.248 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 12:26:19.251 +02:00 [DBG] Error Url: /home/error
2020-04-23 12:26:19.252 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 12:31:40.590 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 12:31:40.713 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 12:31:40.728 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 12:31:40.744 +02:00 [DBG] Start discovery request
2020-04-23 12:31:53.290 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 12:31:54.752 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 12:31:54.760 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 12:31:54.762 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 12:31:54.768 +02:00 [DBG] Start key discovery request
2020-04-23 12:31:55.385 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 12:31:55.455 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 12:31:55.460 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 12:31:55.467 +02:00 [DBG] Start authorize request
2020-04-23 12:31:55.521 +02:00 [DBG] No user present in authorize request
2020-04-23 12:31:55.532 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:31:56.690 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:31:56.740 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:31:56.780 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:31:56.783 +02:00 [DBG] No PKCE used.
2020-04-23 12:31:56.976 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:31:57.124 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:31:57.199 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:31:57.216 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:31:57.251 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:31:57.297 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtII2y7xdP1Fr6hN4hfkhqZod0DYRSwEdp_Dghead-CHIZ4wip1xV6PGFX0SvLPV1hywY4M87WoT9iNztb0780ms0QUbD0hmOlwhA_JvO_NwzO_6H-xapBzZGnbHB5MFvZnvAFvVQ7zCk6v5_eOEsaXfPJf0FcRZ8jhR-Ewpz3LZiC0CO4z82PP0FfoR8XgOxdm7w1yvL560ocuOHTqfRyc32XpiZufqWdHrWioq6SQEYk0bjI621M-sYZ9UpAA87qaJig0BtTiXLs3vcF_uW_NH","UiLocales":null,"Nonce":"637232347152207400.MDQ5YzQ2MzUtM2E1Yi00NjIyLTllZGYtMzg5OGQ2Yzg3MzMyYWM3MWVlODYtZjk3OC00NjhmLWI4NTEtY2U1ZTY2ODBjYjRk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232347152207400.MDQ5YzQ2MzUtM2E1Yi00NjIyLTllZGYtMzg5OGQ2Yzg3MzMyYWM3MWVlODYtZjk3OC00NjhmLWI4NTEtY2U1ZTY2ODBjYjRk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtII2y7xdP1Fr6hN4hfkhqZod0DYRSwEdp_Dghead-CHIZ4wip1xV6PGFX0SvLPV1hywY4M87WoT9iNztb0780ms0QUbD0hmOlwhA_JvO_NwzO_6H-xapBzZGnbHB5MFvZnvAFvVQ7zCk6v5_eOEsaXfPJf0FcRZ8jhR-Ewpz3LZiC0CO4z82PP0FfoR8XgOxdm7w1yvL560ocuOHTqfRyc32XpiZufqWdHrWioq6SQEYk0bjI621M-sYZ9UpAA87qaJig0BtTiXLs3vcF_uW_NH","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 12:31:57.366 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 12:31:58.043 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:31:58.149 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:31:58.153 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:31:58.156 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:31:58.157 +02:00 [DBG] No PKCE used.
2020-04-23 12:31:58.164 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:31:58.176 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:31:58.315 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:31:58.377 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:31:58.411 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:31:58.585 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:31:58.590 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:33:19.592 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 12:33:19.623 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 12:33:19.632 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 12:33:19.638 +02:00 [DBG] Start discovery request
2020-04-23 12:33:19.722 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 12:33:20.841 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 12:33:20.851 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 12:33:20.857 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 12:33:20.862 +02:00 [DBG] Start key discovery request
2020-04-23 12:33:21.099 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 12:33:21.124 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 12:33:21.127 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 12:33:21.131 +02:00 [DBG] Start authorize request
2020-04-23 12:33:21.132 +02:00 [DBG] No user present in authorize request
2020-04-23 12:33:21.137 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:33:21.239 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:33:21.242 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:33:21.248 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:33:21.249 +02:00 [DBG] No PKCE used.
2020-04-23 12:33:21.263 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:33:21.276 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:33:21.313 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:33:21.329 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:33:21.342 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:33:21.347 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","UiLocales":null,"Nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 12:33:21.418 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 12:33:21.527 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:33:21.667 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:33:21.671 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:33:21.675 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:33:21.676 +02:00 [DBG] No PKCE used.
2020-04-23 12:33:21.701 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:33:21.727 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:33:21.773 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:33:21.809 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:33:21.860 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:33:22.108 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:33:22.111 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:43.043 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 12:35:43.440 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:35:43.633 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:43.644 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:43.647 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:35:43.648 +02:00 [DBG] No PKCE used.
2020-04-23 12:35:43.680 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:43.701 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:43.721 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:43.786 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:43.812 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:35:44.623 +02:00 [DBG] Augmenting SignInContext
2020-04-23 12:35:44.626 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 12:35:44.627 +02:00 [DBG] Adding auth_time claim with value: 1587638144
2020-04-23 12:35:44.656 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 12:35:44.821 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7E310GE24:00000001","TimeStamp":"2020-04-23T10:35:44.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 12:35:45.026 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-23 12:35:45.030 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-23 12:35:45.032 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-23 12:35:45.040 +02:00 [DBG] Start authorize callback request
2020-04-23 12:35:45.047 +02:00 [DBG] User in authorize request: 1
2020-04-23 12:35:45.048 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:35:45.155 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:45.160 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:45.163 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:35:45.164 +02:00 [DBG] No PKCE used.
2020-04-23 12:35:45.169 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:45.186 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:45.207 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:45.222 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:45.233 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:35:45.237 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","UiLocales":null,"Nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"dCU6CIdQW48nUguFH4gPwQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 12:35:45.351 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 12:35:45.359 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 12:35:45.549 +02:00 [DBG] xWqEPTprgtGiF+sAaTxZ0ieAhP0nQFED+q6PdaB3eSg= not found in database
2020-04-23 12:35:46.050 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 12:35:46.076 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 12:35:46.429 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****tVRA","$type":"Token"},{"TokenType":"code","TokenValue":"****f_us","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE24:00000002","TimeStamp":"2020-04-23T10:35:46.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 12:35:46.454 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 12:35:46.487 +02:00 [DBG] Augmenting SignInContext
2020-04-23 12:35:46.489 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 12:35:47.220 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-23 12:35:47.240 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-23 12:35:47.246 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-23 12:35:47.258 +02:00 [DBG] Start token request.
2020-04-23 12:35:47.267 +02:00 [DBG] Start client validation
2020-04-23 12:35:47.278 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-23 12:35:47.282 +02:00 [DBG] Start parsing for secret in post body
2020-04-23 12:35:47.286 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-23 12:35:47.287 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-23 12:35:47.379 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:47.383 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:47.408 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-23 12:35:47.409 +02:00 [DBG] Client validation success
2020-04-23 12:35:47.414 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV7E310GE23:00000003","TimeStamp":"2020-04-23T10:35:47.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-23 12:35:47.435 +02:00 [DBG] Start token request validation
2020-04-23 12:35:47.452 +02:00 [DBG] Start validation of authorization code token request
2020-04-23 12:35:47.499 +02:00 [DBG] xWqEPTprgtGiF+sAaTxZ0ieAhP0nQFED+q6PdaB3eSg= found in database: true
2020-04-23 12:35:47.609 +02:00 [DBG] removing xWqEPTprgtGiF+sAaTxZ0ieAhP0nQFED+q6PdaB3eSg= persisted grant from database
2020-04-23 12:35:47.714 +02:00 [DBG] Validation of authorization code token request success
2020-04-23 12:35:47.724 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"pNt8LXzncnlMcXGBsLcV-33R2-XgQojN1aThliuf_us","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"pNt8LXzncnlMcXGBsLcV-33R2-XgQojN1aThliuf_us","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-23 12:35:47.818 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:47.821 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:47.834 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:47.865 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:47.899 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-23 12:35:47.907 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-23 12:35:47.937 +02:00 [DBG] Creating refresh token
2020-04-23 12:35:47.938 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-23 12:35:48.009 +02:00 [DBG] rPv0NMNt4QnBgyH0z+YNNI23UGJUL8VKyWtK048WR1Y= not found in database
2020-04-23 12:35:48.076 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:48.079 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:48.095 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:48.110 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:35:48.128 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 12:35:48.156 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****v-Jg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****TjDw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****SP8A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE23:00000003","TimeStamp":"2020-04-23T10:35:48.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 12:35:48.181 +02:00 [DBG] Token request success.
2020-04-23 12:35:48.434 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-23 12:35:48.448 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-23 12:35:48.452 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-23 12:35:48.463 +02:00 [DBG] Start userinfo request
2020-04-23 12:35:48.471 +02:00 [DBG] Bearer token found in header
2020-04-23 12:35:48.709 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:48.717 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:48.813 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:35:48.822 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:35:48.836 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 12:35:48.844 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587638147,"exp":1587724547,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587638144,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 12:35:48.879 +02:00 [DBG] Creating userinfo response
2020-04-23 12:35:48.893 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:35:48.901 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:35:48.920 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:48.938 +02:00 [DBG] Requested claim types: 
2020-04-23 12:35:48.939 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:35:48.954 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:35:48.970 +02:00 [INF] Profile service returned the following claim types: 
2020-04-23 12:35:48.972 +02:00 [DBG] End userinfo request
2020-04-23 12:52:50.134 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 12:52:50.157 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 12:52:50.174 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 12:52:50.182 +02:00 [DBG] Start discovery request
2020-04-23 12:52:50.473 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 12:52:51.461 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 12:52:51.472 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 12:52:51.478 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 12:52:51.482 +02:00 [DBG] Start key discovery request
2020-04-23 12:52:51.660 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-23 12:52:51.669 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-23 12:52:51.676 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-23 12:52:51.684 +02:00 [DBG] Processing signout request for 1
2020-04-23 12:52:51.695 +02:00 [DBG] Start end session request validation
2020-04-23 12:52:51.706 +02:00 [DBG] Start identity token validation
2020-04-23 12:52:51.803 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:52:51.807 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:52:51.812 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-23 12:52:51.827 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 12:52:51.829 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587638148,"exp":1587724548,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","iat":1587638148,"at_hash":"NdoHtPOqtK3wQKb7ACMi9w","s_hash":"StdbaXd4TBxDAcedrpfaMA","sid":"dCU6CIdQW48nUguFH4gPwQ","sub":"1","auth_time":1587638144,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 12:52:51.848 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKU9gKOFaFeaMq0ZBA-8YZ3jGZYDYK7RwUuKFjJsSxMQm3m9rxBVpldfuNhQ-CEH0HpB-zafsfdhACT-95AbeCCLH-O2RU99n4aVAHRXi9P9Mp-V09ZlzxteSXwIIFe7G2xbjZPkgetoq-St4Ryr_gl","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKU9gKOFaFeaMq0ZBA-8YZ3jGZYDYK7RwUuKFjJsSxMQm3m9rxBVpldfuNhQ-CEH0HpB-zafsfdhACT-95AbeCCLH-O2RU99n4aVAHRXi9P9Mp-V09ZlzxteSXwIIFe7G2xbjZPkgetoq-St4Ryr_gl","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-23 12:52:51.859 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-23 12:52:52.125 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-23 12:52:52.132 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-23 12:52:52.142 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-23 12:52:52.147 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV7E310GE26:00000002","TimeStamp":"2020-04-23T10:52:52.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-23 12:52:54.513 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 12:52:54.650 +02:00 [DBG] Augmenting SignInContext
2020-04-23 12:52:54.651 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 12:52:54.656 +02:00 [DBG] Adding auth_time claim with value: 1587639174
2020-04-23 12:52:54.659 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 12:52:54.665 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7E310GE26:00000004","TimeStamp":"2020-04-23T10:52:54.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 12:53:05.521 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:53:05.616 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:05.620 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:05.624 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:53:05.626 +02:00 [DBG] No PKCE used.
2020-04-23 12:53:05.633 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:05.645 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:05.663 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:05.687 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:05.703 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:53:05.809 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:05.812 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:07.633 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 12:53:07.714 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:53:07.778 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:07.784 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:07.787 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:53:07.788 +02:00 [DBG] No PKCE used.
2020-04-23 12:53:07.806 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:07.823 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:07.846 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:07.863 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:07.881 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:53:07.930 +02:00 [DBG] Augmenting SignInContext
2020-04-23 12:53:07.932 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 12:53:07.935 +02:00 [DBG] Adding auth_time claim with value: 1587639187
2020-04-23 12:53:07.940 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 12:53:07.948 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7E310GE26:00000008","TimeStamp":"2020-04-23T10:53:07.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 12:53:08.005 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-23 12:53:08.011 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-23 12:53:08.014 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-23 12:53:08.019 +02:00 [DBG] Start authorize callback request
2020-04-23 12:53:08.022 +02:00 [DBG] User in authorize request: 1
2020-04-23 12:53:08.023 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:53:08.120 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:08.125 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:08.129 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:53:08.130 +02:00 [DBG] No PKCE used.
2020-04-23 12:53:08.142 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:08.158 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:08.200 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:08.214 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:08.226 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:53:08.233 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","UiLocales":null,"Nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3FHo3NW6AmBy0FSvy4i2zQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232348010308268.ZDEwYTAwZjQtZTVmYS00NDA5LWJiNGQtZmYwMjkzYWRlNmI1Nzc0YmZiMTAtMGRlOS00ZGZmLTg1YTYtZGZhNzUxYzRiMGQw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 12:53:08.285 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 12:53:08.286 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 12:53:08.298 +02:00 [DBG] h8K/j4qmCeNhxrcaQda7onhdEGEk9z77yb372k70tcU= not found in database
2020-04-23 12:53:08.313 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 12:53:08.314 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 12:53:08.340 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****u85A","$type":"Token"},{"TokenType":"code","TokenValue":"****Y5-g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE26:00000009","TimeStamp":"2020-04-23T10:53:08.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 12:53:08.359 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI5_e1Bt6h1BFuK9ICKBQiJTKhRqMimWDijAm8otVA2lP_t1_k5QVEt2SKs1mzsoJ-OP2tbfYHW4mflMD--zo4gpTNA3VSUlkNYPcBcAuUKHixGEfO_r7c1zG-hE1a_gXWgsyO4nPEpzmrufHYBMwKqb7Khr0wGGcfsAbSsfoeuVnqUevyri66IzoXjc8kqk3UdVhTmT87gG6edMAfDWtQimcOXQQ3pp5Tri4ISOWKBmlxo7JMFuxcFAweOvnX3JYAAcmmonwsYjt6kJamDWRFn","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 12:53:08.372 +02:00 [DBG] Augmenting SignInContext
2020-04-23 12:53:08.374 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 12:53:08.665 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 12:53:08.689 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 12:53:08.711 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 12:53:08.720 +02:00 [DBG] Start authorize request
2020-04-23 12:53:08.723 +02:00 [DBG] User in authorize request: 1
2020-04-23 12:53:08.728 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 12:53:08.789 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:08.793 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:08.800 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 12:53:08.800 +02:00 [DBG] No PKCE used.
2020-04-23 12:53:08.812 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:08.826 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:08.842 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:08.854 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:08.862 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 12:53:08.868 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLvnzX81BfRD7PezfrtHp6p1DrzMLxQtil-uYqN0U_h3kM9-XQ5aAmPg5ZdHkEsgCjhBbXgx4eMEZkh0JHmEjEzx3sVIGKw3Q7dCYYUSZBr99pFQnwmfOrSqKwtpr5VTkoOZZIGZViQr5dkrMYW2e06H30yyTHmR9EYLJgrJ8EH5uNCN5zmqpDmJSRrR2bIF2PaSkeVUnjYQmRwafjdVs-dof6ReC9cqxRIVO53Czn5wm1sg9ITpoOjlda2r4yqtiu3QjKrTD37ntbx3kNVOswW","UiLocales":null,"Nonce":"637232359886419230.MDAzNWE1YzYtNGUzYi00YTBlLTk1NTctOTc3ZDc2MWFkYmFkZWJmODgyMzItNWFkYS00MjQ3LTliY2MtZmM3YmY4NGZjZDM0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3FHo3NW6AmBy0FSvy4i2zQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232359886419230.MDAzNWE1YzYtNGUzYi00YTBlLTk1NTctOTc3ZDc2MWFkYmFkZWJmODgyMzItNWFkYS00MjQ3LTliY2MtZmM3YmY4NGZjZDM0","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLvnzX81BfRD7PezfrtHp6p1DrzMLxQtil-uYqN0U_h3kM9-XQ5aAmPg5ZdHkEsgCjhBbXgx4eMEZkh0JHmEjEzx3sVIGKw3Q7dCYYUSZBr99pFQnwmfOrSqKwtpr5VTkoOZZIGZViQr5dkrMYW2e06H30yyTHmR9EYLJgrJ8EH5uNCN5zmqpDmJSRrR2bIF2PaSkeVUnjYQmRwafjdVs-dof6ReC9cqxRIVO53Czn5wm1sg9ITpoOjlda2r4yqtiu3QjKrTD37ntbx3kNVOswW","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 12:53:08.953 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 12:53:08.955 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 12:53:08.964 +02:00 [DBG] JjNcs2gC52oJrpmseppR3g6WHRI4gJWxOzHXLRHmhWA= not found in database
2020-04-23 12:53:08.973 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 12:53:08.974 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 12:53:08.997 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****B--g","$type":"Token"},{"TokenType":"code","TokenValue":"****Gn7Y","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE26:0000000A","TimeStamp":"2020-04-23T10:53:08.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 12:53:09.016 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtLvnzX81BfRD7PezfrtHp6p1DrzMLxQtil-uYqN0U_h3kM9-XQ5aAmPg5ZdHkEsgCjhBbXgx4eMEZkh0JHmEjEzx3sVIGKw3Q7dCYYUSZBr99pFQnwmfOrSqKwtpr5VTkoOZZIGZViQr5dkrMYW2e06H30yyTHmR9EYLJgrJ8EH5uNCN5zmqpDmJSRrR2bIF2PaSkeVUnjYQmRwafjdVs-dof6ReC9cqxRIVO53Czn5wm1sg9ITpoOjlda2r4yqtiu3QjKrTD37ntbx3kNVOswW","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 12:53:09.442 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-23 12:53:09.460 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-23 12:53:09.471 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-23 12:53:09.475 +02:00 [DBG] Start token request.
2020-04-23 12:53:09.477 +02:00 [DBG] Start client validation
2020-04-23 12:53:09.480 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-23 12:53:09.482 +02:00 [DBG] Start parsing for secret in post body
2020-04-23 12:53:09.485 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-23 12:53:09.486 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-23 12:53:09.551 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:09.555 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:09.560 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-23 12:53:09.561 +02:00 [DBG] Client validation success
2020-04-23 12:53:09.563 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV7E310GE25:00000003","TimeStamp":"2020-04-23T10:53:09.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-23 12:53:09.575 +02:00 [DBG] Start token request validation
2020-04-23 12:53:09.578 +02:00 [DBG] Start validation of authorization code token request
2020-04-23 12:53:09.590 +02:00 [DBG] JjNcs2gC52oJrpmseppR3g6WHRI4gJWxOzHXLRHmhWA= found in database: true
2020-04-23 12:53:09.615 +02:00 [DBG] removing JjNcs2gC52oJrpmseppR3g6WHRI4gJWxOzHXLRHmhWA= persisted grant from database
2020-04-23 12:53:09.637 +02:00 [DBG] Validation of authorization code token request success
2020-04-23 12:53:09.638 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"rsWVSwPTPXLhx6JhrddG0RZa7yAGnUNuNLwkzU5Gn7Y","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"rsWVSwPTPXLhx6JhrddG0RZa7yAGnUNuNLwkzU5Gn7Y","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-23 12:53:09.691 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:09.700 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:09.719 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:09.741 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:09.751 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-23 12:53:09.752 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-23 12:53:09.784 +02:00 [DBG] Creating refresh token
2020-04-23 12:53:09.785 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-23 12:53:09.808 +02:00 [DBG] fXSrYBjktJqSFTqCx4RYXyQJMTRh9SmLdOkhx99Xewc= not found in database
2020-04-23 12:53:09.866 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:09.869 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:09.886 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:09.909 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 12:53:09.936 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 12:53:09.967 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Zcrg","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****nydg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****jEDw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE25:00000003","TimeStamp":"2020-04-23T10:53:09.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 12:53:09.996 +02:00 [DBG] Token request success.
2020-04-23 12:53:10.196 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-23 12:53:10.203 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-23 12:53:10.206 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-23 12:53:10.209 +02:00 [DBG] Start userinfo request
2020-04-23 12:53:10.212 +02:00 [DBG] Bearer token found in header
2020-04-23 12:53:10.285 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:10.292 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:10.344 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 12:53:10.348 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 12:53:10.362 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 12:53:10.365 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587639189,"exp":1587725589,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587639187,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 12:53:10.389 +02:00 [DBG] Creating userinfo response
2020-04-23 12:53:10.392 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:53:10.397 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:53:10.507 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:10.514 +02:00 [DBG] Requested claim types: preferred_username admin name
2020-04-23 12:53:10.516 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 12:53:10.540 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 12:53:10.574 +02:00 [INF] Profile service returned the following claim types: name preferred_username admin preferred_username
2020-04-23 12:53:10.579 +02:00 [DBG] End userinfo request
2020-04-23 13:19:12.827 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 13:19:12.848 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 13:19:12.852 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 13:19:12.859 +02:00 [DBG] Start discovery request
2020-04-23 13:19:13.176 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 13:19:14.265 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 13:19:14.270 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 13:19:14.275 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 13:19:14.279 +02:00 [DBG] Start key discovery request
2020-04-23 13:19:14.485 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-23 13:19:14.490 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-23 13:19:14.493 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-23 13:19:14.495 +02:00 [DBG] Processing signout request for 1
2020-04-23 13:19:14.496 +02:00 [DBG] Start end session request validation
2020-04-23 13:19:14.501 +02:00 [DBG] Start identity token validation
2020-04-23 13:19:14.577 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:14.580 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:14.584 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-23 13:19:14.608 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 13:19:14.612 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587639189,"exp":1587725589,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637232359886419230.MDAzNWE1YzYtNGUzYi00YTBlLTk1NTctOTc3ZDc2MWFkYmFkZWJmODgyMzItNWFkYS00MjQ3LTliY2MtZmM3YmY4NGZjZDM0","iat":1587639189,"at_hash":"MU0ooLVW0EDKUo2jJdKJ0w","s_hash":"WR0MeOCNlQ9UdFoDPW65OQ","sid":"3FHo3NW6AmBy0FSvy4i2zQ","sub":"1","auth_time":1587639187,"idp":"local","name":"+265999201886","preferred_username":["Noble Hara","+265999201886"],"admin":"admin","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 13:19:14.632 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKpbhYP5fS_PvmLOZO2oiEPZvGmbRXVlpwx-5cFKVmYX-wXa60ZjUy4lBj-AvT51MJBQWluMm3rsoqaya5j59RPawhjbPyghWxm3cW1S6bA4bQd9QC5-RfBBWW3J-gvLMYmbkXrzscxT4JLBUI-OWPH","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKpbhYP5fS_PvmLOZO2oiEPZvGmbRXVlpwx-5cFKVmYX-wXa60ZjUy4lBj-AvT51MJBQWluMm3rsoqaya5j59RPawhjbPyghWxm3cW1S6bA4bQd9QC5-RfBBWW3J-gvLMYmbkXrzscxT4JLBUI-OWPH","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-23 13:19:14.656 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-23 13:19:14.774 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-23 13:19:14.777 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-23 13:19:14.781 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-23 13:19:14.784 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV7E310GE28:00000002","TimeStamp":"2020-04-23T11:19:14.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-23 13:19:22.749 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 13:19:22.756 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 13:19:22.759 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 13:19:22.766 +02:00 [DBG] Start authorize request
2020-04-23 13:19:22.770 +02:00 [DBG] No user present in authorize request
2020-04-23 13:19:22.779 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 13:19:22.871 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:22.875 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:22.879 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 13:19:22.880 +02:00 [DBG] No PKCE used.
2020-04-23 13:19:22.893 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:22.908 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:22.931 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:22.951 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:22.963 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 13:19:22.966 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKZxkp8TLcPQDwlFnQpAcvFblAPwllAX-HV2R1qSFrFHFKVpeUo2DfQL8qKvgOIUYUAdXkzD7j-7cKh9em6dnyLImUm58iKCyrOMNLu4VGjnAbRVILyBFLLKN6O32briA1v9ZlOEYrtCsnOqRIpf0XOHxm6Z-Kj2XWwdTNHGy-6YMy6pUePPsVRD1Cqk7uFeshht-frPTtLztmmVUeeiqxOj_jIwmIEfKQzOwUv1Bml0wiHlc2PAqiUQJtHfuMBAsiKjcpfuIZ2g_F8xPPBZBsr","UiLocales":null,"Nonce":"637232375627011519.MGRmYmJlM2QtNmFlNi00OGY4LWE3MmQtMzVhMGI5YTE1NWEzNmIxYjFjNGQtY2FjMy00NjIzLWFiY2YtMDAzNGI5ODljM2Nk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232375627011519.MGRmYmJlM2QtNmFlNi00OGY4LWE3MmQtMzVhMGI5YTE1NWEzNmIxYjFjNGQtY2FjMy00NjIzLWFiY2YtMDAzNGI5ODljM2Nk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKZxkp8TLcPQDwlFnQpAcvFblAPwllAX-HV2R1qSFrFHFKVpeUo2DfQL8qKvgOIUYUAdXkzD7j-7cKh9em6dnyLImUm58iKCyrOMNLu4VGjnAbRVILyBFLLKN6O32briA1v9ZlOEYrtCsnOqRIpf0XOHxm6Z-Kj2XWwdTNHGy-6YMy6pUePPsVRD1Cqk7uFeshht-frPTtLztmmVUeeiqxOj_jIwmIEfKQzOwUv1Bml0wiHlc2PAqiUQJtHfuMBAsiKjcpfuIZ2g_F8xPPBZBsr","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 13:19:23.039 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 13:19:23.155 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 13:19:23.278 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:23.293 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:23.299 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 13:19:23.304 +02:00 [DBG] No PKCE used.
2020-04-23 13:19:23.329 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:23.345 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:23.374 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:23.404 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:23.423 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 13:19:23.544 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:23.554 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:48.129 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 13:19:48.222 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 13:19:48.425 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:48.438 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:48.448 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 13:19:48.452 +02:00 [DBG] No PKCE used.
2020-04-23 13:19:48.465 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:48.505 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:48.598 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:48.638 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:48.649 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 13:19:48.720 +02:00 [DBG] Augmenting SignInContext
2020-04-23 13:19:48.722 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 13:19:48.725 +02:00 [DBG] Adding auth_time claim with value: 1587640788
2020-04-23 13:19:48.733 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 13:19:48.741 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7E310GE29:00000003","TimeStamp":"2020-04-23T11:19:48.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 13:19:48.796 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-23 13:19:48.816 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-23 13:19:48.823 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-23 13:19:48.829 +02:00 [DBG] Start authorize callback request
2020-04-23 13:19:48.831 +02:00 [DBG] User in authorize request: 1
2020-04-23 13:19:48.837 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 13:19:48.957 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:48.965 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:48.967 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 13:19:48.968 +02:00 [DBG] No PKCE used.
2020-04-23 13:19:48.973 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:48.988 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:49.003 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:49.018 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:49.032 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 13:19:49.036 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKZxkp8TLcPQDwlFnQpAcvFblAPwllAX-HV2R1qSFrFHFKVpeUo2DfQL8qKvgOIUYUAdXkzD7j-7cKh9em6dnyLImUm58iKCyrOMNLu4VGjnAbRVILyBFLLKN6O32briA1v9ZlOEYrtCsnOqRIpf0XOHxm6Z-Kj2XWwdTNHGy-6YMy6pUePPsVRD1Cqk7uFeshht-frPTtLztmmVUeeiqxOj_jIwmIEfKQzOwUv1Bml0wiHlc2PAqiUQJtHfuMBAsiKjcpfuIZ2g_F8xPPBZBsr","UiLocales":null,"Nonce":"637232375627011519.MGRmYmJlM2QtNmFlNi00OGY4LWE3MmQtMzVhMGI5YTE1NWEzNmIxYjFjNGQtY2FjMy00NjIzLWFiY2YtMDAzNGI5ODljM2Nk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"sQvHn4szEJpEq5rRjrdT1w","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232375627011519.MGRmYmJlM2QtNmFlNi00OGY4LWE3MmQtMzVhMGI5YTE1NWEzNmIxYjFjNGQtY2FjMy00NjIzLWFiY2YtMDAzNGI5ODljM2Nk","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKZxkp8TLcPQDwlFnQpAcvFblAPwllAX-HV2R1qSFrFHFKVpeUo2DfQL8qKvgOIUYUAdXkzD7j-7cKh9em6dnyLImUm58iKCyrOMNLu4VGjnAbRVILyBFLLKN6O32briA1v9ZlOEYrtCsnOqRIpf0XOHxm6Z-Kj2XWwdTNHGy-6YMy6pUePPsVRD1Cqk7uFeshht-frPTtLztmmVUeeiqxOj_jIwmIEfKQzOwUv1Bml0wiHlc2PAqiUQJtHfuMBAsiKjcpfuIZ2g_F8xPPBZBsr","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 13:19:49.105 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 13:19:49.112 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 13:19:49.199 +02:00 [DBG] 4nT7p+cutuatJ0SCAuNXpr14AhvquwQjLlKpw52yi70= not found in database
2020-04-23 13:19:49.254 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 13:19:49.255 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 13:19:49.319 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****4aPQ","$type":"Token"},{"TokenType":"code","TokenValue":"****wkOw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE29:00000004","TimeStamp":"2020-04-23T11:19:49.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 13:19:49.346 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtKZxkp8TLcPQDwlFnQpAcvFblAPwllAX-HV2R1qSFrFHFKVpeUo2DfQL8qKvgOIUYUAdXkzD7j-7cKh9em6dnyLImUm58iKCyrOMNLu4VGjnAbRVILyBFLLKN6O32briA1v9ZlOEYrtCsnOqRIpf0XOHxm6Z-Kj2XWwdTNHGy-6YMy6pUePPsVRD1Cqk7uFeshht-frPTtLztmmVUeeiqxOj_jIwmIEfKQzOwUv1Bml0wiHlc2PAqiUQJtHfuMBAsiKjcpfuIZ2g_F8xPPBZBsr","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 13:19:49.363 +02:00 [DBG] Augmenting SignInContext
2020-04-23 13:19:49.366 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 13:19:50.087 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-23 13:19:50.114 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-23 13:19:50.153 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-23 13:19:50.166 +02:00 [DBG] Start token request.
2020-04-23 13:19:50.176 +02:00 [DBG] Start client validation
2020-04-23 13:19:50.183 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-23 13:19:50.188 +02:00 [DBG] Start parsing for secret in post body
2020-04-23 13:19:50.196 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-23 13:19:50.199 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-23 13:19:50.422 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:50.436 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:50.438 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-23 13:19:50.449 +02:00 [DBG] Client validation success
2020-04-23 13:19:50.451 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV7E310GE27:00000003","TimeStamp":"2020-04-23T11:19:50.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-23 13:19:50.464 +02:00 [DBG] Start token request validation
2020-04-23 13:19:50.465 +02:00 [DBG] Start validation of authorization code token request
2020-04-23 13:19:50.471 +02:00 [DBG] 4nT7p+cutuatJ0SCAuNXpr14AhvquwQjLlKpw52yi70= found in database: true
2020-04-23 13:19:50.489 +02:00 [DBG] removing 4nT7p+cutuatJ0SCAuNXpr14AhvquwQjLlKpw52yi70= persisted grant from database
2020-04-23 13:19:50.533 +02:00 [DBG] Validation of authorization code token request success
2020-04-23 13:19:50.537 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"LCOHv1evs5MQ5el3K972dWdIy9sSZsqcGFLcDW7wkOw","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"LCOHv1evs5MQ5el3K972dWdIy9sSZsqcGFLcDW7wkOw","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-23 13:19:50.611 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:50.614 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:50.624 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:50.639 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:50.654 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-23 13:19:50.661 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-23 13:19:50.740 +02:00 [DBG] Creating refresh token
2020-04-23 13:19:50.750 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-23 13:19:50.777 +02:00 [DBG] wEoPeGmIChSjQqBiNsDbOBTPEGi5CnR5Tq5p6T0sAgE= not found in database
2020-04-23 13:19:50.859 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:50.862 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:50.881 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:50.901 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 13:19:50.922 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 13:19:50.950 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****_EoQ","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****YkFE","$type":"Token"},{"TokenType":"access_token","TokenValue":"****dSCQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7E310GE27:00000003","TimeStamp":"2020-04-23T11:19:50.0000000Z","ProcessId":40992,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 13:19:50.971 +02:00 [DBG] Token request success.
2020-04-23 13:19:51.208 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-23 13:19:51.219 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-23 13:19:51.222 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-23 13:19:51.231 +02:00 [DBG] Start userinfo request
2020-04-23 13:19:51.234 +02:00 [DBG] Bearer token found in header
2020-04-23 13:19:51.286 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:51.294 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:51.398 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:19:51.404 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:19:51.446 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 13:19:51.450 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587640790,"exp":1587727190,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587640788,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 13:19:51.474 +02:00 [DBG] Creating userinfo response
2020-04-23 13:19:51.476 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 13:19:51.480 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 13:19:51.496 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:51.498 +02:00 [DBG] Requested claim types: preferred_username admin name
2020-04-23 13:19:51.501 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 13:19:51.511 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 13:19:51.535 +02:00 [INF] Profile service returned the following claim types: name preferred_username admin preferred_username
2020-04-23 13:19:51.538 +02:00 [DBG] End userinfo request
2020-04-23 13:20:09.450 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 13:20:09.478 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 13:20:09.490 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 13:20:09.499 +02:00 [DBG] Start discovery request
2020-04-23 13:20:09.514 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 13:20:10.508 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 13:20:10.519 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 13:20:10.528 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 13:20:10.535 +02:00 [DBG] Start key discovery request
2020-04-23 13:26:10.985 +02:00 [INF] Removing 1 grants
2020-04-23 13:26:11.075 +02:00 [INF] Removing 0 device flow codes
2020-04-23 13:34:28.542 +02:00 [INF] Starting host...
2020-04-23 13:34:39.342 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 13:34:40.021 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 13:34:40.120 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 13:34:40.135 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 13:34:40.137 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 13:34:40.140 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 13:34:40.142 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 13:34:43.882 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 13:34:43.888 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 13:34:43.889 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 13:34:43.891 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 13:34:43.892 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 13:34:43.893 +02:00 [DBG] Error Url: /home/error
2020-04-23 13:34:43.894 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 13:42:18.591 +02:00 [WRN] User 18d852c8-8bb1-47de-9eb0-4463de3ca726 validation failed: InvalidUserName.
2020-04-23 13:44:03.738 +02:00 [INF] Starting host...
2020-04-23 13:44:13.607 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 13:44:14.125 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 13:44:14.128 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 13:44:14.129 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 13:44:14.132 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 13:44:14.133 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 13:44:14.134 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 13:44:18.683 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 13:44:18.688 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 13:44:18.690 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 13:44:18.691 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 13:44:18.693 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 13:44:18.694 +02:00 [DBG] Error Url: /home/error
2020-04-23 13:44:18.697 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 13:45:18.554 +02:00 [ERR] Failed executing DbCommand (61ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p21='?', @p6='?' (DbType = Int32), @p7='?', @p22='?', @p8='?' (DbType = Int32), @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = Boolean), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p6, "ConcurrencyStamp" = @p7, "DefaultPassword" = @p8, "Email" = @p9, "EmailConfirmed" = @p10, "LockoutEnabled" = @p11, "LockoutEnd" = @p12, "NormalizedEmail" = @p13, "NormalizedUserName" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "SecurityStamp" = @p18, "TwoFactorEnabled" = @p19, "UserName" = @p20
WHERE "Id" = @p21 AND "ConcurrencyStamp" = @p22;
2020-04-23 13:45:18.771 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Thandizo.IdentityServer.Data.Migrations.AspNetIdentity.ThandizoIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(4) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(4) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-04-23 13:45:20.105 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(4) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at Thandizo.IdentityServer.Services.UserManagementService.RegisterUserAsync(UserDTO userDTO) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Services\UserManagementService\UserManagementService.cs:line 58
   at Thandizo.IdentityServer.Controllers.Api.UsersController.RegisterUser(UserDTO userDTO) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Controllers\Api\UsersController.cs:line 22
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-23 13:47:34.063 +02:00 [INF] Starting host...
2020-04-23 13:47:42.874 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 13:47:43.455 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 13:47:43.468 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 13:47:43.471 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 13:47:43.472 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 13:47:43.475 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 13:47:43.484 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 13:47:47.611 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 13:47:47.635 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 13:47:47.645 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 13:47:47.653 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 13:47:47.670 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 13:47:47.684 +02:00 [DBG] Error Url: /home/error
2020-04-23 13:47:47.690 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 13:48:38.859 +02:00 [ERR] Failed executing DbCommand (89ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p21='?', @p6='?' (DbType = Int32), @p7='?', @p22='?', @p8='?' (DbType = Int32), @p9='?', @p10='?' (DbType = Boolean), @p11='?' (DbType = Boolean), @p12='?' (DbType = DateTimeOffset), @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = Boolean), @p20='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
INSERT INTO "AspNetUserClaims" ("ClaimType", "ClaimValue", "UserId")
VALUES (@p3, @p4, @p5)
RETURNING "Id";
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p6, "ConcurrencyStamp" = @p7, "DefaultPassword" = @p8, "Email" = @p9, "EmailConfirmed" = @p10, "LockoutEnabled" = @p11, "LockoutEnd" = @p12, "NormalizedEmail" = @p13, "NormalizedUserName" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "SecurityStamp" = @p18, "TwoFactorEnabled" = @p19, "UserName" = @p20
WHERE "Id" = @p21 AND "ConcurrencyStamp" = @p22;
2020-04-23 13:48:39.028 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Thandizo.IdentityServer.Data.Migrations.AspNetIdentity.ThandizoIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(5) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(5) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-04-23 13:48:40.385 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23505: duplicate key value violates unique constraint "PK_AspNetUserClaims"
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlConnector.<>c__DisplayClass160_0.<<DoReadMessage>g__ReadMessageLong|0>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)
   at Npgsql.NpgsqlCommand.ExecuteReaderAsync(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23505
    MessageText: duplicate key value violates unique constraint "PK_AspNetUserClaims"
    Detail: Key ("Id")=(5) already exists.
    SchemaName: public
    TableName: AspNetUserClaims
    ConstraintName: PK_AspNetUserClaims
    File: d:\pginstaller.auto\postgres.windows-x64\src\backend\access\nbtree\nbtinsert.c
    Line: 534
    Routine: _bt_check_unique
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at Thandizo.IdentityServer.Services.UserManagementService.RegisterUserAsync(UserDTO userDTO) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Services\UserManagementService\UserManagementService.cs:line 60
   at Thandizo.IdentityServer.Controllers.Api.UsersController.RegisterUser(UserDTO userDTO) in C:\Users\AD-SDM\source\repos\Thandizo.IdentityServer\Thandizo.IdentityServer\Controllers\Api\UsersController.cs:line 22
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events)
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-04-23 13:50:19.566 +02:00 [INF] aVBYi9LB
2020-04-23 13:51:56.059 +02:00 [INF] Starting host...
2020-04-23 13:52:05.014 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 13:52:05.505 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 13:52:05.508 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 13:52:05.509 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 13:52:05.510 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 13:52:05.518 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 13:52:05.519 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 13:52:09.979 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 13:52:09.995 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 13:52:09.999 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 13:52:10.003 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 13:52:10.004 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 13:52:10.006 +02:00 [DBG] Error Url: /home/error
2020-04-23 13:52:10.008 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 13:56:31.103 +02:00 [INF] NWXB*cni
2020-04-23 13:56:36.152 +02:00 [INF] SMS sent to System.String[]. Waiting for responses
2020-04-23 13:57:41.499 +02:00 [INF] A%$3JKJ^
2020-04-23 13:57:42.803 +02:00 [INF] SMS sent to System.String[]. Waiting for responses
2020-04-23 13:59:25.465 +02:00 [INF] SL^7r!*e
2020-04-23 13:59:27.181 +02:00 [INF] SMS sent to System.String[]. Waiting for responses
2020-04-23 13:59:47.900 +02:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-04-23 13:59:47.919 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-04-23 13:59:47.922 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-04-23 13:59:47.927 +02:00 [DBG] Start discovery request
2020-04-23 13:59:51.151 +02:00 [DBG] Found ["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] as all scopes in database
2020-04-23 13:59:51.926 +02:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-04-23 13:59:51.937 +02:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-04-23 13:59:51.941 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-04-23 13:59:51.950 +02:00 [DBG] Start key discovery request
2020-04-23 13:59:52.245 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-23 13:59:52.256 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-23 13:59:52.258 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-23 13:59:52.286 +02:00 [DBG] Processing signout request for 1
2020-04-23 13:59:52.300 +02:00 [DBG] Start end session request validation
2020-04-23 13:59:52.314 +02:00 [DBG] Start identity token validation
2020-04-23 13:59:53.807 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 13:59:53.840 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 13:59:53.853 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-23 13:59:54.120 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 13:59:54.158 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587640790,"exp":1587727190,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637232375627011519.MGRmYmJlM2QtNmFlNi00OGY4LWE3MmQtMzVhMGI5YTE1NWEzNmIxYjFjNGQtY2FjMy00NjIzLWFiY2YtMDAzNGI5ODljM2Nk","iat":1587640790,"at_hash":"sOx7emf_nYI8yu0NKGKhPQ","s_hash":"tElYadkA2U5GD2MYIJ4tQg","sid":"sQvHn4szEJpEq5rRjrdT1w","sub":"1","auth_time":1587640788,"idp":"local","name":"+265999201886","preferred_username":["Noble Hara","+265999201886"],"admin":"admin","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 13:59:54.252 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJXXRjdQ7dAoUzHVZ4FIbryegYrCkpnhWqwy81y_xraw3i-BkCmTx3RV-6RqgeNb-g-VE2pAtYMGwOq98nPq4eC8jPBzBBin_OnMFlahpKI3QI1o_pK7iBfJWnvO7SG2r1ysDTyo3B6qh_8S-alKNGf","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJXXRjdQ7dAoUzHVZ4FIbryegYrCkpnhWqwy81y_xraw3i-BkCmTx3RV-6RqgeNb-g-VE2pAtYMGwOq98nPq4eC8jPBzBBin_OnMFlahpKI3QI1o_pK7iBfJWnvO7SG2r1ysDTyo3B6qh_8S-alKNGf","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-23 13:59:54.268 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-23 13:59:54.516 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-23 13:59:54.532 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-23 13:59:54.559 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-23 13:59:54.725 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV7FIVPA4MI:00000002","TimeStamp":"2020-04-23T11:59:54.0000000Z","ProcessId":29660,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-23 14:00:03.058 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 14:00:03.080 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 14:00:03.083 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 14:00:03.089 +02:00 [DBG] Start authorize request
2020-04-23 14:00:03.099 +02:00 [DBG] No user present in authorize request
2020-04-23 14:00:03.107 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:00:03.286 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:00:03.305 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:00:03.345 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:00:03.348 +02:00 [DBG] No PKCE used.
2020-04-23 14:00:03.559 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:00:03.734 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:00:03.803 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:00:03.835 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:00:03.869 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:00:03.907 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJ-Mno-4mnrc3a_nbsdk1z3YC_HogkWzmiOuUu1xRSNqUbqE593-qV6H4BvNsgjduSrDLe4cDJj8ZO2OWQk62fbmzajQkCxh1TfBUD_IhUWN7PqCZ_O8BbgXFKw5zPTJWjHfYHcxSmYStd4JM40MwSLZf1Q121QxcwbasiRM7Ha7c44DD_6T3GMoYgywx-Xt_aZu2p7y4AumLI7xujKs3jeQq_YPyDm3REAfjm6sC7W5Onnl907TdPL3A7LVyvirIXUHpsc0PQvKYyrle4tlsUt","UiLocales":null,"Nonce":"637232400030302555.YzY2MTE4OTMtNzE0MS00Y2VmLTgyNDgtNDk0NGI0ZWEzNDc2ZjcyOTI5NTItNWU4OS00YWI3LTk2MGItMTE0Y2RlYzM2NGYw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232400030302555.YzY2MTE4OTMtNzE0MS00Y2VmLTgyNDgtNDk0NGI0ZWEzNDc2ZjcyOTI5NTItNWU4OS00YWI3LTk2MGItMTE0Y2RlYzM2NGYw","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJ-Mno-4mnrc3a_nbsdk1z3YC_HogkWzmiOuUu1xRSNqUbqE593-qV6H4BvNsgjduSrDLe4cDJj8ZO2OWQk62fbmzajQkCxh1TfBUD_IhUWN7PqCZ_O8BbgXFKw5zPTJWjHfYHcxSmYStd4JM40MwSLZf1Q121QxcwbasiRM7Ha7c44DD_6T3GMoYgywx-Xt_aZu2p7y4AumLI7xujKs3jeQq_YPyDm3REAfjm6sC7W5Onnl907TdPL3A7LVyvirIXUHpsc0PQvKYyrle4tlsUt","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 14:00:03.970 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 14:00:04.052 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:00:04.216 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:00:04.221 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:00:04.222 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:00:04.223 +02:00 [DBG] No PKCE used.
2020-04-23 14:00:04.239 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:00:04.258 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:00:04.289 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:00:04.312 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:00:04.319 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:00:04.398 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:00:04.401 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:01:28.115 +02:00 [INF] Starting host...
2020-04-23 14:01:36.432 +02:00 [INF] Starting IdentityServer4 version 3.1.2.0
2020-04-23 14:01:36.950 +02:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-04-23 14:01:36.952 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-04-23 14:01:36.953 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-04-23 14:01:36.954 +02:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-04-23 14:01:36.954 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-04-23 14:01:36.955 +02:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-04-23 14:01:47.956 +02:00 [DBG] Login Url: /Account/Login
2020-04-23 14:01:47.962 +02:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-04-23 14:01:47.962 +02:00 [DBG] Logout Url: /Account/Logout
2020-04-23 14:01:47.967 +02:00 [DBG] ConsentUrl Url: /consent
2020-04-23 14:01:47.968 +02:00 [DBG] Consent Return Url Parameter: returnUrl
2020-04-23 14:01:47.968 +02:00 [DBG] Error Url: /home/error
2020-04-23 14:01:47.969 +02:00 [DBG] Error Id Parameter: errorId
2020-04-23 14:02:27.924 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 14:02:28.492 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:02:36.101 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:02:36.139 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:02:36.178 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:02:36.181 +02:00 [DBG] No PKCE used.
2020-04-23 14:02:36.486 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:02:36.968 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:02:37.049 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:02:37.062 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:02:37.092 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:02:37.615 +02:00 [WRN] Invalid password for user 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657.
2020-04-23 14:02:37.626 +02:00 [WRN] User 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657 failed to provide the correct password.
2020-04-23 14:02:38.151 +02:00 [INF] {"Username":"+265883404325","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLV7FOA2LFN7:00000002","TimeStamp":"2020-04-23T12:02:38.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2020-04-23 14:02:38.172 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:02:38.251 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:02:38.254 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:02:38.256 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:02:38.268 +02:00 [DBG] No PKCE used.
2020-04-23 14:02:38.309 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:02:38.329 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:02:38.352 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:02:38.368 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:02:38.379 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:02:38.547 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:02:38.566 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:23.601 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 14:03:23.637 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:03:23.911 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:23.919 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:23.933 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:03:23.934 +02:00 [DBG] No PKCE used.
2020-04-23 14:03:24.018 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:24.085 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:24.112 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:24.144 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:24.153 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:03:24.189 +02:00 [WRN] Invalid password for user 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657.
2020-04-23 14:03:24.203 +02:00 [WRN] User 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657 failed to provide the correct password.
2020-04-23 14:03:24.255 +02:00 [INF] {"Username":"+265883404325","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLV7FOA2LFN9:00000001","TimeStamp":"2020-04-23T12:03:24.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2020-04-23 14:03:24.264 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:03:24.364 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:24.366 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:24.373 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:03:24.377 +02:00 [DBG] No PKCE used.
2020-04-23 14:03:24.384 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:24.417 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:24.455 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:24.484 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:24.495 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:03:24.597 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:24.602 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:39.228 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 14:03:39.315 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:03:39.503 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:39.512 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:39.515 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:03:39.516 +02:00 [DBG] No PKCE used.
2020-04-23 14:03:39.548 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:39.580 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:39.601 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:39.619 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:39.629 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:03:39.676 +02:00 [WRN] Invalid password for user 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657.
2020-04-23 14:03:39.677 +02:00 [WRN] User 612a19d6-df9e-41a5-8a1d-d8c9fd5c2657 failed to provide the correct password.
2020-04-23 14:03:39.704 +02:00 [INF] {"Username":"+265883404325","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLV7FOA2LFN9:00000002","TimeStamp":"2020-04-23T12:03:39.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2020-04-23 14:03:39.710 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:03:39.776 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:39.783 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:03:39.785 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:03:39.787 +02:00 [DBG] No PKCE used.
2020-04-23 14:03:39.829 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:39.853 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:39.897 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:03:39.964 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:03:40.086 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:03:40.300 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:03:40.303 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:11:56.050 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 14:11:56.161 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 14:11:56.240 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 14:11:56.333 +02:00 [DBG] Start authorize request
2020-04-23 14:11:56.398 +02:00 [DBG] No user present in authorize request
2020-04-23 14:11:56.448 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:00.406 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:00.440 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:00.480 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:00.520 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:00.645 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:00.755 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:00.921 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:01.097 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:01.115 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:01.147 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI0ZeLT0CMTVoO9HtnQ0mSEvENJ-cmh_JIH7IvvFIIMev0X-L8QCFGfAqsQBvsCQhNGb8CPyF69v2WXUZLcy_6ozrrCVGyq41L3DuSn2Djb5OldTtMDZuoxAZUicOCOVi4RUeG3Spv2RSHMX0rzGZ5ldUQHpdibGsi1-IggoqL1deZPeE3JXH0CAJhA9un7xisKnvd9xsz8TL-V-3Q-kVoCmUUIQO1ufuevkQqreHDd1X7g_jchw4tU-rkTB7IBEQYlXTwuikDF8mfyEexNrdND","UiLocales":null,"Nonce":"637232407157484836.ODY2NDE2YmItM2ZiMC00NDI1LWIzZjUtOGVlMmJjYTcwZWM0ZmI2NGRhZDAtNzg2Yi00ZmU5LTk2NDMtZDZmM2JjYzhkZGU0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232407157484836.ODY2NDE2YmItM2ZiMC00NDI1LWIzZjUtOGVlMmJjYTcwZWM0ZmI2NGRhZDAtNzg2Yi00ZmU5LTk2NDMtZDZmM2JjYzhkZGU0","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI0ZeLT0CMTVoO9HtnQ0mSEvENJ-cmh_JIH7IvvFIIMev0X-L8QCFGfAqsQBvsCQhNGb8CPyF69v2WXUZLcy_6ozrrCVGyq41L3DuSn2Djb5OldTtMDZuoxAZUicOCOVi4RUeG3Spv2RSHMX0rzGZ5ldUQHpdibGsi1-IggoqL1deZPeE3JXH0CAJhA9un7xisKnvd9xsz8TL-V-3Q-kVoCmUUIQO1ufuevkQqreHDd1X7g_jchw4tU-rkTB7IBEQYlXTwuikDF8mfyEexNrdND","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 14:12:01.226 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 14:12:01.296 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:03.242 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:03.328 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:03.365 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:03.375 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:03.462 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:03.566 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:03.641 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:03.689 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:03.721 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:04.222 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:04.254 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:15.458 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 14:12:15.555 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:16.453 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:16.487 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:16.493 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:16.497 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:16.530 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:16.619 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:16.690 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:16.717 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:16.753 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:17.675 +02:00 [DBG] Augmenting SignInContext
2020-04-23 14:12:17.685 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 14:12:17.689 +02:00 [DBG] Adding auth_time claim with value: 1587643937
2020-04-23 14:12:17.739 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 14:12:17.799 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7FOA2LFNA:00000003","TimeStamp":"2020-04-23T12:12:17.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 14:12:18.644 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-23 14:12:18.704 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-23 14:12:18.717 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-23 14:12:18.749 +02:00 [DBG] Start authorize callback request
2020-04-23 14:12:18.796 +02:00 [DBG] User in authorize request: 1
2020-04-23 14:12:18.822 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:19.342 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:19.359 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:19.375 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:19.376 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:19.645 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:20.924 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:21.217 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:21.387 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:21.569 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:21.656 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI0ZeLT0CMTVoO9HtnQ0mSEvENJ-cmh_JIH7IvvFIIMev0X-L8QCFGfAqsQBvsCQhNGb8CPyF69v2WXUZLcy_6ozrrCVGyq41L3DuSn2Djb5OldTtMDZuoxAZUicOCOVi4RUeG3Spv2RSHMX0rzGZ5ldUQHpdibGsi1-IggoqL1deZPeE3JXH0CAJhA9un7xisKnvd9xsz8TL-V-3Q-kVoCmUUIQO1ufuevkQqreHDd1X7g_jchw4tU-rkTB7IBEQYlXTwuikDF8mfyEexNrdND","UiLocales":null,"Nonce":"637232407157484836.ODY2NDE2YmItM2ZiMC00NDI1LWIzZjUtOGVlMmJjYTcwZWM0ZmI2NGRhZDAtNzg2Yi00ZmU5LTk2NDMtZDZmM2JjYzhkZGU0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"2aRFxrWvOyhLwkVxhTz9CQ","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232407157484836.ODY2NDE2YmItM2ZiMC00NDI1LWIzZjUtOGVlMmJjYTcwZWM0ZmI2NGRhZDAtNzg2Yi00ZmU5LTk2NDMtZDZmM2JjYzhkZGU0","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI0ZeLT0CMTVoO9HtnQ0mSEvENJ-cmh_JIH7IvvFIIMev0X-L8QCFGfAqsQBvsCQhNGb8CPyF69v2WXUZLcy_6ozrrCVGyq41L3DuSn2Djb5OldTtMDZuoxAZUicOCOVi4RUeG3Spv2RSHMX0rzGZ5ldUQHpdibGsi1-IggoqL1deZPeE3JXH0CAJhA9un7xisKnvd9xsz8TL-V-3Q-kVoCmUUIQO1ufuevkQqreHDd1X7g_jchw4tU-rkTB7IBEQYlXTwuikDF8mfyEexNrdND","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 14:12:22.322 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 14:12:22.337 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 14:12:23.328 +02:00 [DBG] tY+SAbkeIj+dBHTY+Oq3PDIjyby3dRLAdUDif1nMaZk= not found in database
2020-04-23 14:12:23.657 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 14:12:23.676 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 14:12:24.371 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****YKFA","$type":"Token"},{"TokenType":"code","TokenValue":"****GGbs","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7FOA2LFNA:00000004","TimeStamp":"2020-04-23T12:12:24.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 14:12:24.423 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtI0ZeLT0CMTVoO9HtnQ0mSEvENJ-cmh_JIH7IvvFIIMev0X-L8QCFGfAqsQBvsCQhNGb8CPyF69v2WXUZLcy_6ozrrCVGyq41L3DuSn2Djb5OldTtMDZuoxAZUicOCOVi4RUeG3Spv2RSHMX0rzGZ5ldUQHpdibGsi1-IggoqL1deZPeE3JXH0CAJhA9un7xisKnvd9xsz8TL-V-3Q-kVoCmUUIQO1ufuevkQqreHDd1X7g_jchw4tU-rkTB7IBEQYlXTwuikDF8mfyEexNrdND","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 14:12:24.555 +02:00 [DBG] Augmenting SignInContext
2020-04-23 14:12:24.571 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 14:12:25.786 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-23 14:12:25.807 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-23 14:12:25.815 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-23 14:12:25.834 +02:00 [DBG] Start token request.
2020-04-23 14:12:25.853 +02:00 [DBG] Start client validation
2020-04-23 14:12:25.874 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-23 14:12:25.889 +02:00 [DBG] Start parsing for secret in post body
2020-04-23 14:12:25.898 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-23 14:12:25.900 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-23 14:12:26.372 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:26.377 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:26.451 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-23 14:12:26.456 +02:00 [DBG] Client validation success
2020-04-23 14:12:26.475 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV7FOA2LFNB:00000001","TimeStamp":"2020-04-23T12:12:26.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-23 14:12:26.517 +02:00 [DBG] Start token request validation
2020-04-23 14:12:26.538 +02:00 [DBG] Start validation of authorization code token request
2020-04-23 14:12:26.601 +02:00 [DBG] tY+SAbkeIj+dBHTY+Oq3PDIjyby3dRLAdUDif1nMaZk= found in database: true
2020-04-23 14:12:26.780 +02:00 [DBG] removing tY+SAbkeIj+dBHTY+Oq3PDIjyby3dRLAdUDif1nMaZk= persisted grant from database
2020-04-23 14:12:27.039 +02:00 [DBG] Validation of authorization code token request success
2020-04-23 14:12:27.068 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"g-9_zlIIOC1yUK4RhG2nNDCIzG3Ae1YZKZ9Ya8EGGbs","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"g-9_zlIIOC1yUK4RhG2nNDCIzG3Ae1YZKZ9Ya8EGGbs","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-23 14:12:27.502 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:27.506 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:27.554 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:27.584 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:27.634 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-23 14:12:27.637 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-23 14:12:27.687 +02:00 [DBG] Creating refresh token
2020-04-23 14:12:27.688 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-23 14:12:27.752 +02:00 [DBG] vWMRCiabBHwbGtWd4isFXAa/DuBjcCxtYYP7/0G0KgQ= not found in database
2020-04-23 14:12:27.930 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:27.936 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:27.959 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:28.009 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:28.024 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 14:12:28.227 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****Og7Q","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****fApA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****NOSg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7FOA2LFNB:00000001","TimeStamp":"2020-04-23T12:12:28.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 14:12:28.281 +02:00 [DBG] Token request success.
2020-04-23 14:12:28.745 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-23 14:12:28.752 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-23 14:12:28.765 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-23 14:12:28.782 +02:00 [DBG] Start userinfo request
2020-04-23 14:12:28.796 +02:00 [DBG] Bearer token found in header
2020-04-23 14:12:29.617 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:29.652 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:29.975 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:29.989 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:30.097 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 14:12:30.118 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587643947,"exp":1587730347,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587643937,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 14:12:30.175 +02:00 [DBG] Creating userinfo response
2020-04-23 14:12:30.183 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:30.196 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:30.206 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:30.236 +02:00 [DBG] Requested claim types: preferred_username admin name
2020-04-23 14:12:30.246 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:30.283 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:30.344 +02:00 [INF] Profile service returned the following claim types: name preferred_username admin preferred_username
2020-04-23 14:12:30.350 +02:00 [DBG] End userinfo request
2020-04-23 14:12:36.116 +02:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2020-04-23 14:12:36.149 +02:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2020-04-23 14:12:36.160 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2020-04-23 14:12:36.170 +02:00 [DBG] Processing signout request for 1
2020-04-23 14:12:36.177 +02:00 [DBG] Start end session request validation
2020-04-23 14:12:36.183 +02:00 [DBG] Start identity token validation
2020-04-23 14:12:36.751 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:36.766 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:36.783 +02:00 [DBG] Client found: thandizo_web_client / Thandizo Web Client
2020-04-23 14:12:36.840 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 14:12:36.869 +02:00 [DBG] Token validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587643948,"exp":1587730348,"iss":"http://localhost:5004","aud":"thandizo_web_client","nonce":"637232407157484836.ODY2NDE2YmItM2ZiMC00NDI1LWIzZjUtOGVlMmJjYTcwZWM0ZmI2NGRhZDAtNzg2Yi00ZmU5LTk2NDMtZDZmM2JjYzhkZGU0","iat":1587643948,"at_hash":"k_AlC8C-IWlJpIthLMixug","s_hash":"9GApROUUNlqwGvIxejBfLg","sid":"2aRFxrWvOyhLwkVxhTz9CQ","sub":"1","auth_time":1587643937,"idp":"local","name":"+265999201886","preferred_username":["Noble Hara","+265999201886"],"admin":"admin","amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 14:12:36.911 +02:00 [INF] End session request validation success
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","SubjectId":"1","PostLogOutUri":"https://localhost:44348/signout-callback-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJ4TMXYoy0YmrKgtqktIceT11FC8HHLnEaGTSrE_dQcHlpRT3_pvlPznu7kjeem5oD9g_zKTTUGw7Xj1HeRHVCIqQnN9M3Z5Wwv_pFmmOnCqFmgmeIdE5KnJBYrWJVUKrufH355lYWGgHPzVUNzYNG_","Raw":{"post_logout_redirect_uri":"https://localhost:44348/signout-callback-oidc","id_token_hint":"***REDACTED***","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtJ4TMXYoy0YmrKgtqktIceT11FC8HHLnEaGTSrE_dQcHlpRT3_pvlPznu7kjeem5oD9g_zKTTUGw7Xj1HeRHVCIqQnN9M3Z5Wwv_pFmmOnCqFmgmeIdE5KnJBYrWJVUKrufH355lYWGgHPzVUNzYNG_","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"EndSessionRequestValidationLog"}
2020-04-23 14:12:36.953 +02:00 [DBG] Success validating end session request from thandizo_web_client
2020-04-23 14:12:37.220 +02:00 [INF] AuthenticationScheme: Identity.Application signed out.
2020-04-23 14:12:37.253 +02:00 [INF] AuthenticationScheme: Identity.External signed out.
2020-04-23 14:12:37.271 +02:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2020-04-23 14:12:37.293 +02:00 [INF] {"SubjectId":"1","DisplayName":"+265999201886","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLV7FOA2LFNA:00000006","TimeStamp":"2020-04-23T12:12:37.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2020-04-23 14:12:37.394 +02:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-04-23 14:12:37.410 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-04-23 14:12:37.420 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-04-23 14:12:37.427 +02:00 [DBG] Start authorize request
2020-04-23 14:12:37.441 +02:00 [DBG] No user present in authorize request
2020-04-23 14:12:37.443 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:37.669 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:37.678 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:37.687 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:37.691 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:37.712 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:37.752 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:37.803 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:37.832 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:37.844 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:37.848 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIxF0wRT9S6aBLEPGGmxPBYR10jxSpzvWKncq-Ah3FKutl8EI86OIXFS8jN4ajeW9HK8dF0_fDWhfQBE0k0mGIKXvnB4j97g2EWQ_Y7aUjLy8CccnSjm8soGQuYZa2THQZm2U-F_-E55gbWVJJ4h5i_guUbbPwoCJ0iOfGB6gcQpK6B9_uDZuGFP5KjUDXMPfU_k2HYHoLO5RCLdia_9jSSFaNS3oNW4mA_KbrrRX02CkTZlDKDXmG39nx6rDpNPAKQYk3lAPIYJdUggIGaB6ZF","UiLocales":null,"Nonce":"637232407573690223.YWIwMGU2ZGYtMmMwNC00OTE1LTkxMzQtNDYxMDM2NzJjY2QwYjk3MGU4YWMtN2JhNS00NGU4LTlhZGItMjc1NzMyYzM3ZmM2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232407573690223.YWIwMGU2ZGYtMmMwNC00OTE1LTkxMzQtNDYxMDM2NzJjY2QwYjk3MGU4YWMtN2JhNS00NGU4LTlhZGItMjc1NzMyYzM3ZmM2","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIxF0wRT9S6aBLEPGGmxPBYR10jxSpzvWKncq-Ah3FKutl8EI86OIXFS8jN4ajeW9HK8dF0_fDWhfQBE0k0mGIKXvnB4j97g2EWQ_Y7aUjLy8CccnSjm8soGQuYZa2THQZm2U-F_-E55gbWVJJ4h5i_guUbbPwoCJ0iOfGB6gcQpK6B9_uDZuGFP5KjUDXMPfU_k2HYHoLO5RCLdia_9jSSFaNS3oNW4mA_KbrrRX02CkTZlDKDXmG39nx6rDpNPAKQYk3lAPIYJdUggIGaB6ZF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 14:12:37.895 +02:00 [INF] Showing login: User is not authenticated
2020-04-23 14:12:37.918 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:38.426 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:38.449 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:38.469 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:38.483 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:38.532 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:38.565 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:38.612 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:38.668 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:38.695 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:38.843 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:38.846 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:41.266 +02:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-04-23 14:12:41.285 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:41.513 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:41.567 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:41.596 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:41.607 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:41.676 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:41.849 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:41.961 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:42.027 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:42.125 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:42.390 +02:00 [DBG] Augmenting SignInContext
2020-04-23 14:12:42.392 +02:00 [DBG] Adding idp claim with value: local
2020-04-23 14:12:42.396 +02:00 [DBG] Adding auth_time claim with value: 1587643962
2020-04-23 14:12:42.406 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 14:12:42.424 +02:00 [INF] {"Username":"+265999201886","Provider":null,"ProviderUserId":null,"SubjectId":"1","DisplayName":"+265999201886","Endpoint":"UI","ClientId":null,"Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLV7FOA2LFNE:00000001","TimeStamp":"2020-04-23T12:12:42.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2020-04-23 14:12:42.545 +02:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-04-23 14:12:42.549 +02:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-04-23 14:12:42.560 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-04-23 14:12:42.564 +02:00 [DBG] Start authorize callback request
2020-04-23 14:12:42.567 +02:00 [DBG] User in authorize request: 1
2020-04-23 14:12:42.578 +02:00 [DBG] Start authorize request protocol validation
2020-04-23 14:12:42.858 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:42.863 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:42.866 +02:00 [DBG] Checking for PKCE parameters
2020-04-23 14:12:42.867 +02:00 [DBG] No PKCE used.
2020-04-23 14:12:42.926 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:42.968 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:43.017 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:43.080 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:43.113 +02:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-04-23 14:12:43.116 +02:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","AllowedRedirectUris":["http://localhost:44348/signin-oidc","https://localhost:44348/signin-oidc"],"SubjectId":"1","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIxF0wRT9S6aBLEPGGmxPBYR10jxSpzvWKncq-Ah3FKutl8EI86OIXFS8jN4ajeW9HK8dF0_fDWhfQBE0k0mGIKXvnB4j97g2EWQ_Y7aUjLy8CccnSjm8soGQuYZa2THQZm2U-F_-E55gbWVJJ4h5i_guUbbPwoCJ0iOfGB6gcQpK6B9_uDZuGFP5KjUDXMPfU_k2HYHoLO5RCLdia_9jSSFaNS3oNW4mA_KbrrRX02CkTZlDKDXmG39nx6rDpNPAKQYk3lAPIYJdUggIGaB6ZF","UiLocales":null,"Nonce":"637232407573690223.YWIwMGU2ZGYtMmMwNC00OTE1LTkxMzQtNDYxMDM2NzJjY2QwYjk3MGU4YWMtN2JhNS00NGU4LTlhZGItMjc1NzMyYzM3ZmM2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"xjSTvvv6mHxupA3mrZH59Q","Raw":{"client_id":"thandizo_web_client","redirect_uri":"https://localhost:44348/signin-oidc","response_type":"code id_token","scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","response_mode":"form_post","nonce":"637232407573690223.YWIwMGU2ZGYtMmMwNC00OTE1LTkxMzQtNDYxMDM2NzJjY2QwYjk3MGU4YWMtN2JhNS00NGU4LTlhZGItMjc1NzMyYzM3ZmM2","state":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIxF0wRT9S6aBLEPGGmxPBYR10jxSpzvWKncq-Ah3FKutl8EI86OIXFS8jN4ajeW9HK8dF0_fDWhfQBE0k0mGIKXvnB4j97g2EWQ_Y7aUjLy8CccnSjm8soGQuYZa2THQZm2U-F_-E55gbWVJJ4h5i_guUbbPwoCJ0iOfGB6gcQpK6B9_uDZuGFP5KjUDXMPfU_k2HYHoLO5RCLdia_9jSSFaNS3oNW4mA_KbrrRX02CkTZlDKDXmG39nx6rDpNPAKQYk3lAPIYJdUggIGaB6ZF","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.5.0.0"},"$type":"AuthorizeRequestValidationLog"}
2020-04-23 14:12:43.198 +02:00 [DBG] Client is configured to not require consent, no consent is required
2020-04-23 14:12:43.201 +02:00 [DBG] Creating Hybrid Flow response.
2020-04-23 14:12:43.219 +02:00 [DBG] FuityLB8CHx9CVcUF1VRQDON/Vw0R++g88m53szFtmo= not found in database
2020-04-23 14:12:43.248 +02:00 [DBG] Creating Implicit Flow response.
2020-04-23 14:12:43.259 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 14:12:43.285 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":"https://localhost:44348/signin-oidc","Endpoint":"Authorize","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****IEAg","$type":"Token"},{"TokenType":"code","TokenValue":"****7k4w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7FOA2LFNE:00000002","TimeStamp":"2020-04-23T12:12:43.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 14:12:43.341 +02:00 [DBG] Authorize endpoint response
{"SubjectId":"1","ClientId":"thandizo_web_client","RedirectUri":"https://localhost:44348/signin-oidc","State":"CfDJ8EfmiZB4UWZJpYcMxmwzRtIxF0wRT9S6aBLEPGGmxPBYR10jxSpzvWKncq-Ah3FKutl8EI86OIXFS8jN4ajeW9HK8dF0_fDWhfQBE0k0mGIKXvnB4j97g2EWQ_Y7aUjLy8CccnSjm8soGQuYZa2THQZm2U-F_-E55gbWVJJ4h5i_guUbbPwoCJ0iOfGB6gcQpK6B9_uDZuGFP5KjUDXMPfU_k2HYHoLO5RCLdia_9jSSFaNS3oNW4mA_KbrrRX02CkTZlDKDXmG39nx6rDpNPAKQYk3lAPIYJdUggIGaB6ZF","Scope":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-04-23 14:12:43.349 +02:00 [DBG] Augmenting SignInContext
2020-04-23 14:12:43.359 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2020-04-23 14:12:43.599 +02:00 [DBG] Request path /connect/token matched to endpoint type Token
2020-04-23 14:12:43.610 +02:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2020-04-23 14:12:43.611 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2020-04-23 14:12:43.612 +02:00 [DBG] Start token request.
2020-04-23 14:12:43.613 +02:00 [DBG] Start client validation
2020-04-23 14:12:43.613 +02:00 [DBG] Start parsing Basic Authentication secret
2020-04-23 14:12:43.614 +02:00 [DBG] Start parsing for secret in post body
2020-04-23 14:12:43.616 +02:00 [DBG] Parser found secret: PostBodySecretParser
2020-04-23 14:12:43.617 +02:00 [DBG] Secret id found: thandizo_web_client
2020-04-23 14:12:43.799 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:43.808 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:43.815 +02:00 [DBG] Secret validator success: HashedSharedSecretValidator
2020-04-23 14:12:43.817 +02:00 [DBG] Client validation success
2020-04-23 14:12:43.825 +02:00 [INF] {"ClientId":"thandizo_web_client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLV7FOA2LFNB:00000003","TimeStamp":"2020-04-23T12:12:43.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2020-04-23 14:12:43.844 +02:00 [DBG] Start token request validation
2020-04-23 14:12:43.846 +02:00 [DBG] Start validation of authorization code token request
2020-04-23 14:12:43.901 +02:00 [DBG] FuityLB8CHx9CVcUF1VRQDON/Vw0R++g88m53szFtmo= found in database: true
2020-04-23 14:12:43.926 +02:00 [DBG] removing FuityLB8CHx9CVcUF1VRQDON/Vw0R++g88m53szFtmo= persisted grant from database
2020-04-23 14:12:43.959 +02:00 [DBG] Validation of authorization code token request success
2020-04-23 14:12:43.960 +02:00 [INF] Token request validation success, {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"uIVz2NthQ9fx1jpHdpbA1uTslS2Q6XRNUN7eBOU7k4w","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"thandizo_web_client","client_secret":"***REDACTED***","code":"uIVz2NthQ9fx1jpHdpbA1uTslS2Q6XRNUN7eBOU7k4w","grant_type":"authorization_code","redirect_uri":"https://localhost:44348/signin-oidc"},"$type":"TokenRequestValidationLog"}
2020-04-23 14:12:44.171 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:44.175 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:44.191 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:44.209 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:44.217 +02:00 [DBG] Getting claims for access token for client: thandizo_web_client
2020-04-23 14:12:44.218 +02:00 [DBG] Getting claims for access token for subject: 1
2020-04-23 14:12:44.256 +02:00 [DBG] Creating refresh token
2020-04-23 14:12:44.263 +02:00 [DBG] Setting an absolute lifetime: 2592000
2020-04-23 14:12:44.276 +02:00 [DBG] TzFKxW5M/uSUsyHK4EHhUuXTofuayE3Uc8x9IHKVFSc= not found in database
2020-04-23 14:12:44.808 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:44.887 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:45.536 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:45.766 +02:00 [DBG] Found ["patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete"] API scopes in database
2020-04-23 14:12:45.937 +02:00 [DBG] Getting claims for identity token for subject: 1 and client: thandizo_web_client
2020-04-23 14:12:46.697 +02:00 [INF] {"ClientId":"thandizo_web_client","ClientName":"Thandizo Web Client","RedirectUri":null,"Endpoint":"Token","SubjectId":"1","Scopes":"openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****-ZBA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****VmLI","$type":"Token"},{"TokenType":"access_token","TokenValue":"****GtFA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLV7FOA2LFNB:00000003","TimeStamp":"2020-04-23T12:12:46.0000000Z","ProcessId":18864,"LocalIpAddress":"::1:5004","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2020-04-23 14:12:47.217 +02:00 [DBG] Token request success.
2020-04-23 14:12:47.797 +02:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-04-23 14:12:47.829 +02:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-04-23 14:12:47.846 +02:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-04-23 14:12:47.864 +02:00 [DBG] Start userinfo request
2020-04-23 14:12:47.888 +02:00 [DBG] Bearer token found in header
2020-04-23 14:12:48.705 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:48.716 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:48.989 +02:00 [DBG] thandizo_web_client found in database: true
2020-04-23 14:12:48.992 +02:00 [DBG] client configuration validation for client thandizo_web_client succeeded.
2020-04-23 14:12:49.063 +02:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-04-23 14:12:49.074 +02:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1587643964,"exp":1587730364,"iss":"http://localhost:5004","aud":"api_gateway","client_id":"thandizo_web_client","sub":"1","auth_time":1587643962,"idp":"local","scope":["openid","profile","patientapi_global_access","patientapi_global_write","patientapi_global_read","patientapi_global_update","patientapi_global_delete","patientapi_statistics_read","patientapi_patients_write","patientapi_patients_read","patientapi_patients_update","patientapi_patients_delete","coreapi_global_access","coreapi_global_write","coreapi_global_read","coreapi_global_update","coreapi_global_delete","resourceapi_global_access","resourceapi_global_write","resourceapi_global_read","resourceapi_global_update","resourceapi_global_delete","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-04-23 14:12:49.127 +02:00 [DBG] Creating userinfo response
2020-04-23 14:12:49.128 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:49.131 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:49.159 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:49.162 +02:00 [DBG] Requested claim types: preferred_username admin name
2020-04-23 14:12:49.168 +02:00 [DBG] Scopes in access token: openid profile patientapi_global_access patientapi_global_write patientapi_global_read patientapi_global_update patientapi_global_delete patientapi_statistics_read patientapi_patients_write patientapi_patients_read patientapi_patients_update patientapi_patients_delete coreapi_global_access coreapi_global_write coreapi_global_read coreapi_global_update coreapi_global_delete resourceapi_global_access resourceapi_global_write resourceapi_global_read resourceapi_global_update resourceapi_global_delete offline_access
2020-04-23 14:12:49.179 +02:00 [DBG] Found ["openid","profile"] identity scopes in database
2020-04-23 14:12:49.203 +02:00 [INF] Profile service returned the following claim types: name preferred_username admin preferred_username
2020-04-23 14:12:49.206 +02:00 [DBG] End userinfo request
